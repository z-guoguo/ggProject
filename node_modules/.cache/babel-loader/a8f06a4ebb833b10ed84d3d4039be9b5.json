{"ast":null,"code":"export const er = function (vertices, options, edgeView) {\n  const offsetRaw = options.offset || 32;\n  const min = options.min == null ? 16 : options.min;\n  let offset = 0;\n  let direction = options.direction;\n  const sourceBBox = edgeView.sourceBBox;\n  const targetBBox = edgeView.targetBBox;\n  const sourcePoint = sourceBBox.getCenter();\n  const targetPoint = targetBBox.getCenter();\n\n  if (typeof offsetRaw === 'number') {\n    offset = offsetRaw;\n  }\n\n  if (direction == null) {\n    let dx = targetBBox.left - sourceBBox.right;\n    let dy = targetBBox.top - sourceBBox.bottom;\n\n    if (dx >= 0 && dy >= 0) {\n      direction = dx >= dy ? 'L' : 'T';\n    } else if (dx <= 0 && dy >= 0) {\n      dx = sourceBBox.left - targetBBox.right;\n\n      if (dx >= 0) {\n        direction = dx >= dy ? 'R' : 'T';\n      } else {\n        direction = 'T';\n      }\n    } else if (dx >= 0 && dy <= 0) {\n      dy = sourceBBox.top - targetBBox.bottom;\n\n      if (dy >= 0) {\n        direction = dx >= dy ? 'L' : 'B';\n      } else {\n        direction = 'L';\n      }\n    } else {\n      dx = sourceBBox.left - targetBBox.right;\n      dy = sourceBBox.top - targetBBox.bottom;\n\n      if (dx >= 0 && dy >= 0) {\n        direction = dx >= dy ? 'R' : 'B';\n      } else if (dx <= 0 && dy >= 0) {\n        direction = 'B';\n      } else if (dx >= 0 && dy <= 0) {\n        direction = 'R';\n      } else {\n        direction = Math.abs(dx) > Math.abs(dy) ? 'R' : 'B';\n      }\n    }\n  }\n\n  if (direction === 'H') {\n    direction = targetPoint.x - sourcePoint.x >= 0 ? 'L' : 'R';\n  } else if (direction === 'V') {\n    direction = targetPoint.y - sourcePoint.y >= 0 ? 'T' : 'B';\n  }\n\n  if (offsetRaw === 'center') {\n    if (direction === 'L') {\n      offset = (targetBBox.left - sourceBBox.right) / 2;\n    } else if (direction === 'R') {\n      offset = (sourceBBox.left - targetBBox.right) / 2;\n    } else if (direction === 'T') {\n      offset = (targetBBox.top - sourceBBox.bottom) / 2;\n    } else if (direction === 'B') {\n      offset = (sourceBBox.top - targetBBox.bottom) / 2;\n    }\n  }\n\n  let coord;\n  let dim;\n  let factor;\n  const horizontal = direction === 'L' || direction === 'R';\n\n  if (horizontal) {\n    if (targetPoint.y === sourcePoint.y) {\n      return [...vertices];\n    }\n\n    factor = direction === 'L' ? 1 : -1;\n    coord = 'x';\n    dim = 'width';\n  } else {\n    if (targetPoint.x === sourcePoint.x) {\n      return [...vertices];\n    }\n\n    factor = direction === 'T' ? 1 : -1;\n    coord = 'y';\n    dim = 'height';\n  }\n\n  const source = sourcePoint.clone();\n  const target = targetPoint.clone();\n  source[coord] += factor * (sourceBBox[dim] / 2 + offset);\n  target[coord] -= factor * (targetBBox[dim] / 2 + offset);\n\n  if (horizontal) {\n    const sourceX = source.x;\n    const targetX = target.x;\n    const sourceDelta = sourceBBox.width / 2 + min;\n    const targetDelta = targetBBox.width / 2 + min;\n\n    if (targetPoint.x > sourcePoint.x) {\n      if (targetX <= sourceX) {\n        source.x = Math.max(targetX, sourcePoint.x + sourceDelta);\n        target.x = Math.min(sourceX, targetPoint.x - targetDelta);\n      }\n    } else if (targetX >= sourceX) {\n      source.x = Math.min(targetX, sourcePoint.x - sourceDelta);\n      target.x = Math.max(sourceX, targetPoint.x + targetDelta);\n    }\n  } else {\n    const sourceY = source.y;\n    const targetY = target.y;\n    const sourceDelta = sourceBBox.height / 2 + min;\n    const targetDelta = targetBBox.height / 2 + min;\n\n    if (targetPoint.y > sourcePoint.y) {\n      if (targetY <= sourceY) {\n        source.y = Math.max(targetY, sourcePoint.y + sourceDelta);\n        target.y = Math.min(sourceY, targetPoint.y - targetDelta);\n      }\n    } else if (targetY >= sourceY) {\n      source.y = Math.min(targetY, sourcePoint.y - sourceDelta);\n      target.y = Math.max(sourceY, targetPoint.y + targetDelta);\n    }\n  }\n\n  return [source.toJSON(), ...vertices, target.toJSON()];\n};","map":{"version":3,"mappings":"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","names":["er","vertices","options","edgeView","offsetRaw","offset","min","direction","sourceBBox","targetBBox","sourcePoint","getCenter","targetPoint","dx","left","right","dy","top","bottom","Math","abs","x","y","coord","dim","factor","horizontal","source","clone","target","sourceX","targetX","sourceDelta","width","targetDelta","max","sourceY","targetY","height","toJSON"],"sourceRoot":"","sources":["../../../src/registry/router/er.ts"],"sourcesContent":[null]},"metadata":{},"sourceType":"module"}