{"ast":null,"code":"/**\n * @fileoverview gradient\n * @author dengfuping_develop@163.com\n */\nimport { each, mod, toRadian, uniqueId } from '@antv/util';\nimport { createSVGElement } from '../util/dom';\nvar regexLG = /^l\\s*\\(\\s*([\\d.]+)\\s*\\)\\s*(.*)/i;\nvar regexRG = /^r\\s*\\(\\s*([\\d.]+)\\s*,\\s*([\\d.]+)\\s*,\\s*([\\d.]+)\\s*\\)\\s*(.*)/i;\nvar regexColorStop = /[\\d.]+:(#[^\\s]+|[^)]+\\))/gi;\n\nfunction addStop(steps) {\n  var arr = steps.match(regexColorStop);\n\n  if (!arr) {\n    return '';\n  }\n\n  var stops = '';\n  arr.sort(function (a, b) {\n    a = a.split(':');\n    b = b.split(':');\n    return Number(a[0]) - Number(b[0]);\n  });\n  each(arr, function (item) {\n    item = item.split(':');\n    stops += \"<stop offset=\\\"\" + item[0] + \"\\\" stop-color=\\\"\" + item[1] + \"\\\"></stop>\";\n  });\n  return stops;\n}\n\nfunction parseLineGradient(color, el) {\n  var arr = regexLG.exec(color);\n  var angle = mod(toRadian(parseFloat(arr[1])), Math.PI * 2);\n  var steps = arr[2];\n  var start;\n  var end;\n\n  if (angle >= 0 && angle < 0.5 * Math.PI) {\n    start = {\n      x: 0,\n      y: 0\n    };\n    end = {\n      x: 1,\n      y: 1\n    };\n  } else if (0.5 * Math.PI <= angle && angle < Math.PI) {\n    start = {\n      x: 1,\n      y: 0\n    };\n    end = {\n      x: 0,\n      y: 1\n    };\n  } else if (Math.PI <= angle && angle < 1.5 * Math.PI) {\n    start = {\n      x: 1,\n      y: 1\n    };\n    end = {\n      x: 0,\n      y: 0\n    };\n  } else {\n    start = {\n      x: 0,\n      y: 1\n    };\n    end = {\n      x: 1,\n      y: 0\n    };\n  }\n\n  var tanTheta = Math.tan(angle);\n  var tanTheta2 = tanTheta * tanTheta;\n  var x = (end.x - start.x + tanTheta * (end.y - start.y)) / (tanTheta2 + 1) + start.x;\n  var y = tanTheta * (end.x - start.x + tanTheta * (end.y - start.y)) / (tanTheta2 + 1) + start.y;\n  el.setAttribute('x1', start.x);\n  el.setAttribute('y1', start.y);\n  el.setAttribute('x2', x);\n  el.setAttribute('y2', y);\n  el.innerHTML = addStop(steps);\n}\n\nfunction parseRadialGradient(color, self) {\n  var arr = regexRG.exec(color);\n  var cx = parseFloat(arr[1]);\n  var cy = parseFloat(arr[2]);\n  var r = parseFloat(arr[3]);\n  var steps = arr[4];\n  self.setAttribute('cx', cx);\n  self.setAttribute('cy', cy);\n  self.setAttribute('r', r);\n  self.innerHTML = addStop(steps);\n}\n\nvar Gradient =\n/** @class */\nfunction () {\n  function Gradient(cfg) {\n    this.cfg = {};\n    var el = null;\n    var id = uniqueId('gradient_');\n\n    if (cfg.toLowerCase()[0] === 'l') {\n      el = createSVGElement('linearGradient');\n      parseLineGradient(cfg, el);\n    } else {\n      el = createSVGElement('radialGradient');\n      parseRadialGradient(cfg, el);\n    }\n\n    el.setAttribute('id', id);\n    this.el = el;\n    this.id = id;\n    this.cfg = cfg;\n    return this;\n  }\n\n  Gradient.prototype.match = function (type, attr) {\n    return this.cfg === attr;\n  };\n\n  return Gradient;\n}();\n\nexport default Gradient;","map":{"version":3,"mappings":"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","names":["each","mod","toRadian","uniqueId","createSVGElement","regexLG","regexRG","regexColorStop","addStop","steps","arr","match","stops","sort","a","b","split","Number","item","parseLineGradient","color","el","exec","angle","parseFloat","Math","PI","start","end","x","y","tanTheta","tan","tanTheta2","setAttribute","innerHTML","parseRadialGradient","self","cx","cy","r","cfg","id","toLowerCase","Gradient","type","attr"],"sourceRoot":"","sources":["../../src/defs/gradient.ts"],"sourcesContent":[null]},"metadata":{},"sourceType":"module"}