{"ast":null,"code":"import { Line } from '../../geometry';\nexport function offset(p1, p2, offset) {\n  let tx;\n\n  if (typeof offset === 'object') {\n    if (Number.isFinite(offset.y)) {\n      const line = new Line(p2, p1);\n      const {\n        start,\n        end\n      } = line.parallel(offset.y);\n      p2 = start; // eslint-disable-line\n\n      p1 = end; // eslint-disable-line\n    }\n\n    tx = offset.x;\n  } else {\n    tx = offset;\n  }\n\n  if (tx == null || !Number.isFinite(tx)) {\n    return p1;\n  }\n\n  const length = p1.distance(p2);\n\n  if (tx === 0 && length > 0) {\n    return p1;\n  }\n\n  return p1.move(p2, -Math.min(tx, length - 1));\n}\nexport function getStrokeWidth(magnet) {\n  const stroke = magnet.getAttribute('stroke-width');\n\n  if (stroke === null) {\n    return 0;\n  }\n\n  return parseFloat(stroke) || 0;\n}\nexport function findShapeNode(magnet) {\n  if (magnet == null) {\n    return null;\n  }\n\n  let node = magnet;\n\n  do {\n    let tagName = node.tagName;\n    if (typeof tagName !== 'string') return null;\n    tagName = tagName.toUpperCase();\n\n    if (tagName === 'G') {\n      node = node.firstElementChild;\n    } else if (tagName === 'TITLE') {\n      node = node.nextElementSibling;\n    } else break;\n  } while (node);\n\n  return node;\n}","map":{"version":3,"mappings":"AAAA,SAAgBA,IAAhB,QAA4B,gBAA5B;AAEA,OAAM,SAAUC,MAAV,CACJC,EADI,EAEJC,EAFI,EAGJF,MAHI,EAG6B;EAEjC,IAAIG,EAAJ;;EACA,IAAI,OAAOH,MAAP,KAAkB,QAAtB,EAAgC;IAC9B,IAAII,MAAM,CAACC,QAAP,CAAgBL,MAAM,CAACM,CAAvB,CAAJ,EAA+B;MAC7B,MAAMC,IAAI,GAAG,IAAIR,IAAJ,CAASG,EAAT,EAAaD,EAAb,CAAb;MACA,MAAM;QAAEO,KAAF;QAASC;MAAT,IAAiBF,IAAI,CAACG,QAAL,CAAcV,MAAM,CAACM,CAArB,CAAvB;MACAJ,EAAE,GAAGM,KAAL,CAH6B,CAGlB;;MACXP,EAAE,GAAGQ,GAAL,CAJ6B,CAIpB;IACV;;IACDN,EAAE,GAAGH,MAAM,CAACW,CAAZ;EACD,CARD,MAQO;IACLR,EAAE,GAAGH,MAAL;EACD;;EAED,IAAIG,EAAE,IAAI,IAAN,IAAc,CAACC,MAAM,CAACC,QAAP,CAAgBF,EAAhB,CAAnB,EAAwC;IACtC,OAAOF,EAAP;EACD;;EAED,MAAMW,MAAM,GAAGX,EAAE,CAACY,QAAH,CAAYX,EAAZ,CAAf;;EACA,IAAIC,EAAE,KAAK,CAAP,IAAYS,MAAM,GAAG,CAAzB,EAA4B;IAC1B,OAAOX,EAAP;EACD;;EACD,OAAOA,EAAE,CAACa,IAAH,CAAQZ,EAAR,EAAY,CAACa,IAAI,CAACC,GAAL,CAASb,EAAT,EAAaS,MAAM,GAAG,CAAtB,CAAb,CAAP;AACD;AAED,OAAM,SAAUK,cAAV,CAAyBC,MAAzB,EAA2C;EAC/C,MAAMC,MAAM,GAAGD,MAAM,CAACE,YAAP,CAAoB,cAApB,CAAf;;EACA,IAAID,MAAM,KAAK,IAAf,EAAqB;IACnB,OAAO,CAAP;EACD;;EACD,OAAOE,UAAU,CAACF,MAAD,CAAV,IAAsB,CAA7B;AACD;AAED,OAAM,SAAUG,aAAV,CAAwBJ,MAAxB,EAAuC;EAC3C,IAAIA,MAAM,IAAI,IAAd,EAAoB;IAClB,OAAO,IAAP;EACD;;EAED,IAAIK,IAAI,GAAGL,MAAX;;EACA,GAAG;IACD,IAAIM,OAAO,GAAGD,IAAI,CAACC,OAAnB;IACA,IAAI,OAAOA,OAAP,KAAmB,QAAvB,EAAiC,OAAO,IAAP;IACjCA,OAAO,GAAGA,OAAO,CAACC,WAAR,EAAV;;IACA,IAAID,OAAO,KAAK,GAAhB,EAAqB;MACnBD,IAAI,GAAGA,IAAI,CAACG,iBAAZ;IACD,CAFD,MAEO,IAAIF,OAAO,KAAK,OAAhB,EAAyB;MAC9BD,IAAI,GAAGA,IAAI,CAACI,kBAAZ;IACD,CAFM,MAEA;EACR,CATD,QASSJ,IATT;;EAWA,OAAOA,IAAP;AACD","names":["Line","offset","p1","p2","tx","Number","isFinite","y","line","start","end","parallel","x","length","distance","move","Math","min","getStrokeWidth","magnet","stroke","getAttribute","parseFloat","findShapeNode","node","tagName","toUpperCase","firstElementChild","nextElementSibling"],"sourceRoot":"","sources":["../../../src/registry/connection-point/util.ts"],"sourcesContent":[null]},"metadata":{},"sourceType":"module"}