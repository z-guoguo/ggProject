{"ast":null,"code":"import { debounce } from './util';\nexport function createSensor(element) {\n  let sensor = null;\n  let listeners = [];\n\n  const create = () => {\n    if (getComputedStyle(element).position === 'static') {\n      const style = element.style;\n      style.position = 'relative';\n    }\n\n    const obj = document.createElement('object');\n\n    obj.onload = () => {\n      obj.contentDocument.defaultView.addEventListener('resize', trigger);\n      trigger();\n    };\n\n    obj.style.display = 'block';\n    obj.style.position = 'absolute';\n    obj.style.top = '0';\n    obj.style.left = '0';\n    obj.style.height = '100%';\n    obj.style.width = '100%';\n    obj.style.overflow = 'hidden';\n    obj.style.pointerEvents = 'none';\n    obj.style.zIndex = '-1';\n    obj.style.opacity = '0';\n    obj.setAttribute('tabindex', '-1');\n    obj.type = 'text/html';\n    element.appendChild(obj); // for ie, should set data attribute delay, or will be white screen\n\n    obj.data = 'about:blank';\n    return obj;\n  };\n\n  const trigger = debounce(() => {\n    listeners.forEach(listener => listener(element));\n  });\n\n  const bind = listener => {\n    if (!sensor) {\n      sensor = create();\n    }\n\n    if (listeners.indexOf(listener) === -1) {\n      listeners.push(listener);\n    }\n  };\n\n  const destroy = () => {\n    if (sensor && sensor.parentNode) {\n      if (sensor.contentDocument) {\n        sensor.contentDocument.defaultView.removeEventListener('resize', trigger);\n      }\n\n      sensor.parentNode.removeChild(sensor);\n      sensor = null;\n      listeners = [];\n    }\n  };\n\n  const unbind = listener => {\n    const idx = listeners.indexOf(listener);\n\n    if (idx !== -1) {\n      listeners.splice(idx, 1);\n    } // no listener, and sensor is exist then destroy the sensor\n\n\n    if (listeners.length === 0 && sensor) {\n      destroy();\n    }\n  };\n\n  return {\n    element,\n    bind,\n    destroy,\n    unbind\n  };\n}","map":{"version":3,"mappings":"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","names":["debounce","createSensor","element","sensor","listeners","create","getComputedStyle","position","style","obj","document","createElement","onload","contentDocument","defaultView","addEventListener","trigger","display","top","left","height","width","overflow","pointerEvents","zIndex","opacity","setAttribute","type","appendChild","data","forEach","listener","bind","indexOf","push","destroy","parentNode","removeEventListener","removeChild","unbind","idx","splice","length"],"sourceRoot":"","sources":["../../../../src/util/size-sensor/sensors/object.ts"],"sourcesContent":[null]},"metadata":{},"sourceType":"module"}