{"ast":null,"code":"import JQuery from 'jquery';\nexport function sanitizeHTML(html, options = {}) {\n  // If documentContext (second parameter) is not specified or given as\n  // `null` or `undefined`, a new document is used. Inline events will not\n  // execute when the HTML is parsed; this includes, for example, sending\n  // GET requests for images.\n  // If keepScripts (last parameter) is `false`, scripts are not executed.\n  const nodes = JQuery.parseHTML(html, null, false);\n  nodes.forEach(node => {\n    const elem = node;\n\n    if (elem) {\n      const attrs = elem.attributes;\n\n      if (attrs) {\n        for (let i = 0, ii = attrs.length; i < ii; i += 1) {\n          const attr = attrs.item(i);\n\n          if (attr) {\n            const val = attr.value.toLowerCase();\n            const name = attr.name.toLowerCase(); // Removes attribute name starts with \"on\" (e.g. onload,\n            // onerror...).\n            // Removes attribute value starts with \"javascript:\" pseudo\n            // protocol (e.g. `href=\"javascript:alert(1)\"`).\n\n            if (name.startsWith('on') || val.startsWith('javascript:') || // eslint-disable-line no-script-url\n            // ref: https://lgtm.com/rules/1510852698359/\n            val.startsWith('data:') || val.startsWith('vbscript:')) {\n              elem.removeAttribute(name);\n            }\n          }\n        }\n      }\n    }\n  });\n\n  if (options.raw) {\n    return nodes;\n  }\n\n  return JQuery('<div/>').append(nodes).html();\n}","map":{"version":3,"mappings":"AAAA,OAAOA,MAAP,MAAmB,QAAnB;AAYA,OAAM,SAAUC,YAAV,CAAuBC,IAAvB,EAAqCC,UAA6B,EAAlE,EAAoE;EACxE;EACA;EACA;EACA;EAEA;EACA,MAAMC,KAAK,GAAGJ,MAAM,CAACK,SAAP,CAAiBH,IAAjB,EAAuB,IAAvB,EAA6B,KAA7B,CAAd;EAEAE,KAAK,CAACE,OAAN,CAAeC,IAAD,IAAS;IACrB,MAAMC,IAAI,GAAGD,IAAb;;IACA,IAAIC,IAAJ,EAAU;MACR,MAAMC,KAAK,GAAGD,IAAI,CAACE,UAAnB;;MACA,IAAID,KAAJ,EAAW;QACT,KAAK,IAAIE,CAAC,GAAG,CAAR,EAAWC,EAAE,GAAGH,KAAK,CAACI,MAA3B,EAAmCF,CAAC,GAAGC,EAAvC,EAA2CD,CAAC,IAAI,CAAhD,EAAmD;UACjD,MAAMG,IAAI,GAAGL,KAAK,CAACM,IAAN,CAAWJ,CAAX,CAAb;;UACA,IAAIG,IAAJ,EAAU;YACR,MAAME,GAAG,GAAGF,IAAI,CAACG,KAAL,CAAWC,WAAX,EAAZ;YACA,MAAMC,IAAI,GAAGL,IAAI,CAACK,IAAL,CAAUD,WAAV,EAAb,CAFQ,CAIR;YACA;YACA;YACA;;YACA,IACEC,IAAI,CAACC,UAAL,CAAgB,IAAhB,KACAJ,GAAG,CAACI,UAAJ,CAAe,aAAf,CADA,IACiC;YACjC;YACAJ,GAAG,CAACI,UAAJ,CAAe,OAAf,CAHA,IAIAJ,GAAG,CAACI,UAAJ,CAAe,WAAf,CALF,EAME;cACAZ,IAAI,CAACa,eAAL,CAAqBF,IAArB;YACD;UACF;QACF;MACF;IACF;EACF,CA5BD;;EA8BA,IAAIhB,OAAO,CAACmB,GAAZ,EAAiB;IACf,OAAOlB,KAAP;EACD;;EAED,OAAOJ,MAAM,CAAC,QAAD,CAAN,CAAiBuB,MAAjB,CAAwBnB,KAAxB,EAA+BF,IAA/B,EAAP;AACD","names":["JQuery","sanitizeHTML","html","options","nodes","parseHTML","forEach","node","elem","attrs","attributes","i","ii","length","attr","item","val","value","toLowerCase","name","startsWith","removeAttribute","raw","append"],"sourceRoot":"","sources":["../../../src/util/string/html.ts"],"sourcesContent":[null]},"metadata":{},"sourceType":"module"}