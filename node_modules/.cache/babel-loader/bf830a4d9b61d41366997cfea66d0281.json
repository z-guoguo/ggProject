{"ast":null,"code":"import \"core-js/modules/es.error.cause.js\";\nimport { StringExt, FunctionExt, Platform } from '../util';\nexport class Registry {\n  constructor(options) {\n    this.options = Object.assign({}, options);\n    this.data = this.options.data || {};\n    this.register = this.register.bind(this);\n    this.unregister = this.unregister.bind(this);\n  }\n\n  get names() {\n    return Object.keys(this.data);\n  }\n\n  register(name, options, force = false) {\n    if (typeof name === 'object') {\n      Object.keys(name).forEach(key => {\n        this.register(key, name[key], options);\n      });\n      return;\n    }\n\n    if (this.exist(name) && !force && !Platform.isApplyingHMR()) {\n      this.onDuplicated(name);\n    }\n\n    const process = this.options.process;\n    const entity = process ? FunctionExt.call(process, this, name, options) : options;\n    this.data[name] = entity;\n    return entity;\n  }\n\n  unregister(name) {\n    const entity = name ? this.data[name] : null;\n    delete this.data[name];\n    return entity;\n  }\n\n  get(name) {\n    return name ? this.data[name] : null;\n  }\n\n  exist(name) {\n    return name ? this.data[name] != null : false;\n  }\n\n  onDuplicated(name) {\n    // eslint-disable-next-line no-useless-catch\n    try {\n      // race\n      if (this.options.onConflict) {\n        FunctionExt.call(this.options.onConflict, this, name);\n      }\n\n      throw new Error(`${StringExt.upperFirst(this.options.type)} with name '${name}' already registered.`);\n    } catch (err) {\n      throw err;\n    }\n  }\n\n  onNotFound(name, prefix) {\n    throw new Error(this.getSpellingSuggestion(name, prefix));\n  }\n\n  getSpellingSuggestion(name, prefix) {\n    const suggestion = this.getSpellingSuggestionForName(name);\n    const prefixed = prefix ? `${prefix} ${StringExt.lowerFirst(this.options.type)}` : this.options.type;\n    return (// eslint-disable-next-line\n      `${StringExt.upperFirst(prefixed)} with name '${name}' does not exist.${suggestion ? ` Did you mean '${suggestion}'?` : ''}`\n    );\n  }\n\n  getSpellingSuggestionForName(name) {\n    return StringExt.getSpellingSuggestion(name, Object.keys(this.data), candidate => candidate);\n  }\n\n}\n\n(function (Registry) {\n  function create(options) {\n    return new Registry(options);\n  }\n\n  Registry.create = create;\n})(Registry || (Registry = {}));","map":{"version":3,"mappings":"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","names":["StringExt","FunctionExt","Platform","Registry","constructor","options","Object","data","register","bind","unregister","names","keys","name","force","forEach","key","exist","isApplyingHMR","onDuplicated","process","entity","call","get","onConflict","Error","upperFirst","type","err","onNotFound","prefix","getSpellingSuggestion","suggestion","getSpellingSuggestionForName","prefixed","lowerFirst","candidate","create"],"sourceRoot":"","sources":["../../src/registry/registry.ts"],"sourcesContent":[null]},"metadata":{},"sourceType":"module"}