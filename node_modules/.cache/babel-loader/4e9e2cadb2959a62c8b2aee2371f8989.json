{"ast":null,"code":"var __decorate = this && this.__decorate || function (decorators, target, key, desc) {\n  var c = arguments.length,\n      r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc,\n      d;\n  if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n  return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\n\nimport JQuery from 'jquery';\nimport { Dom, FunctionExt } from '../util';\nimport { Cell } from '../model';\nimport { Config } from '../global';\nimport { View, Markup } from '../view';\nexport class GraphView extends View {\n  constructor(graph) {\n    super();\n    this.graph = graph;\n    const {\n      selectors,\n      fragment\n    } = Markup.parseJSONMarkup(GraphView.markup);\n    this.background = selectors.background;\n    this.grid = selectors.grid;\n    this.svg = selectors.svg;\n    this.defs = selectors.defs;\n    this.viewport = selectors.viewport;\n    this.primer = selectors.primer;\n    this.stage = selectors.stage;\n    this.decorator = selectors.decorator;\n    this.overlay = selectors.overlay;\n    this.container = this.options.container;\n    this.restore = GraphView.snapshoot(this.container);\n    this.$(this.container).addClass(this.prefixClassName('graph')).append(fragment);\n    this.delegateEvents();\n  }\n\n  get model() {\n    return this.graph.model;\n  }\n\n  get options() {\n    return this.graph.options;\n  }\n\n  delegateEvents() {\n    const ctor = this.constructor;\n    super.delegateEvents(ctor.events);\n    return this;\n  }\n  /**\n   * Guard the specified event. If the event is not interesting, it\n   * returns `true`, otherwise returns `false`.\n   */\n\n\n  guard(e, view) {\n    // handled as `contextmenu` type\n    if (e.type === 'mousedown' && e.button === 2) {\n      return true;\n    }\n\n    if (this.options.guard && this.options.guard(e, view)) {\n      return true;\n    }\n\n    if (e.data && e.data.guarded !== undefined) {\n      return e.data.guarded;\n    }\n\n    if (view && view.cell && Cell.isCell(view.cell)) {\n      return false;\n    }\n\n    if (this.svg === e.target || this.container === e.target || JQuery.contains(this.svg, e.target)) {\n      return false;\n    }\n\n    return true;\n  }\n\n  findView(elem) {\n    return this.graph.renderer.findViewByElem(elem);\n  }\n\n  onDblClick(evt) {\n    if (this.options.preventDefaultDblClick) {\n      evt.preventDefault();\n    }\n\n    const e = this.normalizeEvent(evt);\n    const view = this.findView(e.target);\n\n    if (this.guard(e, view)) {\n      return;\n    }\n\n    const localPoint = this.graph.snapToGrid(e.clientX, e.clientY);\n\n    if (view) {\n      view.onDblClick(e, localPoint.x, localPoint.y);\n    } else {\n      this.graph.trigger('blank:dblclick', {\n        e,\n        x: localPoint.x,\n        y: localPoint.y\n      });\n    }\n  }\n\n  onClick(evt) {\n    if (this.getMouseMovedCount(evt) <= this.options.clickThreshold) {\n      const e = this.normalizeEvent(evt);\n      const view = this.findView(e.target);\n\n      if (this.guard(e, view)) {\n        return;\n      }\n\n      const localPoint = this.graph.snapToGrid(e.clientX, e.clientY);\n\n      if (view) {\n        view.onClick(e, localPoint.x, localPoint.y);\n      } else {\n        this.graph.trigger('blank:click', {\n          e,\n          x: localPoint.x,\n          y: localPoint.y\n        });\n      }\n    }\n  }\n\n  isPreventDefaultContextMenu(evt, view) {\n    let preventDefaultContextMenu = this.options.preventDefaultContextMenu;\n\n    if (typeof preventDefaultContextMenu === 'function') {\n      preventDefaultContextMenu = FunctionExt.call(preventDefaultContextMenu, this.graph, {\n        view\n      });\n    }\n\n    return preventDefaultContextMenu;\n  }\n\n  onContextMenu(evt) {\n    const e = this.normalizeEvent(evt);\n    const view = this.findView(e.target);\n\n    if (this.isPreventDefaultContextMenu(e, view)) {\n      evt.preventDefault();\n    }\n\n    if (this.guard(e, view)) {\n      return;\n    }\n\n    const localPoint = this.graph.snapToGrid(e.clientX, e.clientY);\n\n    if (view) {\n      view.onContextMenu(e, localPoint.x, localPoint.y);\n    } else {\n      this.graph.trigger('blank:contextmenu', {\n        e,\n        x: localPoint.x,\n        y: localPoint.y\n      });\n    }\n  }\n\n  delegateDragEvents(e, view) {\n    if (e.data == null) {\n      e.data = {};\n    }\n\n    this.setEventData(e, {\n      currentView: view || null,\n      mouseMovedCount: 0,\n      startPosition: {\n        x: e.clientX,\n        y: e.clientY\n      }\n    });\n    const ctor = this.constructor;\n    this.delegateDocumentEvents(ctor.documentEvents, e.data);\n    this.undelegateEvents();\n  }\n\n  getMouseMovedCount(e) {\n    const data = this.getEventData(e);\n    return data.mouseMovedCount || 0;\n  }\n\n  onMouseDown(evt) {\n    const e = this.normalizeEvent(evt);\n    const view = this.findView(e.target);\n\n    if (this.guard(e, view)) {\n      return;\n    }\n\n    if (this.options.preventDefaultMouseDown) {\n      e.preventDefault();\n    }\n\n    const localPoint = this.graph.snapToGrid(e.clientX, e.clientY);\n\n    if (view) {\n      view.onMouseDown(e, localPoint.x, localPoint.y);\n    } else {\n      if (this.options.preventDefaultBlankAction) {\n        e.preventDefault();\n      }\n\n      this.graph.trigger('blank:mousedown', {\n        e,\n        x: localPoint.x,\n        y: localPoint.y\n      });\n    }\n\n    this.delegateDragEvents(e, view);\n  }\n\n  onMouseMove(evt) {\n    const data = this.getEventData(evt);\n    const startPosition = data.startPosition;\n\n    if (startPosition && startPosition.x === evt.clientX && startPosition.y === evt.clientY) {\n      return;\n    }\n\n    if (data.mouseMovedCount == null) {\n      data.mouseMovedCount = 0;\n    }\n\n    data.mouseMovedCount += 1;\n    const mouseMovedCount = data.mouseMovedCount;\n\n    if (mouseMovedCount <= this.options.moveThreshold) {\n      return;\n    }\n\n    const e = this.normalizeEvent(evt);\n    const localPoint = this.graph.snapToGrid(e.clientX, e.clientY);\n    const view = data.currentView;\n\n    if (view) {\n      view.onMouseMove(e, localPoint.x, localPoint.y);\n    } else {\n      this.graph.trigger('blank:mousemove', {\n        e,\n        x: localPoint.x,\n        y: localPoint.y\n      });\n    }\n\n    this.setEventData(e, data);\n  }\n\n  onMouseUp(e) {\n    this.undelegateDocumentEvents();\n    const normalized = this.normalizeEvent(e);\n    const localPoint = this.graph.snapToGrid(normalized.clientX, normalized.clientY);\n    const data = this.getEventData(e);\n    const view = data.currentView;\n\n    if (view) {\n      view.onMouseUp(normalized, localPoint.x, localPoint.y);\n    } else {\n      this.graph.trigger('blank:mouseup', {\n        e: normalized,\n        x: localPoint.x,\n        y: localPoint.y\n      });\n    }\n\n    if (!e.isPropagationStopped()) {\n      this.onClick(JQuery.Event(e, {\n        type: 'click',\n        data: e.data\n      }));\n    }\n\n    e.stopImmediatePropagation();\n    this.delegateEvents();\n  }\n\n  onMouseOver(evt) {\n    const e = this.normalizeEvent(evt);\n    const view = this.findView(e.target);\n\n    if (this.guard(e, view)) {\n      return;\n    }\n\n    if (view) {\n      view.onMouseOver(e);\n    } else {\n      // prevent border of paper from triggering this\n      if (this.container === e.target) {\n        return;\n      }\n\n      this.graph.trigger('blank:mouseover', {\n        e\n      });\n    }\n  }\n\n  onMouseOut(evt) {\n    const e = this.normalizeEvent(evt);\n    const view = this.findView(e.target);\n\n    if (this.guard(e, view)) {\n      return;\n    }\n\n    if (view) {\n      view.onMouseOut(e);\n    } else {\n      if (this.container === e.target) {\n        return;\n      }\n\n      this.graph.trigger('blank:mouseout', {\n        e\n      });\n    }\n  }\n\n  onMouseEnter(evt) {\n    const e = this.normalizeEvent(evt);\n    const view = this.findView(e.target);\n\n    if (this.guard(e, view)) {\n      return;\n    }\n\n    const relatedView = this.graph.renderer.findViewByElem(e.relatedTarget);\n\n    if (view) {\n      if (relatedView === view) {\n        // mouse moved from tool to view\n        return;\n      }\n\n      view.onMouseEnter(e);\n    } else {\n      if (relatedView) {\n        return;\n      }\n\n      this.graph.trigger('graph:mouseenter', {\n        e\n      });\n    }\n  }\n\n  onMouseLeave(evt) {\n    const e = this.normalizeEvent(evt);\n    const view = this.findView(e.target);\n\n    if (this.guard(e, view)) {\n      return;\n    }\n\n    const relatedView = this.graph.renderer.findViewByElem(e.relatedTarget);\n\n    if (view) {\n      if (relatedView === view) {\n        // mouse moved from view to tool\n        return;\n      }\n\n      view.onMouseLeave(e);\n    } else {\n      if (relatedView) {\n        return;\n      }\n\n      this.graph.trigger('graph:mouseleave', {\n        e\n      });\n    }\n  }\n\n  onMouseWheel(evt) {\n    const e = this.normalizeEvent(evt);\n    const view = this.findView(e.target);\n\n    if (this.guard(e, view)) {\n      return;\n    }\n\n    const originalEvent = e.originalEvent;\n    const localPoint = this.graph.snapToGrid(originalEvent.clientX, originalEvent.clientY);\n    const delta = Math.max(-1, Math.min(1, originalEvent.wheelDelta || -originalEvent.detail));\n\n    if (view) {\n      view.onMouseWheel(e, localPoint.x, localPoint.y, delta);\n    } else {\n      this.graph.trigger('blank:mousewheel', {\n        e,\n        delta,\n        x: localPoint.x,\n        y: localPoint.y\n      });\n    }\n  }\n\n  onCustomEvent(evt) {\n    const elem = evt.currentTarget;\n    const event = elem.getAttribute('event') || elem.getAttribute('data-event');\n\n    if (event) {\n      const view = this.findView(elem);\n\n      if (view) {\n        const e = this.normalizeEvent(evt);\n\n        if (this.guard(e, view)) {\n          return;\n        }\n\n        const localPoint = this.graph.snapToGrid(e.clientX, e.clientY);\n        view.onCustomEvent(e, event, localPoint.x, localPoint.y);\n      }\n    }\n  }\n\n  handleMagnetEvent(evt, handler) {\n    const magnetElem = evt.currentTarget;\n    const magnetValue = magnetElem.getAttribute('magnet');\n\n    if (magnetValue && magnetValue.toLowerCase() !== 'false') {\n      const view = this.findView(magnetElem);\n\n      if (view) {\n        const e = this.normalizeEvent(evt);\n\n        if (this.guard(e, view)) {\n          return;\n        }\n\n        const localPoint = this.graph.snapToGrid(e.clientX, e.clientY);\n        FunctionExt.call(handler, this.graph, view, e, magnetElem, localPoint.x, localPoint.y);\n      }\n    }\n  }\n\n  onMagnetMouseDown(e) {\n    this.handleMagnetEvent(e, (view, e, magnet, x, y) => {\n      view.onMagnetMouseDown(e, magnet, x, y);\n    });\n  }\n\n  onMagnetDblClick(e) {\n    this.handleMagnetEvent(e, (view, e, magnet, x, y) => {\n      view.onMagnetDblClick(e, magnet, x, y);\n    });\n  }\n\n  onMagnetContextMenu(evt) {\n    const e = this.normalizeEvent(evt);\n    const view = this.findView(e.target);\n\n    if (this.isPreventDefaultContextMenu(e, view)) {\n      e.preventDefault();\n    }\n\n    this.handleMagnetEvent(e, (view, e, magnet, x, y) => {\n      view.onMagnetContextMenu(e, magnet, x, y);\n    });\n  }\n\n  onLabelMouseDown(evt) {\n    const labelNode = evt.currentTarget;\n    const view = this.findView(labelNode);\n\n    if (view) {\n      const e = this.normalizeEvent(evt);\n\n      if (this.guard(e, view)) {\n        return;\n      }\n\n      const localPoint = this.graph.snapToGrid(e.clientX, e.clientY);\n      view.onLabelMouseDown(e, localPoint.x, localPoint.y);\n    }\n  }\n\n  onImageDragStart() {\n    // This is the only way to prevent image dragging in Firefox that works.\n    // Setting -moz-user-select: none, draggable=\"false\" attribute or\n    // user-drag: none didn't help.\n    return false;\n  }\n\n  dispose() {\n    this.undelegateEvents();\n    this.undelegateDocumentEvents();\n    this.restore();\n\n    this.restore = () => {};\n  }\n\n}\n\n__decorate([View.dispose()], GraphView.prototype, \"dispose\", null);\n\n(function (GraphView) {\n  const prefixCls = `${Config.prefixCls}-graph`;\n  GraphView.markup = [{\n    ns: Dom.ns.xhtml,\n    tagName: 'div',\n    selector: 'background',\n    className: `${prefixCls}-background`\n  }, {\n    ns: Dom.ns.xhtml,\n    tagName: 'div',\n    selector: 'grid',\n    className: `${prefixCls}-grid`\n  }, {\n    ns: Dom.ns.svg,\n    tagName: 'svg',\n    selector: 'svg',\n    className: `${prefixCls}-svg`,\n    attrs: {\n      width: '100%',\n      height: '100%',\n      'xmlns:xlink': Dom.ns.xlink\n    },\n    children: [{\n      tagName: 'defs',\n      selector: 'defs'\n    }, {\n      tagName: 'g',\n      selector: 'viewport',\n      className: `${prefixCls}-svg-viewport`,\n      children: [{\n        tagName: 'g',\n        selector: 'primer',\n        className: `${prefixCls}-svg-primer`\n      }, {\n        tagName: 'g',\n        selector: 'stage',\n        className: `${prefixCls}-svg-stage`\n      }, {\n        tagName: 'g',\n        selector: 'decorator',\n        className: `${prefixCls}-svg-decorator`\n      }, {\n        tagName: 'g',\n        selector: 'overlay',\n        className: `${prefixCls}-svg-overlay`\n      }]\n    }]\n  }];\n\n  function snapshoot(elem) {\n    const cloned = elem.cloneNode();\n    elem.childNodes.forEach(child => cloned.appendChild(child));\n    return () => {\n      // remove all children\n      Dom.empty(elem); // remove all attributes\n\n      while (elem.attributes.length > 0) {\n        elem.removeAttribute(elem.attributes[0].name);\n      } // restore attributes\n\n\n      for (let i = 0, l = cloned.attributes.length; i < l; i += 1) {\n        const attr = cloned.attributes[i];\n        elem.setAttribute(attr.name, attr.value);\n      } // restore children\n\n\n      cloned.childNodes.forEach(child => elem.appendChild(child));\n    };\n  }\n\n  GraphView.snapshoot = snapshoot;\n})(GraphView || (GraphView = {}));\n\n(function (GraphView) {\n  const prefixCls = Config.prefixCls;\n  GraphView.events = {\n    dblclick: 'onDblClick',\n    contextmenu: 'onContextMenu',\n    touchstart: 'onMouseDown',\n    mousedown: 'onMouseDown',\n    mouseover: 'onMouseOver',\n    mouseout: 'onMouseOut',\n    mouseenter: 'onMouseEnter',\n    mouseleave: 'onMouseLeave',\n    mousewheel: 'onMouseWheel',\n    DOMMouseScroll: 'onMouseWheel',\n    [`mouseenter  .${prefixCls}-cell`]: 'onMouseEnter',\n    [`mouseleave  .${prefixCls}-cell`]: 'onMouseLeave',\n    [`mouseenter  .${prefixCls}-cell-tools`]: 'onMouseEnter',\n    [`mouseleave  .${prefixCls}-cell-tools`]: 'onMouseLeave',\n    [`mousedown   .${prefixCls}-cell [event]`]: 'onCustomEvent',\n    [`touchstart  .${prefixCls}-cell [event]`]: 'onCustomEvent',\n    [`mousedown   .${prefixCls}-cell [data-event]`]: 'onCustomEvent',\n    [`touchstart  .${prefixCls}-cell [data-event]`]: 'onCustomEvent',\n    [`dblclick    .${prefixCls}-cell [magnet]`]: 'onMagnetDblClick',\n    [`contextmenu .${prefixCls}-cell [magnet]`]: 'onMagnetContextMenu',\n    [`mousedown   .${prefixCls}-cell [magnet]`]: 'onMagnetMouseDown',\n    [`touchstart  .${prefixCls}-cell [magnet]`]: 'onMagnetMouseDown',\n    [`dblclick    .${prefixCls}-cell [data-magnet]`]: 'onMagnetDblClick',\n    [`contextmenu .${prefixCls}-cell [data-magnet]`]: 'onMagnetContextMenu',\n    [`mousedown   .${prefixCls}-cell [data-magnet]`]: 'onMagnetMouseDown',\n    [`touchstart  .${prefixCls}-cell [data-magnet]`]: 'onMagnetMouseDown',\n    [`dragstart   .${prefixCls}-cell image`]: 'onImageDragStart',\n    [`mousedown   .${prefixCls}-edge .${prefixCls}-edge-label`]: 'onLabelMouseDown',\n    [`touchstart  .${prefixCls}-edge .${prefixCls}-edge-label`]: 'onLabelMouseDown'\n  };\n  GraphView.documentEvents = {\n    mousemove: 'onMouseMove',\n    touchmove: 'onMouseMove',\n    mouseup: 'onMouseUp',\n    touchend: 'onMouseUp',\n    touchcancel: 'onMouseUp'\n  };\n})(GraphView || (GraphView = {}));","map":{"version":3,"mappings":"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","names":["JQuery","Dom","FunctionExt","Cell","Config","View","Markup","GraphView","constructor","graph","selectors","fragment","parseJSONMarkup","markup","background","grid","svg","defs","viewport","primer","stage","decorator","overlay","container","options","restore","snapshoot","$","addClass","prefixClassName","append","delegateEvents","model","ctor","events","guard","e","view","type","button","data","guarded","undefined","cell","isCell","target","contains","findView","elem","renderer","findViewByElem","onDblClick","evt","preventDefaultDblClick","preventDefault","normalizeEvent","localPoint","snapToGrid","clientX","clientY","x","y","trigger","onClick","getMouseMovedCount","clickThreshold","isPreventDefaultContextMenu","preventDefaultContextMenu","call","onContextMenu","delegateDragEvents","setEventData","currentView","mouseMovedCount","startPosition","delegateDocumentEvents","documentEvents","undelegateEvents","getEventData","onMouseDown","preventDefaultMouseDown","preventDefaultBlankAction","onMouseMove","moveThreshold","onMouseUp","undelegateDocumentEvents","normalized","isPropagationStopped","Event","stopImmediatePropagation","onMouseOver","onMouseOut","onMouseEnter","relatedView","relatedTarget","onMouseLeave","onMouseWheel","originalEvent","delta","Math","max","min","wheelDelta","detail","onCustomEvent","currentTarget","event","getAttribute","handleMagnetEvent","handler","magnetElem","magnetValue","toLowerCase","onMagnetMouseDown","magnet","onMagnetDblClick","onMagnetContextMenu","onLabelMouseDown","labelNode","onImageDragStart","dispose","__decorate","prefixCls","ns","xhtml","tagName","selector","className","attrs","width","height","xlink","children","cloned","cloneNode","childNodes","forEach","child","appendChild","empty","attributes","length","removeAttribute","name","i","l","attr","setAttribute","value","dblclick","contextmenu","touchstart","mousedown","mouseover","mouseout","mouseenter","mouseleave","mousewheel","DOMMouseScroll","mousemove","touchmove","mouseup","touchend","touchcancel"],"sourceRoot":"","sources":["../../src/graph/view.ts"],"sourcesContent":[null]},"metadata":{},"sourceType":"module"}