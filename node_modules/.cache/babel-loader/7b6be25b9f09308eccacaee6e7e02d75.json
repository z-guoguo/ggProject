{"ast":null,"code":"import { Path, Point } from '../../geometry';\nexport const loop = function (sourcePoint, targetPoint, routePoints, options = {}) {\n  const fix = routePoints.length === 3 ? 0 : 1;\n  const p1 = Point.create(routePoints[0 + fix]);\n  const p2 = Point.create(routePoints[2 + fix]);\n  const center = Point.create(routePoints[1 + fix]);\n\n  if (!Point.equals(sourcePoint, targetPoint)) {\n    const middle = new Point((sourcePoint.x + targetPoint.x) / 2, (sourcePoint.y + targetPoint.y) / 2);\n    const angle = middle.angleBetween(Point.create(sourcePoint).rotate(90, middle), center);\n\n    if (angle > 1) {\n      p1.rotate(180 - angle, middle);\n      p2.rotate(180 - angle, middle);\n      center.rotate(180 - angle, middle);\n    }\n  }\n\n  const pathData = `\n     M ${sourcePoint.x} ${sourcePoint.y}\n     Q ${p1.x} ${p1.y} ${center.x} ${center.y}\n     Q ${p2.x} ${p2.y} ${targetPoint.x} ${targetPoint.y}\n  `;\n  return options.raw ? Path.parse(pathData) : pathData;\n};","map":{"version":3,"mappings":"AAAA,SAASA,IAAT,EAAeC,KAAf,QAA4B,gBAA5B;AAOA,OAAO,MAAMC,IAAI,GAA+C,UAC9DC,WAD8D,EAE9DC,WAF8D,EAG9DC,WAH8D,EAI9DC,OAAO,GAAG,EAJoD,EAIlD;EAEZ,MAAMC,GAAG,GAAGF,WAAW,CAACG,MAAZ,KAAuB,CAAvB,GAA2B,CAA3B,GAA+B,CAA3C;EACA,MAAMC,EAAE,GAAGR,KAAK,CAACS,MAAN,CAAaL,WAAW,CAAC,IAAIE,GAAL,CAAxB,CAAX;EACA,MAAMI,EAAE,GAAGV,KAAK,CAACS,MAAN,CAAaL,WAAW,CAAC,IAAIE,GAAL,CAAxB,CAAX;EACA,MAAMK,MAAM,GAAGX,KAAK,CAACS,MAAN,CAAaL,WAAW,CAAC,IAAIE,GAAL,CAAxB,CAAf;;EAEA,IAAI,CAACN,KAAK,CAACY,MAAN,CAAaV,WAAb,EAA0BC,WAA1B,CAAL,EAA6C;IAC3C,MAAMU,MAAM,GAAG,IAAIb,KAAJ,CACb,CAACE,WAAW,CAACY,CAAZ,GAAgBX,WAAW,CAACW,CAA7B,IAAkC,CADrB,EAEb,CAACZ,WAAW,CAACa,CAAZ,GAAgBZ,WAAW,CAACY,CAA7B,IAAkC,CAFrB,CAAf;IAIA,MAAMC,KAAK,GAAGH,MAAM,CAACI,YAAP,CACZjB,KAAK,CAACS,MAAN,CAAaP,WAAb,EAA0BgB,MAA1B,CAAiC,EAAjC,EAAqCL,MAArC,CADY,EAEZF,MAFY,CAAd;;IAIA,IAAIK,KAAK,GAAG,CAAZ,EAAe;MACbR,EAAE,CAACU,MAAH,CAAU,MAAMF,KAAhB,EAAuBH,MAAvB;MACAH,EAAE,CAACQ,MAAH,CAAU,MAAMF,KAAhB,EAAuBH,MAAvB;MACAF,MAAM,CAACO,MAAP,CAAc,MAAMF,KAApB,EAA2BH,MAA3B;IACD;EACF;;EAED,MAAMM,QAAQ,GAAG;SACVjB,WAAW,CAACY,CAAC,IAAIZ,WAAW,CAACa,CAAC;SAC9BP,EAAE,CAACM,CAAC,IAAIN,EAAE,CAACO,CAAC,IAAIJ,MAAM,CAACG,CAAC,IAAIH,MAAM,CAACI,CAAC;SACpCL,EAAE,CAACI,CAAC,IAAIJ,EAAE,CAACK,CAAC,IAAIZ,WAAW,CAACW,CAAC,IAAIX,WAAW,CAACY,CAAC;GAHrD;EAMA,OAAOV,OAAO,CAACe,GAAR,GAAcrB,IAAI,CAACsB,KAAL,CAAWF,QAAX,CAAd,GAAqCA,QAA5C;AACD,CAlCM","names":["Path","Point","loop","sourcePoint","targetPoint","routePoints","options","fix","length","p1","create","p2","center","equals","middle","x","y","angle","angleBetween","rotate","pathData","raw","parse"],"sourceRoot":"","sources":["../../../src/registry/connector/loop.ts"],"sourcesContent":[null]},"metadata":{},"sourceType":"module"}