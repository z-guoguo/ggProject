{"ast":null,"code":"\"use strict\";\n\nrequire(\"core-js/modules/es.error.cause.js\");\n\nvar __createBinding = this && this.__createBinding || (Object.create ? function (o, m, k, k2) {\n  if (k2 === undefined) k2 = k;\n  var desc = Object.getOwnPropertyDescriptor(m, k);\n\n  if (!desc || (\"get\" in desc ? !m.__esModule : desc.writable || desc.configurable)) {\n    desc = {\n      enumerable: true,\n      get: function () {\n        return m[k];\n      }\n    };\n  }\n\n  Object.defineProperty(o, k2, desc);\n} : function (o, m, k, k2) {\n  if (k2 === undefined) k2 = k;\n  o[k2] = m[k];\n});\n\nvar __setModuleDefault = this && this.__setModuleDefault || (Object.create ? function (o, v) {\n  Object.defineProperty(o, \"default\", {\n    enumerable: true,\n    value: v\n  });\n} : function (o, v) {\n  o[\"default\"] = v;\n});\n\nvar __importStar = this && this.__importStar || function (mod) {\n  if (mod && mod.__esModule) return mod;\n  var result = {};\n  if (mod != null) for (var k in mod) if (k !== \"default\" && Object.prototype.hasOwnProperty.call(mod, k)) __createBinding(result, mod, k);\n\n  __setModuleDefault(result, mod);\n\n  return result;\n};\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar d3Force = __importStar(require(\"d3-force\"));\n\nvar util_1 = require(\"../../util\"); // https://github.com/john-guerra/forceInABox/blob/master/src/forceInABox.js\n\n\nfunction forceInABox() {\n  function constant(_) {\n    return function () {\n      return _;\n    };\n  }\n\n  var groupBy = function (d) {\n    return d.cluster;\n  };\n\n  var forceNodeSize = constant(1);\n  var forceCharge = constant(-1);\n  var forceLinkDistance = constant(100);\n  var forceLinkStrength = constant(0.1);\n  var offset = [0, 0];\n  var nodes = [];\n  var nodesMap = {};\n  var links = [];\n  var centerX = 100;\n  var centerY = 100;\n  var foci = {\n    none: {\n      x: 0,\n      y: 0\n    }\n  };\n  var templateNodes = [];\n  var templateForce;\n  var template = 'force';\n  var enableGrouping = true;\n  var strength = 0.1;\n\n  function force(alpha) {\n    if (!enableGrouping) {\n      return force;\n    }\n\n    templateForce.tick();\n    getFocisFromTemplate();\n\n    for (var i = 0, n = nodes.length, node = void 0, k = alpha * strength; i < n; ++i) {\n      node = nodes[i];\n      node.vx += (foci[groupBy(node)].x - node.x) * k;\n      node.vy += (foci[groupBy(node)].y - node.y) * k;\n    }\n  }\n\n  function initialize() {\n    if (!nodes) return;\n    initializeWithForce();\n  }\n\n  function initializeWithForce() {\n    if (!nodes || !nodes.length) {\n      return;\n    }\n\n    if (groupBy(nodes[0]) === undefined) {\n      throw Error(\"Couldnt find the grouping attribute for the nodes. Make sure to set it up with forceInABox.groupBy('clusterAttr') before calling .links()\");\n    } // checkLinksAsObjects();\n\n\n    var net = getGroupsGraph();\n    templateForce = d3Force.forceSimulation(net.nodes).force('x', d3Force.forceX(centerX).strength(0.1)).force('y', d3Force.forceY(centerY).strength(0.1)).force('collide', d3Force.forceCollide(function (d) {\n      return d.r;\n    }).iterations(4)).force('charge', d3Force.forceManyBody().strength(forceCharge)).force('links', d3Force.forceLink(net.nodes.length ? net.links : []).distance(forceLinkDistance).strength(forceLinkStrength));\n    templateNodes = templateForce.nodes();\n    getFocisFromTemplate();\n  }\n\n  function getGroupsGraph() {\n    var gnodes = [];\n    var glinks = [];\n    var dNodes = {};\n    var clustersList = [];\n    var clustersCounts = {};\n    var clustersLinks = [];\n    clustersCounts = computeClustersNodeCounts(nodes);\n    clustersLinks = computeClustersLinkCounts(links);\n    clustersList = Object.keys(clustersCounts);\n    clustersList.forEach(function (key, index) {\n      var val = clustersCounts[key]; // Uses approx meta-node size\n\n      gnodes.push({\n        id: key,\n        size: val.count,\n        r: Math.sqrt(val.sumforceNodeSize / Math.PI)\n      });\n      dNodes[key] = index;\n    });\n    clustersLinks.forEach(function (l) {\n      var sourceTerminal = (0, util_1.getEdgeTerminal)(l, 'source');\n      var targetTerminal = (0, util_1.getEdgeTerminal)(l, 'target');\n      var source = dNodes[sourceTerminal];\n      var target = dNodes[targetTerminal];\n\n      if (source !== undefined && target !== undefined) {\n        glinks.push({\n          source: source,\n          target: target,\n          count: l.count\n        });\n      }\n    });\n    return {\n      nodes: gnodes,\n      links: glinks\n    };\n  }\n\n  function computeClustersNodeCounts(nodes) {\n    var clustersCounts = {};\n    nodes.forEach(function (d) {\n      var key = groupBy(d);\n\n      if (!clustersCounts[key]) {\n        clustersCounts[key] = {\n          count: 0,\n          sumforceNodeSize: 0\n        };\n      }\n    });\n    nodes.forEach(function (d) {\n      var key = groupBy(d);\n      var nodeSize = forceNodeSize(d);\n      var tmpCount = clustersCounts[key];\n      tmpCount.count = tmpCount.count + 1;\n      tmpCount.sumforceNodeSize = tmpCount.sumforceNodeSize + Math.PI * (nodeSize * nodeSize) * 1.3;\n      clustersCounts[key] = tmpCount;\n    });\n    return clustersCounts;\n  }\n\n  function computeClustersLinkCounts(links) {\n    var dClusterLinks = {};\n    var clusterLinks = [];\n    links.forEach(function (l) {\n      var key = getLinkKey(l);\n      var count = 0;\n\n      if (dClusterLinks[key] !== undefined) {\n        count = dClusterLinks[key];\n      }\n\n      count += 1;\n      dClusterLinks[key] = count;\n    }); // @ts-ignore\n\n    var entries = Object.entries(dClusterLinks);\n    entries.forEach(function (_a) {\n      var key = _a[0],\n          count = _a[1];\n      var source = key.split('~')[0];\n      var target = key.split('~')[1];\n\n      if (source !== undefined && target !== undefined) {\n        clusterLinks.push({\n          source: source,\n          target: target,\n          count: count\n        });\n      }\n    });\n    return clusterLinks;\n  }\n\n  function getFocisFromTemplate() {\n    foci = {\n      none: {\n        x: 0,\n        y: 0\n      }\n    };\n    templateNodes.forEach(function (d) {\n      foci[d.id] = {\n        x: d.x - offset[0],\n        y: d.y - offset[1]\n      };\n    });\n    return foci;\n  }\n\n  function getLinkKey(l) {\n    var source = (0, util_1.getEdgeTerminal)(l, 'source');\n    var target = (0, util_1.getEdgeTerminal)(l, 'target');\n    var sourceID = groupBy(nodesMap[source]);\n    var targetID = groupBy(nodesMap[target]);\n    return sourceID <= targetID ? \"\".concat(sourceID, \"~\").concat(targetID) : \"\".concat(targetID, \"~\").concat(sourceID);\n  }\n\n  function genNodesMap(nodes) {\n    nodesMap = {};\n    nodes.forEach(function (node) {\n      nodesMap[node.id] = node;\n    });\n  }\n\n  function setTemplate(x) {\n    if (!arguments.length) return template;\n    template = x;\n    initialize();\n    return force;\n  }\n\n  function setGroupBy(x) {\n    if (!arguments.length) return groupBy;\n\n    if (typeof x === 'string') {\n      groupBy = function (d) {\n        return d[x];\n      };\n\n      return force;\n    }\n\n    groupBy = x;\n    return force;\n  }\n\n  function setEnableGrouping(x) {\n    if (!arguments.length) return enableGrouping;\n    enableGrouping = x;\n    return force;\n  }\n\n  function setStrength(x) {\n    if (!arguments.length) return strength;\n    strength = x;\n    return force;\n  }\n\n  function setCenterX(_) {\n    if (arguments.length) {\n      centerX = _;\n      return force;\n    }\n\n    return centerX;\n  }\n\n  function setCenterY(_) {\n    if (arguments.length) {\n      centerY = _;\n      return force;\n    }\n\n    return centerY;\n  }\n\n  function setNodes(_) {\n    if (arguments.length) {\n      genNodesMap(_ || []);\n      nodes = _ || [];\n      return force;\n    }\n\n    return nodes;\n  }\n\n  function setLinks(_) {\n    if (arguments.length) {\n      links = _ || [];\n      initialize();\n      return force;\n    }\n\n    return links;\n  }\n\n  function setForceNodeSize(_) {\n    if (arguments.length) {\n      if (typeof _ === 'function') {\n        forceNodeSize = _;\n      } else {\n        forceNodeSize = constant(+_);\n      }\n\n      initialize();\n      return force;\n    }\n\n    return forceNodeSize;\n  }\n\n  function setForceCharge(_) {\n    if (arguments.length) {\n      if (typeof _ === 'function') {\n        forceCharge = _;\n      } else {\n        forceCharge = constant(+_);\n      }\n\n      initialize();\n      return force;\n    }\n\n    return forceCharge;\n  }\n\n  function setForceLinkDistance(_) {\n    if (arguments.length) {\n      if (typeof _ === 'function') {\n        forceLinkDistance = _;\n      } else {\n        forceLinkDistance = constant(+_);\n      }\n\n      initialize();\n      return force;\n    }\n\n    return forceLinkDistance;\n  }\n\n  function setForceLinkStrength(_) {\n    if (arguments.length) {\n      if (typeof _ === 'function') {\n        forceLinkStrength = _;\n      } else {\n        forceLinkStrength = constant(+_);\n      }\n\n      initialize();\n      return force;\n    }\n\n    return forceLinkStrength;\n  }\n\n  function setOffset(_) {\n    if (arguments.length) {\n      offset = _;\n      return force;\n    }\n\n    return offset;\n  }\n\n  force.initialize = function (_) {\n    nodes = _;\n    initialize();\n  };\n\n  force.template = setTemplate;\n  force.groupBy = setGroupBy;\n  force.enableGrouping = setEnableGrouping;\n  force.strength = setStrength;\n  force.centerX = setCenterX;\n  force.centerY = setCenterY;\n  force.nodes = setNodes;\n  force.links = setLinks;\n  force.forceNodeSize = setForceNodeSize; // Legacy support\n\n  force.nodeSize = force.forceNodeSize;\n  force.forceCharge = setForceCharge;\n  force.forceLinkDistance = setForceLinkDistance;\n  force.forceLinkStrength = setForceLinkStrength;\n  force.offset = setOffset;\n  force.getFocis = getFocisFromTemplate;\n  return force;\n}\n\nexports.default = forceInABox;","map":{"version":3,"mappings":"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","names":["forceInABox","constant","_","groupBy","d","cluster","forceNodeSize","forceCharge","forceLinkDistance","forceLinkStrength","offset","nodes","nodesMap","links","centerX","centerY","foci","none","x","y","templateNodes","templateForce","template","enableGrouping","strength","force","alpha","tick","getFocisFromTemplate","i","n","length","node","k","vx","vy","initialize","initializeWithForce","undefined","Error","net","getGroupsGraph","d3Force","forceSimulation","forceX","forceY","forceCollide","r","iterations","forceManyBody","forceLink","distance","gnodes","glinks","dNodes","clustersList","clustersCounts","clustersLinks","computeClustersNodeCounts","computeClustersLinkCounts","Object","keys","forEach","key","index","val","push","id","size","count","Math","sqrt","sumforceNodeSize","PI","l","sourceTerminal","targetTerminal","source","target","nodeSize","tmpCount","dClusterLinks","clusterLinks","getLinkKey","entries","_a","split","sourceID","targetID","concat","genNodesMap","setTemplate","arguments","setGroupBy","setEnableGrouping","setStrength","setCenterX","setCenterY","setNodes","setLinks","setForceNodeSize","setForceCharge","setForceLinkDistance","setForceLinkStrength","setOffset","getFocis","exports"],"sourceRoot":"","sources":["../../../src/layout/force/force-in-a-box.ts"],"sourcesContent":[null]},"metadata":{},"sourceType":"script"}