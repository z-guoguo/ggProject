{"ast":null,"code":"import SVD from './dc/svd';\nimport Matrix from './matrix';\nexport function pseudoInverse(matrix, threshold = Number.EPSILON) {\n  matrix = Matrix.checkMatrix(matrix);\n\n  if (matrix.isEmpty()) {\n    // with a zero dimension, the pseudo-inverse is the transpose, since all 0xn and nx0 matrices are singular\n    // (0xn)*(nx0)*(0xn) = 0xn\n    // (nx0)*(0xn)*(nx0) = nx0\n    return matrix.transpose();\n  }\n\n  let svdSolution = new SVD(matrix, {\n    autoTranspose: true\n  });\n  let U = svdSolution.leftSingularVectors;\n  let V = svdSolution.rightSingularVectors;\n  let s = svdSolution.diagonal;\n\n  for (let i = 0; i < s.length; i++) {\n    if (Math.abs(s[i]) > threshold) {\n      s[i] = 1.0 / s[i];\n    } else {\n      s[i] = 0.0;\n    }\n  }\n\n  return V.mmul(Matrix.diag(s).mmul(U.transpose()));\n}","map":{"version":3,"names":["SVD","Matrix","pseudoInverse","matrix","threshold","Number","EPSILON","checkMatrix","isEmpty","transpose","svdSolution","autoTranspose","U","leftSingularVectors","V","rightSingularVectors","s","diagonal","i","length","Math","abs","mmul","diag"],"sources":["/Users/wawalike/Desktop/ggProject/node_modules/ml-matrix/src/pseudoInverse.js"],"sourcesContent":["import SVD from './dc/svd';\nimport Matrix from './matrix';\n\nexport function pseudoInverse(matrix, threshold = Number.EPSILON) {\n  matrix = Matrix.checkMatrix(matrix);\n  if (matrix.isEmpty()) {\n    // with a zero dimension, the pseudo-inverse is the transpose, since all 0xn and nx0 matrices are singular\n    // (0xn)*(nx0)*(0xn) = 0xn\n    // (nx0)*(0xn)*(nx0) = nx0\n    return matrix.transpose();\n  }\n  let svdSolution = new SVD(matrix, { autoTranspose: true });\n\n  let U = svdSolution.leftSingularVectors;\n  let V = svdSolution.rightSingularVectors;\n  let s = svdSolution.diagonal;\n\n  for (let i = 0; i < s.length; i++) {\n    if (Math.abs(s[i]) > threshold) {\n      s[i] = 1.0 / s[i];\n    } else {\n      s[i] = 0.0;\n    }\n  }\n\n  return V.mmul(Matrix.diag(s).mmul(U.transpose()));\n}\n"],"mappings":"AAAA,OAAOA,GAAP,MAAgB,UAAhB;AACA,OAAOC,MAAP,MAAmB,UAAnB;AAEA,OAAO,SAASC,aAAT,CAAuBC,MAAvB,EAA+BC,SAAS,GAAGC,MAAM,CAACC,OAAlD,EAA2D;EAChEH,MAAM,GAAGF,MAAM,CAACM,WAAP,CAAmBJ,MAAnB,CAAT;;EACA,IAAIA,MAAM,CAACK,OAAP,EAAJ,EAAsB;IACpB;IACA;IACA;IACA,OAAOL,MAAM,CAACM,SAAP,EAAP;EACD;;EACD,IAAIC,WAAW,GAAG,IAAIV,GAAJ,CAAQG,MAAR,EAAgB;IAAEQ,aAAa,EAAE;EAAjB,CAAhB,CAAlB;EAEA,IAAIC,CAAC,GAAGF,WAAW,CAACG,mBAApB;EACA,IAAIC,CAAC,GAAGJ,WAAW,CAACK,oBAApB;EACA,IAAIC,CAAC,GAAGN,WAAW,CAACO,QAApB;;EAEA,KAAK,IAAIC,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGF,CAAC,CAACG,MAAtB,EAA8BD,CAAC,EAA/B,EAAmC;IACjC,IAAIE,IAAI,CAACC,GAAL,CAASL,CAAC,CAACE,CAAD,CAAV,IAAiBd,SAArB,EAAgC;MAC9BY,CAAC,CAACE,CAAD,CAAD,GAAO,MAAMF,CAAC,CAACE,CAAD,CAAd;IACD,CAFD,MAEO;MACLF,CAAC,CAACE,CAAD,CAAD,GAAO,GAAP;IACD;EACF;;EAED,OAAOJ,CAAC,CAACQ,IAAF,CAAOrB,MAAM,CAACsB,IAAP,CAAYP,CAAZ,EAAeM,IAAf,CAAoBV,CAAC,CAACH,SAAF,EAApB,CAAP,CAAP;AACD"},"metadata":{},"sourceType":"module"}