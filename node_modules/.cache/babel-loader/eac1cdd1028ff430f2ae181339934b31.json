{"ast":null,"code":"import \"core-js/modules/es.error.cause.js\";\n\nvar __extends = this && this.__extends || function () {\n  var _extendStatics = function extendStatics(d, b) {\n    _extendStatics = Object.setPrototypeOf || {\n      __proto__: []\n    } instanceof Array && function (d, b) {\n      d.__proto__ = b;\n    } || function (d, b) {\n      for (var p in b) {\n        if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p];\n      }\n    };\n\n    return _extendStatics(d, b);\n  };\n\n  return function (d, b) {\n    if (typeof b !== \"function\" && b !== null) throw new TypeError(\"Class extends value \" + String(b) + \" is not a constructor or null\");\n\n    _extendStatics(d, b);\n\n    function __() {\n      this.constructor = d;\n    }\n\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n  };\n}();\n\nvar __assign = this && this.__assign || function () {\n  __assign = Object.assign || function (t) {\n    for (var s, i = 1, n = arguments.length; i < n; i++) {\n      s = arguments[i];\n\n      for (var p in s) {\n        if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\n      }\n    }\n\n    return t;\n  };\n\n  return __assign.apply(this, arguments);\n};\n\nimport { Canvas as GCanvas } from '@antv/g-canvas';\nimport { Canvas as GSVGCanvas } from '@antv/g-svg';\nimport { isString, isNil, each, debounce } from '@antv/util';\nimport { createDom, modifyCSS } from '@antv/dom-util';\nimport { ext } from '@antv/matrix-util';\nimport Base from '../base';\nvar max = Math.max;\nvar transform = ext.transform;\nvar DEFAULT_MODE = 'default';\nvar KEYSHAPE_MODE = 'keyShape';\nvar DELEGATE_MODE = 'delegate';\nvar SVG = 'svg';\n\nvar MiniMap =\n/** @class */\nfunction (_super) {\n  __extends(MiniMap, _super);\n\n  function MiniMap(config) {\n    var _this = _super.call(this, config) || this;\n    /**\n     * 主图更新的监听函数，使用 debounce 减少渲染频率\n     * e.g. 拖拽节点只会在松手后的 100ms 后执行 updateCanvas\n     * e.g. render 时大量 addItem 也只会执行一次 updateCanvas\n     */\n\n\n    _this.handleUpdateCanvas = debounce(function (event) {\n      var self = _this;\n      if (self.destroyed) return;\n      self.updateCanvas();\n    }, 100, false);\n    return _this;\n  }\n\n  MiniMap.prototype.getDefaultCfgs = function () {\n    return {\n      container: null,\n      className: 'g6-minimap',\n      viewportClassName: 'g6-minimap-viewport',\n      // Minimap 中默认展示和主图一样的内容，KeyShape 只展示节点和边的 key shape 部分，delegate表示展示自定义的rect，用户可自定义样式\n      type: 'default',\n      padding: 50,\n      size: [200, 120],\n      delegateStyle: {\n        fill: '#40a9ff',\n        stroke: '#096dd9'\n      },\n      refresh: true\n    };\n  };\n\n  MiniMap.prototype.getEvents = function () {\n    return {\n      beforepaint: 'updateViewport',\n      beforeanimate: 'disableRefresh',\n      afteranimate: 'enableRefresh',\n      viewportchange: 'disableOneRefresh'\n    };\n  }; // 若是正在进行动画，不刷新缩略图\n\n\n  MiniMap.prototype.disableRefresh = function () {\n    this.set('refresh', false);\n  };\n\n  MiniMap.prototype.enableRefresh = function () {\n    this.set('refresh', true);\n    this.updateCanvas();\n  };\n\n  MiniMap.prototype.disableOneRefresh = function () {\n    this.set('viewportChange', true);\n  };\n\n  MiniMap.prototype.initViewport = function () {\n    var _this = this;\n\n    var cfgs = this._cfgs;\n    var size = cfgs.size,\n        graph = cfgs.graph;\n    if (this.destroyed) return;\n    var canvas = this.get('canvas');\n    var containerDOM = canvas.get('container');\n    var viewport = createDom(\"\\n      <div\\n        class=\".concat(cfgs.viewportClassName, \"\\n        style='position:absolute;\\n          left:0;\\n          top:0;\\n          box-sizing:border-box;\\n          outline: 2px solid #1980ff;\\n          cursor:move'\\n        draggable=true\\n      </div>\"));\n    var isFireFox = navigator.userAgent.toLowerCase().indexOf('firefox') > -1; // 计算拖拽水平方向距离\n\n    var x = 0; // 计算拖拽垂直方向距离\n\n    var y = 0; // 是否在拖拽minimap的视口\n\n    var dragging = false; // 缓存viewport当前对于画布的x\n\n    var left = 0; // 缓存viewport当前对于画布的y\n\n    var top = 0; // 缓存viewport当前宽度\n\n    var width = 0; // 缓存viewport当前高度\n\n    var height = 0;\n    var ratio = 0;\n    var zoom = 0;\n    viewport.addEventListener('dragstart', function (e) {\n      var _a, _b;\n\n      if (e.dataTransfer) {\n        var img = new Image();\n        img.src = \"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' %3E%3Cpath /%3E%3C/svg%3E\";\n        (_b = (_a = e.dataTransfer).setDragImage) === null || _b === void 0 ? void 0 : _b.call(_a, img, 0, 0);\n\n        try {\n          e.dataTransfer.setData('text/html', 'view-port-minimap');\n        } catch (_c) {\n          // support IE\n          e.dataTransfer.setData('text', 'view-port-minimap');\n        }\n      }\n\n      cfgs.refresh = false;\n\n      if (e.target !== viewport) {\n        return;\n      } // 如果视口已经最大了，不需要拖拽\n\n\n      var style = viewport.style;\n      left = parseInt(style.left, 10);\n      top = parseInt(style.top, 10);\n      width = parseInt(style.width, 10);\n      height = parseInt(style.height, 10);\n\n      if (width > size[0] || height > size[1]) {\n        return;\n      }\n\n      zoom = graph.getZoom();\n      ratio = _this.get('ratio');\n      dragging = true;\n      x = e.clientX;\n      y = e.clientY;\n    }, false);\n    viewport.addEventListener(isFireFox ? 'dragover' : 'drag', function (e) {\n      if (!dragging || isNil(e.clientX) || isNil(e.clientY)) {\n        return;\n      }\n\n      var dx = x - e.clientX;\n      var dy = y - e.clientY; // 若视口移动到最左边或最右边了,仅移动到边界\n\n      if (left - dx < 0 || left - dx + width >= size[0]) {\n        dx = 0;\n      } // 若视口移动到最上或最下边了，仅移动到边界\n\n\n      if (top - dy < 0 || top - dy + height >= size[1]) {\n        dy = 0;\n      }\n\n      left -= dx;\n      top -= dy; // 先移动视口，避免移动到边上以后出现视口闪烁\n\n      modifyCSS(viewport, {\n        left: \"\".concat(left, \"px\"),\n        top: \"\".concat(top, \"px\")\n      }); // graph 移动需要偏移量 dx/dy * 缩放比例才会得到正确的移动距离\n\n      graph.translate(dx * zoom / ratio, dy * zoom / ratio);\n      x = e.clientX;\n      y = e.clientY;\n    }, false);\n    viewport.addEventListener('dragend', function () {\n      dragging = false;\n      cfgs.refresh = true;\n    }, false);\n    this.set('viewport', viewport);\n    containerDOM.appendChild(viewport);\n  };\n  /**\n   * 更新 viewport 视图\n   */\n\n\n  MiniMap.prototype.updateViewport = function () {\n    if (this.destroyed) return;\n    var ratio = this.get('ratio');\n    var dx = this.get('dx');\n    var dy = this.get('dy');\n    var totaldx = this.get('totaldx');\n    var totaldy = this.get('totaldy');\n    var graph = this.get('graph');\n    var size = this.get('size');\n    var graphWidth = graph.get('width');\n    var graphHeight = graph.get('height');\n    var topLeft = graph.getPointByCanvas(0, 0);\n    var bottomRight = graph.getPointByCanvas(graphWidth, graphHeight);\n    var viewport = this.get('viewport');\n\n    if (!viewport) {\n      this.initViewport();\n    } // viewport宽高,左上角点的计算\n\n\n    var width = (bottomRight.x - topLeft.x) * ratio;\n    var height = (bottomRight.y - topLeft.y) * ratio;\n    var left = topLeft.x * ratio + totaldx;\n    var top = topLeft.y * ratio + totaldy;\n    var right = left + width;\n    var bottom = top + height;\n\n    if (left < 0) {\n      width += left;\n      left = 0;\n    }\n\n    if (right > size[0]) {\n      width = width - (right - size[0]);\n    }\n\n    if (top < 0) {\n      height += top;\n      top = 0;\n    }\n\n    if (bottom > size[1]) {\n      height = height - (bottom - size[1]);\n    } // 缓存目前缩放比，在移动 minimap 视窗时就不用再计算大图的移动量\n\n\n    this.set('ratio', ratio);\n    var correctLeft = \"\".concat(left, \"px\");\n    var correctTop = \"\".concat(top, \"px\");\n    modifyCSS(viewport, {\n      left: correctLeft,\n      top: correctTop,\n      width: \"\".concat(width, \"px\"),\n      height: \"\".concat(height, \"px\")\n    });\n  };\n  /**\n   * 将主图上的图形完全复制到小图\n   */\n\n\n  MiniMap.prototype.updateGraphShapes = function () {\n    var graph = this._cfgs.graph;\n    var canvas = this.get('canvas');\n    var graphGroup = graph.get('group');\n    if (graphGroup.destroyed) return;\n    var clonedGroup = graphGroup.clone();\n    clonedGroup.resetMatrix();\n    canvas.clear();\n    canvas.add(clonedGroup); // 当 renderer 是 svg，由于渲染引擎的 bug，这里需要将 visible 为 false 的元素手动隐藏\n\n    var renderer = graph.get('renderer');\n\n    if (renderer === SVG) {\n      // 递归更新子元素\n      this.updateVisible(clonedGroup);\n    }\n  }; // svg 在 canvas.add(clonedGroup) 之后会出现 visible 为 false 的元素被展示出来，需要递归更新\n\n\n  MiniMap.prototype.updateVisible = function (ele) {\n    var _this = this;\n\n    if (!ele.isGroup() && !ele.get('visible')) {\n      ele.hide();\n    } else {\n      var children = ele.get('children');\n      if (!children || !children.length) return;\n      children.forEach(function (child) {\n        if (!child.get('visible')) child.hide();\n\n        _this.updateVisible(child);\n      });\n    }\n  }; // 仅在 minimap 上绘制 keyShape\n  // FIXME 如果用户自定义绘制了其他内容，minimap上就无法画出\n\n\n  MiniMap.prototype.updateKeyShapes = function () {\n    var _this = this;\n\n    var graph = this._cfgs.graph;\n    var canvas = this.get('canvas');\n    var group = canvas.get('children')[0] || canvas.addGroup();\n    each(graph.getEdges(), function (edge) {\n      _this.updateOneEdgeKeyShape(edge, group);\n    });\n    each(graph.getNodes(), function (node) {\n      _this.updateOneNodeKeyShape(node, group);\n    });\n    var combos = graph.getCombos();\n\n    if (combos && combos.length) {\n      var comboGroup_1 = group.find(function (e) {\n        return e.get('name') === 'comboGroup';\n      }) || group.addGroup({\n        name: 'comboGroup'\n      });\n      setTimeout(function () {\n        if (_this.destroyed) return;\n        each(combos, function (combo) {\n          _this.updateOneComboKeyShape(combo, comboGroup_1);\n        });\n        comboGroup_1 === null || comboGroup_1 === void 0 ? void 0 : comboGroup_1.sort();\n        comboGroup_1 === null || comboGroup_1 === void 0 ? void 0 : comboGroup_1.toBack();\n\n        _this.updateCanvas();\n      }, 250);\n    }\n\n    this.clearDestroyedShapes();\n  };\n  /**\n   * 增加/更新单个元素的 keyShape\n   * @param item ICombo 实例\n   */\n\n\n  MiniMap.prototype.updateOneComboKeyShape = function (item, comboGroup) {\n    if (this.destroyed) return;\n    var itemMap = this.get('itemMap') || {}; // 差量更新 minimap 上的一个节点，对应主图的 item\n\n    var mappedItem = itemMap[item.get('id')];\n    var bbox = item.getBBox(); // 计算了节点父组矩阵的 bbox\n\n    var cKeyShape = item.get('keyShape').clone();\n    var keyShapeStyle = cKeyShape.attr();\n    var attrs = {\n      x: bbox.centerX,\n      y: bbox.centerY\n    };\n\n    if (!mappedItem) {\n      mappedItem = cKeyShape;\n      comboGroup.add(mappedItem);\n    } else {\n      attrs = Object.assign(keyShapeStyle, attrs);\n    }\n\n    var shapeType = mappedItem.get('type');\n\n    if (shapeType === 'rect' || shapeType === 'image') {\n      attrs.x = bbox.minX;\n      attrs.y = bbox.minY;\n    }\n\n    mappedItem.attr(attrs);\n    if (!item.isVisible()) mappedItem.hide();else mappedItem.show();\n    mappedItem.exist = true;\n    var zIndex = item.getModel().depth;\n    if (!isNaN(zIndex)) mappedItem.set('zIndex', zIndex);\n    itemMap[item.get('id')] = mappedItem;\n    this.set('itemMap', itemMap);\n  };\n  /**\n   * 增加/更新单个元素的 keyShape\n   * @param item INode 实例\n   */\n\n\n  MiniMap.prototype.updateOneNodeKeyShape = function (item, group) {\n    var itemMap = this.get('itemMap') || {}; // 差量更新 minimap 上的一个节点，对应主图的 item\n\n    var mappedItem = itemMap[item.get('id')];\n    var bbox = item.getBBox(); // 计算了节点父组矩阵的 bbox\n\n    var cKeyShape = item.get('keyShape').clone();\n    var keyShapeStyle = cKeyShape.attr();\n    var attrs = {\n      x: bbox.centerX,\n      y: bbox.centerY\n    };\n\n    if (!mappedItem) {\n      mappedItem = cKeyShape;\n      group.add(mappedItem);\n    } else {\n      attrs = Object.assign(keyShapeStyle, attrs);\n    }\n\n    var shapeType = mappedItem.get('type');\n\n    if (shapeType === 'rect' || shapeType === 'image') {\n      attrs.x = bbox.minX;\n      attrs.y = bbox.minY;\n    }\n\n    mappedItem.attr(attrs);\n    if (!item.isVisible()) mappedItem.hide();else mappedItem.show();\n    mappedItem.exist = true;\n    var zIndex = item.getModel().depth;\n    if (!isNaN(zIndex)) mappedItem.set('zIndex', zIndex);\n    itemMap[item.get('id')] = mappedItem;\n    this.set('itemMap', itemMap);\n  };\n  /**\n   * Minimap 中展示自定义的rect，支持用户自定义样式和节点大小\n   */\n\n\n  MiniMap.prototype.updateDelegateShapes = function () {\n    var _this = this;\n\n    var graph = this._cfgs.graph;\n    var canvas = this.get('canvas');\n    var group = canvas.get('children')[0] || canvas.addGroup(); // 差量更新 minimap 上的节点和边\n\n    each(graph.getEdges(), function (edge) {\n      _this.updateOneEdgeKeyShape(edge, group);\n    });\n    each(graph.getNodes(), function (node) {\n      _this.updateOneNodeDelegateShape(node, group);\n    });\n    var combos = graph.getCombos();\n\n    if (combos && combos.length) {\n      var comboGroup_2 = group.find(function (e) {\n        return e.get('name') === 'comboGroup';\n      }) || group.addGroup({\n        name: 'comboGroup'\n      });\n      setTimeout(function () {\n        if (_this.destroyed) return;\n        each(combos, function (combo) {\n          _this.updateOneComboKeyShape(combo, comboGroup_2);\n        });\n        comboGroup_2 === null || comboGroup_2 === void 0 ? void 0 : comboGroup_2.sort();\n        comboGroup_2 === null || comboGroup_2 === void 0 ? void 0 : comboGroup_2.toBack();\n\n        _this.updateCanvas();\n      }, 250);\n    }\n\n    this.clearDestroyedShapes();\n  };\n\n  MiniMap.prototype.clearDestroyedShapes = function () {\n    var itemMap = this.get('itemMap') || {};\n    var keys = Object.keys(itemMap);\n    if (!keys || keys.length === 0) return;\n\n    for (var i = keys.length - 1; i >= 0; i--) {\n      var shape = itemMap[keys[i]];\n      var exist = shape.exist;\n      shape.exist = false;\n\n      if (!exist) {\n        shape.remove();\n        delete itemMap[keys[i]];\n      }\n    }\n  };\n  /**\n   * 设置只显示 edge 的 keyShape\n   * @param item IEdge 实例\n   */\n\n\n  MiniMap.prototype.updateOneEdgeKeyShape = function (item, group) {\n    var itemMap = this.get('itemMap') || {}; // 差量更新 minimap 上的一个节点，对应主图的 item\n\n    var mappedItem = itemMap[item.get('id')];\n\n    if (mappedItem) {\n      var path = item.get('keyShape').attr('path');\n      mappedItem.attr('path', path);\n    } else {\n      mappedItem = item.get('keyShape').clone();\n      group.add(mappedItem);\n    }\n\n    if (!item.isVisible()) mappedItem.hide();else mappedItem.show();\n    mappedItem.exist = true;\n    itemMap[item.get('id')] = mappedItem;\n    this.set('itemMap', itemMap);\n  };\n  /**\n   * Minimap 中展示自定义的 rect，支持用户自定义样式和节点大小\n   * 增加/更新单个元素\n   * @param item INode 实例\n   */\n\n\n  MiniMap.prototype.updateOneNodeDelegateShape = function (item, group) {\n    var delegateStyle = this.get('delegateStyle');\n    var itemMap = this.get('itemMap') || {}; // 差量更新 minimap 上的一个节点，对应主图的 item\n\n    var mappedItem = itemMap[item.get('id')];\n    var bbox = item.getBBox(); // 计算了节点父组矩阵的 bbox\n\n    if (mappedItem) {\n      var attrs = {\n        x: bbox.minX,\n        y: bbox.minY,\n        width: bbox.width,\n        height: bbox.height\n      };\n      mappedItem.attr(attrs);\n    } else {\n      mappedItem = group.addShape('rect', {\n        attrs: __assign({\n          x: bbox.minX,\n          y: bbox.minY,\n          width: bbox.width,\n          height: bbox.height\n        }, delegateStyle),\n        name: 'minimap-node-shape'\n      });\n    }\n\n    if (!item.isVisible()) mappedItem.hide();else mappedItem.show();\n    mappedItem.exist = true;\n    itemMap[item.get('id')] = mappedItem;\n    this.set('itemMap', itemMap);\n  };\n\n  MiniMap.prototype.init = function () {\n    this.initContainer();\n    this.get('graph').on('afterupdateitem', this.handleUpdateCanvas);\n    this.get('graph').on('afteritemstatechange', this.handleUpdateCanvas);\n    this.get('graph').on('afteradditem', this.handleUpdateCanvas);\n    this.get('graph').on('afterremoveitem', this.handleUpdateCanvas);\n    this.get('graph').on('afterrender', this.handleUpdateCanvas);\n    this.get('graph').on('afterlayout', this.handleUpdateCanvas);\n  };\n  /**\n   * 初始化 Minimap 的容器\n   */\n\n\n  MiniMap.prototype.initContainer = function () {\n    var self = this;\n    var graph = self.get('graph');\n    var size = self.get('size');\n    var className = self.get('className');\n    var parentNode = self.get('container');\n    var container = createDom(\"<div class='\".concat(className, \"' style='width: \").concat(size[0], \"px; height: \").concat(size[1], \"px; overflow: hidden'></div>\"));\n\n    if (isString(parentNode)) {\n      parentNode = document.getElementById(parentNode);\n    }\n\n    if (parentNode) {\n      parentNode.appendChild(container);\n    } else {\n      graph.get('container').appendChild(container);\n    }\n\n    self.set('container', container);\n    var containerDOM = createDom('<div class=\"g6-minimap-container\" style=\"position: relative;\"></div>');\n    container.appendChild(containerDOM);\n    containerDOM.addEventListener('dragenter', function (e) {\n      e.preventDefault();\n    });\n    containerDOM.addEventListener('dragover', function (e) {\n      e.preventDefault();\n    });\n    var canvas;\n    var renderer = graph.get('renderer');\n\n    if (renderer === SVG) {\n      canvas = new GSVGCanvas({\n        container: containerDOM,\n        width: size[0],\n        height: size[1]\n      });\n    } else {\n      canvas = new GCanvas({\n        container: containerDOM,\n        width: size[0],\n        height: size[1]\n      });\n    }\n\n    self.set('canvas', canvas);\n    self.updateCanvas();\n  };\n\n  MiniMap.prototype.updateCanvas = function () {\n    if (this.destroyed) return; // 如果是在动画，则不刷新视图\n\n    var isRefresh = this.get('refresh');\n\n    if (!isRefresh) {\n      return;\n    }\n\n    var graph = this.get('graph');\n\n    if (graph.get('destroyed')) {\n      return;\n    } // 如果是视口变换，也不刷新视图，但是需要重置视口大小和位置\n\n\n    if (this.get('viewportChange')) {\n      this.set('viewportChange', false);\n      this.updateViewport();\n    }\n\n    var size = this.get('size'); // 用户定义的 minimap size\n\n    var canvas = this.get('canvas'); // minimap 的 canvas\n\n    var type = this.get('type'); // minimap 的类型\n\n    var padding = this.get('padding'); // 用户额定义的 minimap 的 padding\n\n    if (canvas.destroyed) {\n      return;\n    }\n\n    switch (type) {\n      case DEFAULT_MODE:\n        this.updateGraphShapes();\n        break;\n\n      case KEYSHAPE_MODE:\n        this.updateKeyShapes();\n        break;\n\n      case DELEGATE_MODE:\n        // 得到的节点直接带有 x 和 y，每个节点不存在父 group，即每个节点位置不由父 group 控制\n        this.updateDelegateShapes();\n        break;\n\n      default:\n        break;\n    }\n\n    var group = canvas.get('children')[0];\n    if (!group) return;\n    group.resetMatrix(); // 该 bbox 是准确的，不计算 matrix 的包围盒\n\n    var bbox = group.getCanvasBBox();\n    var graphBBox = graph.get('canvas').getCanvasBBox(); // 主图的 bbox\n\n    var graphZoom = graph.getZoom() || 1;\n    var width = graphBBox.width / graphZoom;\n    var height = graphBBox.height / graphZoom;\n\n    if (Number.isFinite(bbox.width)) {\n      // 刷新后bbox可能会变，需要重置画布矩阵以缩放到合适的大小\n      width = max(bbox.width, width);\n      height = max(bbox.height, height);\n    }\n\n    width += 2 * padding;\n    height += 2 * padding;\n    var ratio = Math.min(size[0] / width, size[1] / height);\n    var matrix = [1, 0, 0, 0, 1, 0, 0, 0, 1];\n    var minX = 0;\n    var minY = 0; // 平移到左上角\n\n    if (Number.isFinite(bbox.minX)) {\n      minX = -bbox.minX;\n    }\n\n    if (Number.isFinite(bbox.minY)) {\n      minY = -bbox.minY;\n    } // 缩放到适合视口后, 平移到画布中心\n\n\n    var dx = (size[0] - (width - 2 * padding) * ratio) / 2;\n    var dy = (size[1] - (height - 2 * padding) * ratio) / 2;\n    matrix = transform(matrix, [['t', minX, minY], ['s', ratio, ratio], ['t', dx, dy] // 移动到画布中心\n    ]);\n    group.setMatrix(matrix); // 更新minimap视口\n\n    this.set('ratio', ratio);\n    this.set('totaldx', dx + minX * ratio);\n    this.set('totaldy', dy + minY * ratio);\n    this.set('dx', dx);\n    this.set('dy', dy);\n    this.updateViewport();\n  };\n  /**\n   * 获取minimap的画布\n   * @return {GCanvas} G的canvas实例\n   */\n\n\n  MiniMap.prototype.getCanvas = function () {\n    return this.get('canvas');\n  };\n  /**\n   * 获取minimap的窗口\n   * @return {HTMLElement} 窗口的dom实例\n   */\n\n\n  MiniMap.prototype.getViewport = function () {\n    return this.get('viewport');\n  };\n  /**\n   * 获取minimap的容器dom\n   * @return {HTMLElement} dom\n   */\n\n\n  MiniMap.prototype.getContainer = function () {\n    return this.get('container');\n  };\n\n  MiniMap.prototype.destroy = function () {\n    var _a;\n\n    (_a = this.get('canvas')) === null || _a === void 0 ? void 0 : _a.destroy();\n    var container = this.get('container');\n    if (container === null || container === void 0 ? void 0 : container.parentNode) container.parentNode.removeChild(container);\n  };\n\n  return MiniMap;\n}(Base);\n\nexport default MiniMap;","map":{"version":3,"names":["__extends","_extendStatics","extendStatics","d","b","Object","setPrototypeOf","__proto__","Array","p","prototype","hasOwnProperty","call","TypeError","String","__","constructor","create","__assign","assign","t","s","i","n","arguments","length","apply","Canvas","GCanvas","GSVGCanvas","isString","isNil","each","debounce","createDom","modifyCSS","ext","Base","max","Math","transform","DEFAULT_MODE","KEYSHAPE_MODE","DELEGATE_MODE","SVG","MiniMap","_super","config","_this","handleUpdateCanvas","event","self","destroyed","updateCanvas","getDefaultCfgs","container","className","viewportClassName","type","padding","size","delegateStyle","fill","stroke","refresh","getEvents","beforepaint","beforeanimate","afteranimate","viewportchange","disableRefresh","set","enableRefresh","disableOneRefresh","initViewport","cfgs","_cfgs","graph","canvas","get","containerDOM","viewport","concat","isFireFox","navigator","userAgent","toLowerCase","indexOf","x","y","dragging","left","top","width","height","ratio","zoom","addEventListener","e","_a","_b","dataTransfer","img","Image","src","setDragImage","setData","_c","target","style","parseInt","getZoom","clientX","clientY","dx","dy","translate","appendChild","updateViewport","totaldx","totaldy","graphWidth","graphHeight","topLeft","getPointByCanvas","bottomRight","right","bottom","correctLeft","correctTop","updateGraphShapes","graphGroup","clonedGroup","clone","resetMatrix","clear","add","renderer","updateVisible","ele","isGroup","hide","children","forEach","child","updateKeyShapes","group","addGroup","getEdges","edge","updateOneEdgeKeyShape","getNodes","node","updateOneNodeKeyShape","combos","getCombos","comboGroup_1","find","name","setTimeout","combo","updateOneComboKeyShape","sort","toBack","clearDestroyedShapes","item","comboGroup","itemMap","mappedItem","bbox","getBBox","cKeyShape","keyShapeStyle","attr","attrs","centerX","centerY","shapeType","minX","minY","isVisible","show","exist","zIndex","getModel","depth","isNaN","updateDelegateShapes","updateOneNodeDelegateShape","comboGroup_2","keys","shape","remove","path","addShape","init","initContainer","on","parentNode","document","getElementById","preventDefault","isRefresh","getCanvasBBox","graphBBox","graphZoom","Number","isFinite","min","matrix","setMatrix","getCanvas","getViewport","getContainer","destroy","removeChild"],"sources":["/Users/wawalike/Desktop/ggProject/node_modules/@antv/g6-plugin/es/minimap/index.js"],"sourcesContent":["var __extends = this && this.__extends || function () {\n  var _extendStatics = function extendStatics(d, b) {\n    _extendStatics = Object.setPrototypeOf || {\n      __proto__: []\n    } instanceof Array && function (d, b) {\n      d.__proto__ = b;\n    } || function (d, b) {\n      for (var p in b) {\n        if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p];\n      }\n    };\n\n    return _extendStatics(d, b);\n  };\n\n  return function (d, b) {\n    if (typeof b !== \"function\" && b !== null) throw new TypeError(\"Class extends value \" + String(b) + \" is not a constructor or null\");\n\n    _extendStatics(d, b);\n\n    function __() {\n      this.constructor = d;\n    }\n\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n  };\n}();\n\nvar __assign = this && this.__assign || function () {\n  __assign = Object.assign || function (t) {\n    for (var s, i = 1, n = arguments.length; i < n; i++) {\n      s = arguments[i];\n\n      for (var p in s) {\n        if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\n      }\n    }\n\n    return t;\n  };\n\n  return __assign.apply(this, arguments);\n};\n\nimport { Canvas as GCanvas } from '@antv/g-canvas';\nimport { Canvas as GSVGCanvas } from '@antv/g-svg';\nimport { isString, isNil, each, debounce } from '@antv/util';\nimport { createDom, modifyCSS } from '@antv/dom-util';\nimport { ext } from '@antv/matrix-util';\nimport Base from '../base';\nvar max = Math.max;\nvar transform = ext.transform;\nvar DEFAULT_MODE = 'default';\nvar KEYSHAPE_MODE = 'keyShape';\nvar DELEGATE_MODE = 'delegate';\nvar SVG = 'svg';\n\nvar MiniMap =\n/** @class */\nfunction (_super) {\n  __extends(MiniMap, _super);\n\n  function MiniMap(config) {\n    var _this = _super.call(this, config) || this;\n    /**\n     * 主图更新的监听函数，使用 debounce 减少渲染频率\n     * e.g. 拖拽节点只会在松手后的 100ms 后执行 updateCanvas\n     * e.g. render 时大量 addItem 也只会执行一次 updateCanvas\n     */\n\n\n    _this.handleUpdateCanvas = debounce(function (event) {\n      var self = _this;\n      if (self.destroyed) return;\n      self.updateCanvas();\n    }, 100, false);\n    return _this;\n  }\n\n  MiniMap.prototype.getDefaultCfgs = function () {\n    return {\n      container: null,\n      className: 'g6-minimap',\n      viewportClassName: 'g6-minimap-viewport',\n      // Minimap 中默认展示和主图一样的内容，KeyShape 只展示节点和边的 key shape 部分，delegate表示展示自定义的rect，用户可自定义样式\n      type: 'default',\n      padding: 50,\n      size: [200, 120],\n      delegateStyle: {\n        fill: '#40a9ff',\n        stroke: '#096dd9'\n      },\n      refresh: true\n    };\n  };\n\n  MiniMap.prototype.getEvents = function () {\n    return {\n      beforepaint: 'updateViewport',\n      beforeanimate: 'disableRefresh',\n      afteranimate: 'enableRefresh',\n      viewportchange: 'disableOneRefresh'\n    };\n  }; // 若是正在进行动画，不刷新缩略图\n\n\n  MiniMap.prototype.disableRefresh = function () {\n    this.set('refresh', false);\n  };\n\n  MiniMap.prototype.enableRefresh = function () {\n    this.set('refresh', true);\n    this.updateCanvas();\n  };\n\n  MiniMap.prototype.disableOneRefresh = function () {\n    this.set('viewportChange', true);\n  };\n\n  MiniMap.prototype.initViewport = function () {\n    var _this = this;\n\n    var cfgs = this._cfgs;\n    var size = cfgs.size,\n        graph = cfgs.graph;\n    if (this.destroyed) return;\n    var canvas = this.get('canvas');\n    var containerDOM = canvas.get('container');\n    var viewport = createDom(\"\\n      <div\\n        class=\".concat(cfgs.viewportClassName, \"\\n        style='position:absolute;\\n          left:0;\\n          top:0;\\n          box-sizing:border-box;\\n          outline: 2px solid #1980ff;\\n          cursor:move'\\n        draggable=true\\n      </div>\"));\n    var isFireFox = navigator.userAgent.toLowerCase().indexOf('firefox') > -1; // 计算拖拽水平方向距离\n\n    var x = 0; // 计算拖拽垂直方向距离\n\n    var y = 0; // 是否在拖拽minimap的视口\n\n    var dragging = false; // 缓存viewport当前对于画布的x\n\n    var left = 0; // 缓存viewport当前对于画布的y\n\n    var top = 0; // 缓存viewport当前宽度\n\n    var width = 0; // 缓存viewport当前高度\n\n    var height = 0;\n    var ratio = 0;\n    var zoom = 0;\n    viewport.addEventListener('dragstart', function (e) {\n      var _a, _b;\n\n      if (e.dataTransfer) {\n        var img = new Image();\n        img.src = \"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' %3E%3Cpath /%3E%3C/svg%3E\";\n        (_b = (_a = e.dataTransfer).setDragImage) === null || _b === void 0 ? void 0 : _b.call(_a, img, 0, 0);\n\n        try {\n          e.dataTransfer.setData('text/html', 'view-port-minimap');\n        } catch (_c) {\n          // support IE\n          e.dataTransfer.setData('text', 'view-port-minimap');\n        }\n      }\n\n      cfgs.refresh = false;\n\n      if (e.target !== viewport) {\n        return;\n      } // 如果视口已经最大了，不需要拖拽\n\n\n      var style = viewport.style;\n      left = parseInt(style.left, 10);\n      top = parseInt(style.top, 10);\n      width = parseInt(style.width, 10);\n      height = parseInt(style.height, 10);\n\n      if (width > size[0] || height > size[1]) {\n        return;\n      }\n\n      zoom = graph.getZoom();\n      ratio = _this.get('ratio');\n      dragging = true;\n      x = e.clientX;\n      y = e.clientY;\n    }, false);\n    viewport.addEventListener(isFireFox ? 'dragover' : 'drag', function (e) {\n      if (!dragging || isNil(e.clientX) || isNil(e.clientY)) {\n        return;\n      }\n\n      var dx = x - e.clientX;\n      var dy = y - e.clientY; // 若视口移动到最左边或最右边了,仅移动到边界\n\n      if (left - dx < 0 || left - dx + width >= size[0]) {\n        dx = 0;\n      } // 若视口移动到最上或最下边了，仅移动到边界\n\n\n      if (top - dy < 0 || top - dy + height >= size[1]) {\n        dy = 0;\n      }\n\n      left -= dx;\n      top -= dy; // 先移动视口，避免移动到边上以后出现视口闪烁\n\n      modifyCSS(viewport, {\n        left: \"\".concat(left, \"px\"),\n        top: \"\".concat(top, \"px\")\n      }); // graph 移动需要偏移量 dx/dy * 缩放比例才会得到正确的移动距离\n\n      graph.translate(dx * zoom / ratio, dy * zoom / ratio);\n      x = e.clientX;\n      y = e.clientY;\n    }, false);\n    viewport.addEventListener('dragend', function () {\n      dragging = false;\n      cfgs.refresh = true;\n    }, false);\n    this.set('viewport', viewport);\n    containerDOM.appendChild(viewport);\n  };\n  /**\n   * 更新 viewport 视图\n   */\n\n\n  MiniMap.prototype.updateViewport = function () {\n    if (this.destroyed) return;\n    var ratio = this.get('ratio');\n    var dx = this.get('dx');\n    var dy = this.get('dy');\n    var totaldx = this.get('totaldx');\n    var totaldy = this.get('totaldy');\n    var graph = this.get('graph');\n    var size = this.get('size');\n    var graphWidth = graph.get('width');\n    var graphHeight = graph.get('height');\n    var topLeft = graph.getPointByCanvas(0, 0);\n    var bottomRight = graph.getPointByCanvas(graphWidth, graphHeight);\n    var viewport = this.get('viewport');\n\n    if (!viewport) {\n      this.initViewport();\n    } // viewport宽高,左上角点的计算\n\n\n    var width = (bottomRight.x - topLeft.x) * ratio;\n    var height = (bottomRight.y - topLeft.y) * ratio;\n    var left = topLeft.x * ratio + totaldx;\n    var top = topLeft.y * ratio + totaldy;\n    var right = left + width;\n    var bottom = top + height;\n\n    if (left < 0) {\n      width += left;\n      left = 0;\n    }\n\n    if (right > size[0]) {\n      width = width - (right - size[0]);\n    }\n\n    if (top < 0) {\n      height += top;\n      top = 0;\n    }\n\n    if (bottom > size[1]) {\n      height = height - (bottom - size[1]);\n    } // 缓存目前缩放比，在移动 minimap 视窗时就不用再计算大图的移动量\n\n\n    this.set('ratio', ratio);\n    var correctLeft = \"\".concat(left, \"px\");\n    var correctTop = \"\".concat(top, \"px\");\n    modifyCSS(viewport, {\n      left: correctLeft,\n      top: correctTop,\n      width: \"\".concat(width, \"px\"),\n      height: \"\".concat(height, \"px\")\n    });\n  };\n  /**\n   * 将主图上的图形完全复制到小图\n   */\n\n\n  MiniMap.prototype.updateGraphShapes = function () {\n    var graph = this._cfgs.graph;\n    var canvas = this.get('canvas');\n    var graphGroup = graph.get('group');\n    if (graphGroup.destroyed) return;\n    var clonedGroup = graphGroup.clone();\n    clonedGroup.resetMatrix();\n    canvas.clear();\n    canvas.add(clonedGroup); // 当 renderer 是 svg，由于渲染引擎的 bug，这里需要将 visible 为 false 的元素手动隐藏\n\n    var renderer = graph.get('renderer');\n\n    if (renderer === SVG) {\n      // 递归更新子元素\n      this.updateVisible(clonedGroup);\n    }\n  }; // svg 在 canvas.add(clonedGroup) 之后会出现 visible 为 false 的元素被展示出来，需要递归更新\n\n\n  MiniMap.prototype.updateVisible = function (ele) {\n    var _this = this;\n\n    if (!ele.isGroup() && !ele.get('visible')) {\n      ele.hide();\n    } else {\n      var children = ele.get('children');\n      if (!children || !children.length) return;\n      children.forEach(function (child) {\n        if (!child.get('visible')) child.hide();\n\n        _this.updateVisible(child);\n      });\n    }\n  }; // 仅在 minimap 上绘制 keyShape\n  // FIXME 如果用户自定义绘制了其他内容，minimap上就无法画出\n\n\n  MiniMap.prototype.updateKeyShapes = function () {\n    var _this = this;\n\n    var graph = this._cfgs.graph;\n    var canvas = this.get('canvas');\n    var group = canvas.get('children')[0] || canvas.addGroup();\n    each(graph.getEdges(), function (edge) {\n      _this.updateOneEdgeKeyShape(edge, group);\n    });\n    each(graph.getNodes(), function (node) {\n      _this.updateOneNodeKeyShape(node, group);\n    });\n    var combos = graph.getCombos();\n\n    if (combos && combos.length) {\n      var comboGroup_1 = group.find(function (e) {\n        return e.get('name') === 'comboGroup';\n      }) || group.addGroup({\n        name: 'comboGroup'\n      });\n      setTimeout(function () {\n        if (_this.destroyed) return;\n        each(combos, function (combo) {\n          _this.updateOneComboKeyShape(combo, comboGroup_1);\n        });\n        comboGroup_1 === null || comboGroup_1 === void 0 ? void 0 : comboGroup_1.sort();\n        comboGroup_1 === null || comboGroup_1 === void 0 ? void 0 : comboGroup_1.toBack();\n\n        _this.updateCanvas();\n      }, 250);\n    }\n\n    this.clearDestroyedShapes();\n  };\n  /**\n   * 增加/更新单个元素的 keyShape\n   * @param item ICombo 实例\n   */\n\n\n  MiniMap.prototype.updateOneComboKeyShape = function (item, comboGroup) {\n    if (this.destroyed) return;\n    var itemMap = this.get('itemMap') || {}; // 差量更新 minimap 上的一个节点，对应主图的 item\n\n    var mappedItem = itemMap[item.get('id')];\n    var bbox = item.getBBox(); // 计算了节点父组矩阵的 bbox\n\n    var cKeyShape = item.get('keyShape').clone();\n    var keyShapeStyle = cKeyShape.attr();\n    var attrs = {\n      x: bbox.centerX,\n      y: bbox.centerY\n    };\n\n    if (!mappedItem) {\n      mappedItem = cKeyShape;\n      comboGroup.add(mappedItem);\n    } else {\n      attrs = Object.assign(keyShapeStyle, attrs);\n    }\n\n    var shapeType = mappedItem.get('type');\n\n    if (shapeType === 'rect' || shapeType === 'image') {\n      attrs.x = bbox.minX;\n      attrs.y = bbox.minY;\n    }\n\n    mappedItem.attr(attrs);\n    if (!item.isVisible()) mappedItem.hide();else mappedItem.show();\n    mappedItem.exist = true;\n    var zIndex = item.getModel().depth;\n    if (!isNaN(zIndex)) mappedItem.set('zIndex', zIndex);\n    itemMap[item.get('id')] = mappedItem;\n    this.set('itemMap', itemMap);\n  };\n  /**\n   * 增加/更新单个元素的 keyShape\n   * @param item INode 实例\n   */\n\n\n  MiniMap.prototype.updateOneNodeKeyShape = function (item, group) {\n    var itemMap = this.get('itemMap') || {}; // 差量更新 minimap 上的一个节点，对应主图的 item\n\n    var mappedItem = itemMap[item.get('id')];\n    var bbox = item.getBBox(); // 计算了节点父组矩阵的 bbox\n\n    var cKeyShape = item.get('keyShape').clone();\n    var keyShapeStyle = cKeyShape.attr();\n    var attrs = {\n      x: bbox.centerX,\n      y: bbox.centerY\n    };\n\n    if (!mappedItem) {\n      mappedItem = cKeyShape;\n      group.add(mappedItem);\n    } else {\n      attrs = Object.assign(keyShapeStyle, attrs);\n    }\n\n    var shapeType = mappedItem.get('type');\n\n    if (shapeType === 'rect' || shapeType === 'image') {\n      attrs.x = bbox.minX;\n      attrs.y = bbox.minY;\n    }\n\n    mappedItem.attr(attrs);\n    if (!item.isVisible()) mappedItem.hide();else mappedItem.show();\n    mappedItem.exist = true;\n    var zIndex = item.getModel().depth;\n    if (!isNaN(zIndex)) mappedItem.set('zIndex', zIndex);\n    itemMap[item.get('id')] = mappedItem;\n    this.set('itemMap', itemMap);\n  };\n  /**\n   * Minimap 中展示自定义的rect，支持用户自定义样式和节点大小\n   */\n\n\n  MiniMap.prototype.updateDelegateShapes = function () {\n    var _this = this;\n\n    var graph = this._cfgs.graph;\n    var canvas = this.get('canvas');\n    var group = canvas.get('children')[0] || canvas.addGroup(); // 差量更新 minimap 上的节点和边\n\n    each(graph.getEdges(), function (edge) {\n      _this.updateOneEdgeKeyShape(edge, group);\n    });\n    each(graph.getNodes(), function (node) {\n      _this.updateOneNodeDelegateShape(node, group);\n    });\n    var combos = graph.getCombos();\n\n    if (combos && combos.length) {\n      var comboGroup_2 = group.find(function (e) {\n        return e.get('name') === 'comboGroup';\n      }) || group.addGroup({\n        name: 'comboGroup'\n      });\n      setTimeout(function () {\n        if (_this.destroyed) return;\n        each(combos, function (combo) {\n          _this.updateOneComboKeyShape(combo, comboGroup_2);\n        });\n        comboGroup_2 === null || comboGroup_2 === void 0 ? void 0 : comboGroup_2.sort();\n        comboGroup_2 === null || comboGroup_2 === void 0 ? void 0 : comboGroup_2.toBack();\n\n        _this.updateCanvas();\n      }, 250);\n    }\n\n    this.clearDestroyedShapes();\n  };\n\n  MiniMap.prototype.clearDestroyedShapes = function () {\n    var itemMap = this.get('itemMap') || {};\n    var keys = Object.keys(itemMap);\n    if (!keys || keys.length === 0) return;\n\n    for (var i = keys.length - 1; i >= 0; i--) {\n      var shape = itemMap[keys[i]];\n      var exist = shape.exist;\n      shape.exist = false;\n\n      if (!exist) {\n        shape.remove();\n        delete itemMap[keys[i]];\n      }\n    }\n  };\n  /**\n   * 设置只显示 edge 的 keyShape\n   * @param item IEdge 实例\n   */\n\n\n  MiniMap.prototype.updateOneEdgeKeyShape = function (item, group) {\n    var itemMap = this.get('itemMap') || {}; // 差量更新 minimap 上的一个节点，对应主图的 item\n\n    var mappedItem = itemMap[item.get('id')];\n\n    if (mappedItem) {\n      var path = item.get('keyShape').attr('path');\n      mappedItem.attr('path', path);\n    } else {\n      mappedItem = item.get('keyShape').clone();\n      group.add(mappedItem);\n    }\n\n    if (!item.isVisible()) mappedItem.hide();else mappedItem.show();\n    mappedItem.exist = true;\n    itemMap[item.get('id')] = mappedItem;\n    this.set('itemMap', itemMap);\n  };\n  /**\n   * Minimap 中展示自定义的 rect，支持用户自定义样式和节点大小\n   * 增加/更新单个元素\n   * @param item INode 实例\n   */\n\n\n  MiniMap.prototype.updateOneNodeDelegateShape = function (item, group) {\n    var delegateStyle = this.get('delegateStyle');\n    var itemMap = this.get('itemMap') || {}; // 差量更新 minimap 上的一个节点，对应主图的 item\n\n    var mappedItem = itemMap[item.get('id')];\n    var bbox = item.getBBox(); // 计算了节点父组矩阵的 bbox\n\n    if (mappedItem) {\n      var attrs = {\n        x: bbox.minX,\n        y: bbox.minY,\n        width: bbox.width,\n        height: bbox.height\n      };\n      mappedItem.attr(attrs);\n    } else {\n      mappedItem = group.addShape('rect', {\n        attrs: __assign({\n          x: bbox.minX,\n          y: bbox.minY,\n          width: bbox.width,\n          height: bbox.height\n        }, delegateStyle),\n        name: 'minimap-node-shape'\n      });\n    }\n\n    if (!item.isVisible()) mappedItem.hide();else mappedItem.show();\n    mappedItem.exist = true;\n    itemMap[item.get('id')] = mappedItem;\n    this.set('itemMap', itemMap);\n  };\n\n  MiniMap.prototype.init = function () {\n    this.initContainer();\n    this.get('graph').on('afterupdateitem', this.handleUpdateCanvas);\n    this.get('graph').on('afteritemstatechange', this.handleUpdateCanvas);\n    this.get('graph').on('afteradditem', this.handleUpdateCanvas);\n    this.get('graph').on('afterremoveitem', this.handleUpdateCanvas);\n    this.get('graph').on('afterrender', this.handleUpdateCanvas);\n    this.get('graph').on('afterlayout', this.handleUpdateCanvas);\n  };\n  /**\n   * 初始化 Minimap 的容器\n   */\n\n\n  MiniMap.prototype.initContainer = function () {\n    var self = this;\n    var graph = self.get('graph');\n    var size = self.get('size');\n    var className = self.get('className');\n    var parentNode = self.get('container');\n    var container = createDom(\"<div class='\".concat(className, \"' style='width: \").concat(size[0], \"px; height: \").concat(size[1], \"px; overflow: hidden'></div>\"));\n\n    if (isString(parentNode)) {\n      parentNode = document.getElementById(parentNode);\n    }\n\n    if (parentNode) {\n      parentNode.appendChild(container);\n    } else {\n      graph.get('container').appendChild(container);\n    }\n\n    self.set('container', container);\n    var containerDOM = createDom('<div class=\"g6-minimap-container\" style=\"position: relative;\"></div>');\n    container.appendChild(containerDOM);\n    containerDOM.addEventListener('dragenter', function (e) {\n      e.preventDefault();\n    });\n    containerDOM.addEventListener('dragover', function (e) {\n      e.preventDefault();\n    });\n    var canvas;\n    var renderer = graph.get('renderer');\n\n    if (renderer === SVG) {\n      canvas = new GSVGCanvas({\n        container: containerDOM,\n        width: size[0],\n        height: size[1]\n      });\n    } else {\n      canvas = new GCanvas({\n        container: containerDOM,\n        width: size[0],\n        height: size[1]\n      });\n    }\n\n    self.set('canvas', canvas);\n    self.updateCanvas();\n  };\n\n  MiniMap.prototype.updateCanvas = function () {\n    if (this.destroyed) return; // 如果是在动画，则不刷新视图\n\n    var isRefresh = this.get('refresh');\n\n    if (!isRefresh) {\n      return;\n    }\n\n    var graph = this.get('graph');\n\n    if (graph.get('destroyed')) {\n      return;\n    } // 如果是视口变换，也不刷新视图，但是需要重置视口大小和位置\n\n\n    if (this.get('viewportChange')) {\n      this.set('viewportChange', false);\n      this.updateViewport();\n    }\n\n    var size = this.get('size'); // 用户定义的 minimap size\n\n    var canvas = this.get('canvas'); // minimap 的 canvas\n\n    var type = this.get('type'); // minimap 的类型\n\n    var padding = this.get('padding'); // 用户额定义的 minimap 的 padding\n\n    if (canvas.destroyed) {\n      return;\n    }\n\n    switch (type) {\n      case DEFAULT_MODE:\n        this.updateGraphShapes();\n        break;\n\n      case KEYSHAPE_MODE:\n        this.updateKeyShapes();\n        break;\n\n      case DELEGATE_MODE:\n        // 得到的节点直接带有 x 和 y，每个节点不存在父 group，即每个节点位置不由父 group 控制\n        this.updateDelegateShapes();\n        break;\n\n      default:\n        break;\n    }\n\n    var group = canvas.get('children')[0];\n    if (!group) return;\n    group.resetMatrix(); // 该 bbox 是准确的，不计算 matrix 的包围盒\n\n    var bbox = group.getCanvasBBox();\n    var graphBBox = graph.get('canvas').getCanvasBBox(); // 主图的 bbox\n\n    var graphZoom = graph.getZoom() || 1;\n    var width = graphBBox.width / graphZoom;\n    var height = graphBBox.height / graphZoom;\n\n    if (Number.isFinite(bbox.width)) {\n      // 刷新后bbox可能会变，需要重置画布矩阵以缩放到合适的大小\n      width = max(bbox.width, width);\n      height = max(bbox.height, height);\n    }\n\n    width += 2 * padding;\n    height += 2 * padding;\n    var ratio = Math.min(size[0] / width, size[1] / height);\n    var matrix = [1, 0, 0, 0, 1, 0, 0, 0, 1];\n    var minX = 0;\n    var minY = 0; // 平移到左上角\n\n    if (Number.isFinite(bbox.minX)) {\n      minX = -bbox.minX;\n    }\n\n    if (Number.isFinite(bbox.minY)) {\n      minY = -bbox.minY;\n    } // 缩放到适合视口后, 平移到画布中心\n\n\n    var dx = (size[0] - (width - 2 * padding) * ratio) / 2;\n    var dy = (size[1] - (height - 2 * padding) * ratio) / 2;\n    matrix = transform(matrix, [['t', minX, minY], ['s', ratio, ratio], ['t', dx, dy] // 移动到画布中心\n    ]);\n    group.setMatrix(matrix); // 更新minimap视口\n\n    this.set('ratio', ratio);\n    this.set('totaldx', dx + minX * ratio);\n    this.set('totaldy', dy + minY * ratio);\n    this.set('dx', dx);\n    this.set('dy', dy);\n    this.updateViewport();\n  };\n  /**\n   * 获取minimap的画布\n   * @return {GCanvas} G的canvas实例\n   */\n\n\n  MiniMap.prototype.getCanvas = function () {\n    return this.get('canvas');\n  };\n  /**\n   * 获取minimap的窗口\n   * @return {HTMLElement} 窗口的dom实例\n   */\n\n\n  MiniMap.prototype.getViewport = function () {\n    return this.get('viewport');\n  };\n  /**\n   * 获取minimap的容器dom\n   * @return {HTMLElement} dom\n   */\n\n\n  MiniMap.prototype.getContainer = function () {\n    return this.get('container');\n  };\n\n  MiniMap.prototype.destroy = function () {\n    var _a;\n\n    (_a = this.get('canvas')) === null || _a === void 0 ? void 0 : _a.destroy();\n    var container = this.get('container');\n    if (container === null || container === void 0 ? void 0 : container.parentNode) container.parentNode.removeChild(container);\n  };\n\n  return MiniMap;\n}(Base);\n\nexport default MiniMap;"],"mappings":"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"},"metadata":{},"sourceType":"module"}