{"ast":null,"code":"import \"core-js/modules/es.error.cause.js\";\nimport \"core-js/modules/es.typed-array.at.js\";\nimport \"core-js/modules/es.typed-array.set.js\";\nimport \"core-js/modules/esnext.typed-array.find-last.js\";\nimport \"core-js/modules/esnext.typed-array.find-last-index.js\";\nimport Matrix from '../matrix';\nimport WrapperMatrix2D from '../wrap/WrapperMatrix2D';\nimport { hypotenuse } from './util';\nexport default class EigenvalueDecomposition {\n  constructor(matrix, options = {}) {\n    const {\n      assumeSymmetric = false\n    } = options;\n    matrix = WrapperMatrix2D.checkMatrix(matrix);\n\n    if (!matrix.isSquare()) {\n      throw new Error('Matrix is not a square matrix');\n    }\n\n    if (matrix.isEmpty()) {\n      throw new Error('Matrix must be non-empty');\n    }\n\n    let n = matrix.columns;\n    let V = new Matrix(n, n);\n    let d = new Float64Array(n);\n    let e = new Float64Array(n);\n    let value = matrix;\n    let i, j;\n    let isSymmetric = false;\n\n    if (assumeSymmetric) {\n      isSymmetric = true;\n    } else {\n      isSymmetric = matrix.isSymmetric();\n    }\n\n    if (isSymmetric) {\n      for (i = 0; i < n; i++) {\n        for (j = 0; j < n; j++) {\n          V.set(i, j, value.get(i, j));\n        }\n      }\n\n      tred2(n, e, d, V);\n      tql2(n, e, d, V);\n    } else {\n      let H = new Matrix(n, n);\n      let ort = new Float64Array(n);\n\n      for (j = 0; j < n; j++) {\n        for (i = 0; i < n; i++) {\n          H.set(i, j, value.get(i, j));\n        }\n      }\n\n      orthes(n, H, ort, V);\n      hqr2(n, e, d, V, H);\n    }\n\n    this.n = n;\n    this.e = e;\n    this.d = d;\n    this.V = V;\n  }\n\n  get realEigenvalues() {\n    return Array.from(this.d);\n  }\n\n  get imaginaryEigenvalues() {\n    return Array.from(this.e);\n  }\n\n  get eigenvectorMatrix() {\n    return this.V;\n  }\n\n  get diagonalMatrix() {\n    let n = this.n;\n    let e = this.e;\n    let d = this.d;\n    let X = new Matrix(n, n);\n    let i, j;\n\n    for (i = 0; i < n; i++) {\n      for (j = 0; j < n; j++) {\n        X.set(i, j, 0);\n      }\n\n      X.set(i, i, d[i]);\n\n      if (e[i] > 0) {\n        X.set(i, i + 1, e[i]);\n      } else if (e[i] < 0) {\n        X.set(i, i - 1, e[i]);\n      }\n    }\n\n    return X;\n  }\n\n}\n\nfunction tred2(n, e, d, V) {\n  let f, g, h, i, j, k, hh, scale;\n\n  for (j = 0; j < n; j++) {\n    d[j] = V.get(n - 1, j);\n  }\n\n  for (i = n - 1; i > 0; i--) {\n    scale = 0;\n    h = 0;\n\n    for (k = 0; k < i; k++) {\n      scale = scale + Math.abs(d[k]);\n    }\n\n    if (scale === 0) {\n      e[i] = d[i - 1];\n\n      for (j = 0; j < i; j++) {\n        d[j] = V.get(i - 1, j);\n        V.set(i, j, 0);\n        V.set(j, i, 0);\n      }\n    } else {\n      for (k = 0; k < i; k++) {\n        d[k] /= scale;\n        h += d[k] * d[k];\n      }\n\n      f = d[i - 1];\n      g = Math.sqrt(h);\n\n      if (f > 0) {\n        g = -g;\n      }\n\n      e[i] = scale * g;\n      h = h - f * g;\n      d[i - 1] = f - g;\n\n      for (j = 0; j < i; j++) {\n        e[j] = 0;\n      }\n\n      for (j = 0; j < i; j++) {\n        f = d[j];\n        V.set(j, i, f);\n        g = e[j] + V.get(j, j) * f;\n\n        for (k = j + 1; k <= i - 1; k++) {\n          g += V.get(k, j) * d[k];\n          e[k] += V.get(k, j) * f;\n        }\n\n        e[j] = g;\n      }\n\n      f = 0;\n\n      for (j = 0; j < i; j++) {\n        e[j] /= h;\n        f += e[j] * d[j];\n      }\n\n      hh = f / (h + h);\n\n      for (j = 0; j < i; j++) {\n        e[j] -= hh * d[j];\n      }\n\n      for (j = 0; j < i; j++) {\n        f = d[j];\n        g = e[j];\n\n        for (k = j; k <= i - 1; k++) {\n          V.set(k, j, V.get(k, j) - (f * e[k] + g * d[k]));\n        }\n\n        d[j] = V.get(i - 1, j);\n        V.set(i, j, 0);\n      }\n    }\n\n    d[i] = h;\n  }\n\n  for (i = 0; i < n - 1; i++) {\n    V.set(n - 1, i, V.get(i, i));\n    V.set(i, i, 1);\n    h = d[i + 1];\n\n    if (h !== 0) {\n      for (k = 0; k <= i; k++) {\n        d[k] = V.get(k, i + 1) / h;\n      }\n\n      for (j = 0; j <= i; j++) {\n        g = 0;\n\n        for (k = 0; k <= i; k++) {\n          g += V.get(k, i + 1) * V.get(k, j);\n        }\n\n        for (k = 0; k <= i; k++) {\n          V.set(k, j, V.get(k, j) - g * d[k]);\n        }\n      }\n    }\n\n    for (k = 0; k <= i; k++) {\n      V.set(k, i + 1, 0);\n    }\n  }\n\n  for (j = 0; j < n; j++) {\n    d[j] = V.get(n - 1, j);\n    V.set(n - 1, j, 0);\n  }\n\n  V.set(n - 1, n - 1, 1);\n  e[0] = 0;\n}\n\nfunction tql2(n, e, d, V) {\n  let g, h, i, j, k, l, m, p, r, dl1, c, c2, c3, el1, s, s2, iter;\n\n  for (i = 1; i < n; i++) {\n    e[i - 1] = e[i];\n  }\n\n  e[n - 1] = 0;\n  let f = 0;\n  let tst1 = 0;\n  let eps = Number.EPSILON;\n\n  for (l = 0; l < n; l++) {\n    tst1 = Math.max(tst1, Math.abs(d[l]) + Math.abs(e[l]));\n    m = l;\n\n    while (m < n) {\n      if (Math.abs(e[m]) <= eps * tst1) {\n        break;\n      }\n\n      m++;\n    }\n\n    if (m > l) {\n      iter = 0;\n\n      do {\n        iter = iter + 1;\n        g = d[l];\n        p = (d[l + 1] - g) / (2 * e[l]);\n        r = hypotenuse(p, 1);\n\n        if (p < 0) {\n          r = -r;\n        }\n\n        d[l] = e[l] / (p + r);\n        d[l + 1] = e[l] * (p + r);\n        dl1 = d[l + 1];\n        h = g - d[l];\n\n        for (i = l + 2; i < n; i++) {\n          d[i] -= h;\n        }\n\n        f = f + h;\n        p = d[m];\n        c = 1;\n        c2 = c;\n        c3 = c;\n        el1 = e[l + 1];\n        s = 0;\n        s2 = 0;\n\n        for (i = m - 1; i >= l; i--) {\n          c3 = c2;\n          c2 = c;\n          s2 = s;\n          g = c * e[i];\n          h = c * p;\n          r = hypotenuse(p, e[i]);\n          e[i + 1] = s * r;\n          s = e[i] / r;\n          c = p / r;\n          p = c * d[i] - s * g;\n          d[i + 1] = h + s * (c * g + s * d[i]);\n\n          for (k = 0; k < n; k++) {\n            h = V.get(k, i + 1);\n            V.set(k, i + 1, s * V.get(k, i) + c * h);\n            V.set(k, i, c * V.get(k, i) - s * h);\n          }\n        }\n\n        p = -s * s2 * c3 * el1 * e[l] / dl1;\n        e[l] = s * p;\n        d[l] = c * p;\n      } while (Math.abs(e[l]) > eps * tst1);\n    }\n\n    d[l] = d[l] + f;\n    e[l] = 0;\n  }\n\n  for (i = 0; i < n - 1; i++) {\n    k = i;\n    p = d[i];\n\n    for (j = i + 1; j < n; j++) {\n      if (d[j] < p) {\n        k = j;\n        p = d[j];\n      }\n    }\n\n    if (k !== i) {\n      d[k] = d[i];\n      d[i] = p;\n\n      for (j = 0; j < n; j++) {\n        p = V.get(j, i);\n        V.set(j, i, V.get(j, k));\n        V.set(j, k, p);\n      }\n    }\n  }\n}\n\nfunction orthes(n, H, ort, V) {\n  let low = 0;\n  let high = n - 1;\n  let f, g, h, i, j, m;\n  let scale;\n\n  for (m = low + 1; m <= high - 1; m++) {\n    scale = 0;\n\n    for (i = m; i <= high; i++) {\n      scale = scale + Math.abs(H.get(i, m - 1));\n    }\n\n    if (scale !== 0) {\n      h = 0;\n\n      for (i = high; i >= m; i--) {\n        ort[i] = H.get(i, m - 1) / scale;\n        h += ort[i] * ort[i];\n      }\n\n      g = Math.sqrt(h);\n\n      if (ort[m] > 0) {\n        g = -g;\n      }\n\n      h = h - ort[m] * g;\n      ort[m] = ort[m] - g;\n\n      for (j = m; j < n; j++) {\n        f = 0;\n\n        for (i = high; i >= m; i--) {\n          f += ort[i] * H.get(i, j);\n        }\n\n        f = f / h;\n\n        for (i = m; i <= high; i++) {\n          H.set(i, j, H.get(i, j) - f * ort[i]);\n        }\n      }\n\n      for (i = 0; i <= high; i++) {\n        f = 0;\n\n        for (j = high; j >= m; j--) {\n          f += ort[j] * H.get(i, j);\n        }\n\n        f = f / h;\n\n        for (j = m; j <= high; j++) {\n          H.set(i, j, H.get(i, j) - f * ort[j]);\n        }\n      }\n\n      ort[m] = scale * ort[m];\n      H.set(m, m - 1, scale * g);\n    }\n  }\n\n  for (i = 0; i < n; i++) {\n    for (j = 0; j < n; j++) {\n      V.set(i, j, i === j ? 1 : 0);\n    }\n  }\n\n  for (m = high - 1; m >= low + 1; m--) {\n    if (H.get(m, m - 1) !== 0) {\n      for (i = m + 1; i <= high; i++) {\n        ort[i] = H.get(i, m - 1);\n      }\n\n      for (j = m; j <= high; j++) {\n        g = 0;\n\n        for (i = m; i <= high; i++) {\n          g += ort[i] * V.get(i, j);\n        }\n\n        g = g / ort[m] / H.get(m, m - 1);\n\n        for (i = m; i <= high; i++) {\n          V.set(i, j, V.get(i, j) + g * ort[i]);\n        }\n      }\n    }\n  }\n}\n\nfunction hqr2(nn, e, d, V, H) {\n  let n = nn - 1;\n  let low = 0;\n  let high = nn - 1;\n  let eps = Number.EPSILON;\n  let exshift = 0;\n  let norm = 0;\n  let p = 0;\n  let q = 0;\n  let r = 0;\n  let s = 0;\n  let z = 0;\n  let iter = 0;\n  let i, j, k, l, m, t, w, x, y;\n  let ra, sa, vr, vi;\n  let notlast, cdivres;\n\n  for (i = 0; i < nn; i++) {\n    if (i < low || i > high) {\n      d[i] = H.get(i, i);\n      e[i] = 0;\n    }\n\n    for (j = Math.max(i - 1, 0); j < nn; j++) {\n      norm = norm + Math.abs(H.get(i, j));\n    }\n  }\n\n  while (n >= low) {\n    l = n;\n\n    while (l > low) {\n      s = Math.abs(H.get(l - 1, l - 1)) + Math.abs(H.get(l, l));\n\n      if (s === 0) {\n        s = norm;\n      }\n\n      if (Math.abs(H.get(l, l - 1)) < eps * s) {\n        break;\n      }\n\n      l--;\n    }\n\n    if (l === n) {\n      H.set(n, n, H.get(n, n) + exshift);\n      d[n] = H.get(n, n);\n      e[n] = 0;\n      n--;\n      iter = 0;\n    } else if (l === n - 1) {\n      w = H.get(n, n - 1) * H.get(n - 1, n);\n      p = (H.get(n - 1, n - 1) - H.get(n, n)) / 2;\n      q = p * p + w;\n      z = Math.sqrt(Math.abs(q));\n      H.set(n, n, H.get(n, n) + exshift);\n      H.set(n - 1, n - 1, H.get(n - 1, n - 1) + exshift);\n      x = H.get(n, n);\n\n      if (q >= 0) {\n        z = p >= 0 ? p + z : p - z;\n        d[n - 1] = x + z;\n        d[n] = d[n - 1];\n\n        if (z !== 0) {\n          d[n] = x - w / z;\n        }\n\n        e[n - 1] = 0;\n        e[n] = 0;\n        x = H.get(n, n - 1);\n        s = Math.abs(x) + Math.abs(z);\n        p = x / s;\n        q = z / s;\n        r = Math.sqrt(p * p + q * q);\n        p = p / r;\n        q = q / r;\n\n        for (j = n - 1; j < nn; j++) {\n          z = H.get(n - 1, j);\n          H.set(n - 1, j, q * z + p * H.get(n, j));\n          H.set(n, j, q * H.get(n, j) - p * z);\n        }\n\n        for (i = 0; i <= n; i++) {\n          z = H.get(i, n - 1);\n          H.set(i, n - 1, q * z + p * H.get(i, n));\n          H.set(i, n, q * H.get(i, n) - p * z);\n        }\n\n        for (i = low; i <= high; i++) {\n          z = V.get(i, n - 1);\n          V.set(i, n - 1, q * z + p * V.get(i, n));\n          V.set(i, n, q * V.get(i, n) - p * z);\n        }\n      } else {\n        d[n - 1] = x + p;\n        d[n] = x + p;\n        e[n - 1] = z;\n        e[n] = -z;\n      }\n\n      n = n - 2;\n      iter = 0;\n    } else {\n      x = H.get(n, n);\n      y = 0;\n      w = 0;\n\n      if (l < n) {\n        y = H.get(n - 1, n - 1);\n        w = H.get(n, n - 1) * H.get(n - 1, n);\n      }\n\n      if (iter === 10) {\n        exshift += x;\n\n        for (i = low; i <= n; i++) {\n          H.set(i, i, H.get(i, i) - x);\n        }\n\n        s = Math.abs(H.get(n, n - 1)) + Math.abs(H.get(n - 1, n - 2));\n        x = y = 0.75 * s;\n        w = -0.4375 * s * s;\n      }\n\n      if (iter === 30) {\n        s = (y - x) / 2;\n        s = s * s + w;\n\n        if (s > 0) {\n          s = Math.sqrt(s);\n\n          if (y < x) {\n            s = -s;\n          }\n\n          s = x - w / ((y - x) / 2 + s);\n\n          for (i = low; i <= n; i++) {\n            H.set(i, i, H.get(i, i) - s);\n          }\n\n          exshift += s;\n          x = y = w = 0.964;\n        }\n      }\n\n      iter = iter + 1;\n      m = n - 2;\n\n      while (m >= l) {\n        z = H.get(m, m);\n        r = x - z;\n        s = y - z;\n        p = (r * s - w) / H.get(m + 1, m) + H.get(m, m + 1);\n        q = H.get(m + 1, m + 1) - z - r - s;\n        r = H.get(m + 2, m + 1);\n        s = Math.abs(p) + Math.abs(q) + Math.abs(r);\n        p = p / s;\n        q = q / s;\n        r = r / s;\n\n        if (m === l) {\n          break;\n        }\n\n        if (Math.abs(H.get(m, m - 1)) * (Math.abs(q) + Math.abs(r)) < eps * (Math.abs(p) * (Math.abs(H.get(m - 1, m - 1)) + Math.abs(z) + Math.abs(H.get(m + 1, m + 1))))) {\n          break;\n        }\n\n        m--;\n      }\n\n      for (i = m + 2; i <= n; i++) {\n        H.set(i, i - 2, 0);\n\n        if (i > m + 2) {\n          H.set(i, i - 3, 0);\n        }\n      }\n\n      for (k = m; k <= n - 1; k++) {\n        notlast = k !== n - 1;\n\n        if (k !== m) {\n          p = H.get(k, k - 1);\n          q = H.get(k + 1, k - 1);\n          r = notlast ? H.get(k + 2, k - 1) : 0;\n          x = Math.abs(p) + Math.abs(q) + Math.abs(r);\n\n          if (x !== 0) {\n            p = p / x;\n            q = q / x;\n            r = r / x;\n          }\n        }\n\n        if (x === 0) {\n          break;\n        }\n\n        s = Math.sqrt(p * p + q * q + r * r);\n\n        if (p < 0) {\n          s = -s;\n        }\n\n        if (s !== 0) {\n          if (k !== m) {\n            H.set(k, k - 1, -s * x);\n          } else if (l !== m) {\n            H.set(k, k - 1, -H.get(k, k - 1));\n          }\n\n          p = p + s;\n          x = p / s;\n          y = q / s;\n          z = r / s;\n          q = q / p;\n          r = r / p;\n\n          for (j = k; j < nn; j++) {\n            p = H.get(k, j) + q * H.get(k + 1, j);\n\n            if (notlast) {\n              p = p + r * H.get(k + 2, j);\n              H.set(k + 2, j, H.get(k + 2, j) - p * z);\n            }\n\n            H.set(k, j, H.get(k, j) - p * x);\n            H.set(k + 1, j, H.get(k + 1, j) - p * y);\n          }\n\n          for (i = 0; i <= Math.min(n, k + 3); i++) {\n            p = x * H.get(i, k) + y * H.get(i, k + 1);\n\n            if (notlast) {\n              p = p + z * H.get(i, k + 2);\n              H.set(i, k + 2, H.get(i, k + 2) - p * r);\n            }\n\n            H.set(i, k, H.get(i, k) - p);\n            H.set(i, k + 1, H.get(i, k + 1) - p * q);\n          }\n\n          for (i = low; i <= high; i++) {\n            p = x * V.get(i, k) + y * V.get(i, k + 1);\n\n            if (notlast) {\n              p = p + z * V.get(i, k + 2);\n              V.set(i, k + 2, V.get(i, k + 2) - p * r);\n            }\n\n            V.set(i, k, V.get(i, k) - p);\n            V.set(i, k + 1, V.get(i, k + 1) - p * q);\n          }\n        }\n      }\n    }\n  }\n\n  if (norm === 0) {\n    return;\n  }\n\n  for (n = nn - 1; n >= 0; n--) {\n    p = d[n];\n    q = e[n];\n\n    if (q === 0) {\n      l = n;\n      H.set(n, n, 1);\n\n      for (i = n - 1; i >= 0; i--) {\n        w = H.get(i, i) - p;\n        r = 0;\n\n        for (j = l; j <= n; j++) {\n          r = r + H.get(i, j) * H.get(j, n);\n        }\n\n        if (e[i] < 0) {\n          z = w;\n          s = r;\n        } else {\n          l = i;\n\n          if (e[i] === 0) {\n            H.set(i, n, w !== 0 ? -r / w : -r / (eps * norm));\n          } else {\n            x = H.get(i, i + 1);\n            y = H.get(i + 1, i);\n            q = (d[i] - p) * (d[i] - p) + e[i] * e[i];\n            t = (x * s - z * r) / q;\n            H.set(i, n, t);\n            H.set(i + 1, n, Math.abs(x) > Math.abs(z) ? (-r - w * t) / x : (-s - y * t) / z);\n          }\n\n          t = Math.abs(H.get(i, n));\n\n          if (eps * t * t > 1) {\n            for (j = i; j <= n; j++) {\n              H.set(j, n, H.get(j, n) / t);\n            }\n          }\n        }\n      }\n    } else if (q < 0) {\n      l = n - 1;\n\n      if (Math.abs(H.get(n, n - 1)) > Math.abs(H.get(n - 1, n))) {\n        H.set(n - 1, n - 1, q / H.get(n, n - 1));\n        H.set(n - 1, n, -(H.get(n, n) - p) / H.get(n, n - 1));\n      } else {\n        cdivres = cdiv(0, -H.get(n - 1, n), H.get(n - 1, n - 1) - p, q);\n        H.set(n - 1, n - 1, cdivres[0]);\n        H.set(n - 1, n, cdivres[1]);\n      }\n\n      H.set(n, n - 1, 0);\n      H.set(n, n, 1);\n\n      for (i = n - 2; i >= 0; i--) {\n        ra = 0;\n        sa = 0;\n\n        for (j = l; j <= n; j++) {\n          ra = ra + H.get(i, j) * H.get(j, n - 1);\n          sa = sa + H.get(i, j) * H.get(j, n);\n        }\n\n        w = H.get(i, i) - p;\n\n        if (e[i] < 0) {\n          z = w;\n          r = ra;\n          s = sa;\n        } else {\n          l = i;\n\n          if (e[i] === 0) {\n            cdivres = cdiv(-ra, -sa, w, q);\n            H.set(i, n - 1, cdivres[0]);\n            H.set(i, n, cdivres[1]);\n          } else {\n            x = H.get(i, i + 1);\n            y = H.get(i + 1, i);\n            vr = (d[i] - p) * (d[i] - p) + e[i] * e[i] - q * q;\n            vi = (d[i] - p) * 2 * q;\n\n            if (vr === 0 && vi === 0) {\n              vr = eps * norm * (Math.abs(w) + Math.abs(q) + Math.abs(x) + Math.abs(y) + Math.abs(z));\n            }\n\n            cdivres = cdiv(x * r - z * ra + q * sa, x * s - z * sa - q * ra, vr, vi);\n            H.set(i, n - 1, cdivres[0]);\n            H.set(i, n, cdivres[1]);\n\n            if (Math.abs(x) > Math.abs(z) + Math.abs(q)) {\n              H.set(i + 1, n - 1, (-ra - w * H.get(i, n - 1) + q * H.get(i, n)) / x);\n              H.set(i + 1, n, (-sa - w * H.get(i, n) - q * H.get(i, n - 1)) / x);\n            } else {\n              cdivres = cdiv(-r - y * H.get(i, n - 1), -s - y * H.get(i, n), z, q);\n              H.set(i + 1, n - 1, cdivres[0]);\n              H.set(i + 1, n, cdivres[1]);\n            }\n          }\n\n          t = Math.max(Math.abs(H.get(i, n - 1)), Math.abs(H.get(i, n)));\n\n          if (eps * t * t > 1) {\n            for (j = i; j <= n; j++) {\n              H.set(j, n - 1, H.get(j, n - 1) / t);\n              H.set(j, n, H.get(j, n) / t);\n            }\n          }\n        }\n      }\n    }\n  }\n\n  for (i = 0; i < nn; i++) {\n    if (i < low || i > high) {\n      for (j = i; j < nn; j++) {\n        V.set(i, j, H.get(i, j));\n      }\n    }\n  }\n\n  for (j = nn - 1; j >= low; j--) {\n    for (i = low; i <= high; i++) {\n      z = 0;\n\n      for (k = low; k <= Math.min(j, high); k++) {\n        z = z + V.get(i, k) * H.get(k, j);\n      }\n\n      V.set(i, j, z);\n    }\n  }\n}\n\nfunction cdiv(xr, xi, yr, yi) {\n  let r, d;\n\n  if (Math.abs(yr) > Math.abs(yi)) {\n    r = yi / yr;\n    d = yr + r * yi;\n    return [(xr + r * xi) / d, (xi - r * xr) / d];\n  } else {\n    r = yr / yi;\n    d = yi + r * yr;\n    return [(r * xr + xi) / d, (r * xi - xr) / d];\n  }\n}","map":{"version":3,"names":["Matrix","WrapperMatrix2D","hypotenuse","EigenvalueDecomposition","constructor","matrix","options","assumeSymmetric","checkMatrix","isSquare","Error","isEmpty","n","columns","V","d","Float64Array","e","value","i","j","isSymmetric","set","get","tred2","tql2","H","ort","orthes","hqr2","realEigenvalues","Array","from","imaginaryEigenvalues","eigenvectorMatrix","diagonalMatrix","X","f","g","h","k","hh","scale","Math","abs","sqrt","l","m","p","r","dl1","c","c2","c3","el1","s","s2","iter","tst1","eps","Number","EPSILON","max","low","high","nn","exshift","norm","q","z","t","w","x","y","ra","sa","vr","vi","notlast","cdivres","min","cdiv","xr","xi","yr","yi"],"sources":["/Users/wawalike/Desktop/ggProject/node_modules/ml-matrix/src/dc/evd.js"],"sourcesContent":["import Matrix from '../matrix';\nimport WrapperMatrix2D from '../wrap/WrapperMatrix2D';\n\nimport { hypotenuse } from './util';\n\nexport default class EigenvalueDecomposition {\n  constructor(matrix, options = {}) {\n    const { assumeSymmetric = false } = options;\n\n    matrix = WrapperMatrix2D.checkMatrix(matrix);\n    if (!matrix.isSquare()) {\n      throw new Error('Matrix is not a square matrix');\n    }\n\n    if (matrix.isEmpty()) {\n      throw new Error('Matrix must be non-empty');\n    }\n\n    let n = matrix.columns;\n    let V = new Matrix(n, n);\n    let d = new Float64Array(n);\n    let e = new Float64Array(n);\n    let value = matrix;\n    let i, j;\n\n    let isSymmetric = false;\n    if (assumeSymmetric) {\n      isSymmetric = true;\n    } else {\n      isSymmetric = matrix.isSymmetric();\n    }\n\n    if (isSymmetric) {\n      for (i = 0; i < n; i++) {\n        for (j = 0; j < n; j++) {\n          V.set(i, j, value.get(i, j));\n        }\n      }\n      tred2(n, e, d, V);\n      tql2(n, e, d, V);\n    } else {\n      let H = new Matrix(n, n);\n      let ort = new Float64Array(n);\n      for (j = 0; j < n; j++) {\n        for (i = 0; i < n; i++) {\n          H.set(i, j, value.get(i, j));\n        }\n      }\n      orthes(n, H, ort, V);\n      hqr2(n, e, d, V, H);\n    }\n\n    this.n = n;\n    this.e = e;\n    this.d = d;\n    this.V = V;\n  }\n\n  get realEigenvalues() {\n    return Array.from(this.d);\n  }\n\n  get imaginaryEigenvalues() {\n    return Array.from(this.e);\n  }\n\n  get eigenvectorMatrix() {\n    return this.V;\n  }\n\n  get diagonalMatrix() {\n    let n = this.n;\n    let e = this.e;\n    let d = this.d;\n    let X = new Matrix(n, n);\n    let i, j;\n    for (i = 0; i < n; i++) {\n      for (j = 0; j < n; j++) {\n        X.set(i, j, 0);\n      }\n      X.set(i, i, d[i]);\n      if (e[i] > 0) {\n        X.set(i, i + 1, e[i]);\n      } else if (e[i] < 0) {\n        X.set(i, i - 1, e[i]);\n      }\n    }\n    return X;\n  }\n}\n\nfunction tred2(n, e, d, V) {\n  let f, g, h, i, j, k, hh, scale;\n\n  for (j = 0; j < n; j++) {\n    d[j] = V.get(n - 1, j);\n  }\n\n  for (i = n - 1; i > 0; i--) {\n    scale = 0;\n    h = 0;\n    for (k = 0; k < i; k++) {\n      scale = scale + Math.abs(d[k]);\n    }\n\n    if (scale === 0) {\n      e[i] = d[i - 1];\n      for (j = 0; j < i; j++) {\n        d[j] = V.get(i - 1, j);\n        V.set(i, j, 0);\n        V.set(j, i, 0);\n      }\n    } else {\n      for (k = 0; k < i; k++) {\n        d[k] /= scale;\n        h += d[k] * d[k];\n      }\n\n      f = d[i - 1];\n      g = Math.sqrt(h);\n      if (f > 0) {\n        g = -g;\n      }\n\n      e[i] = scale * g;\n      h = h - f * g;\n      d[i - 1] = f - g;\n      for (j = 0; j < i; j++) {\n        e[j] = 0;\n      }\n\n      for (j = 0; j < i; j++) {\n        f = d[j];\n        V.set(j, i, f);\n        g = e[j] + V.get(j, j) * f;\n        for (k = j + 1; k <= i - 1; k++) {\n          g += V.get(k, j) * d[k];\n          e[k] += V.get(k, j) * f;\n        }\n        e[j] = g;\n      }\n\n      f = 0;\n      for (j = 0; j < i; j++) {\n        e[j] /= h;\n        f += e[j] * d[j];\n      }\n\n      hh = f / (h + h);\n      for (j = 0; j < i; j++) {\n        e[j] -= hh * d[j];\n      }\n\n      for (j = 0; j < i; j++) {\n        f = d[j];\n        g = e[j];\n        for (k = j; k <= i - 1; k++) {\n          V.set(k, j, V.get(k, j) - (f * e[k] + g * d[k]));\n        }\n        d[j] = V.get(i - 1, j);\n        V.set(i, j, 0);\n      }\n    }\n    d[i] = h;\n  }\n\n  for (i = 0; i < n - 1; i++) {\n    V.set(n - 1, i, V.get(i, i));\n    V.set(i, i, 1);\n    h = d[i + 1];\n    if (h !== 0) {\n      for (k = 0; k <= i; k++) {\n        d[k] = V.get(k, i + 1) / h;\n      }\n\n      for (j = 0; j <= i; j++) {\n        g = 0;\n        for (k = 0; k <= i; k++) {\n          g += V.get(k, i + 1) * V.get(k, j);\n        }\n        for (k = 0; k <= i; k++) {\n          V.set(k, j, V.get(k, j) - g * d[k]);\n        }\n      }\n    }\n\n    for (k = 0; k <= i; k++) {\n      V.set(k, i + 1, 0);\n    }\n  }\n\n  for (j = 0; j < n; j++) {\n    d[j] = V.get(n - 1, j);\n    V.set(n - 1, j, 0);\n  }\n\n  V.set(n - 1, n - 1, 1);\n  e[0] = 0;\n}\n\nfunction tql2(n, e, d, V) {\n  let g, h, i, j, k, l, m, p, r, dl1, c, c2, c3, el1, s, s2, iter;\n\n  for (i = 1; i < n; i++) {\n    e[i - 1] = e[i];\n  }\n\n  e[n - 1] = 0;\n\n  let f = 0;\n  let tst1 = 0;\n  let eps = Number.EPSILON;\n\n  for (l = 0; l < n; l++) {\n    tst1 = Math.max(tst1, Math.abs(d[l]) + Math.abs(e[l]));\n    m = l;\n    while (m < n) {\n      if (Math.abs(e[m]) <= eps * tst1) {\n        break;\n      }\n      m++;\n    }\n\n    if (m > l) {\n      iter = 0;\n      do {\n        iter = iter + 1;\n\n        g = d[l];\n        p = (d[l + 1] - g) / (2 * e[l]);\n        r = hypotenuse(p, 1);\n        if (p < 0) {\n          r = -r;\n        }\n\n        d[l] = e[l] / (p + r);\n        d[l + 1] = e[l] * (p + r);\n        dl1 = d[l + 1];\n        h = g - d[l];\n        for (i = l + 2; i < n; i++) {\n          d[i] -= h;\n        }\n\n        f = f + h;\n\n        p = d[m];\n        c = 1;\n        c2 = c;\n        c3 = c;\n        el1 = e[l + 1];\n        s = 0;\n        s2 = 0;\n        for (i = m - 1; i >= l; i--) {\n          c3 = c2;\n          c2 = c;\n          s2 = s;\n          g = c * e[i];\n          h = c * p;\n          r = hypotenuse(p, e[i]);\n          e[i + 1] = s * r;\n          s = e[i] / r;\n          c = p / r;\n          p = c * d[i] - s * g;\n          d[i + 1] = h + s * (c * g + s * d[i]);\n\n          for (k = 0; k < n; k++) {\n            h = V.get(k, i + 1);\n            V.set(k, i + 1, s * V.get(k, i) + c * h);\n            V.set(k, i, c * V.get(k, i) - s * h);\n          }\n        }\n\n        p = (-s * s2 * c3 * el1 * e[l]) / dl1;\n        e[l] = s * p;\n        d[l] = c * p;\n      } while (Math.abs(e[l]) > eps * tst1);\n    }\n    d[l] = d[l] + f;\n    e[l] = 0;\n  }\n\n  for (i = 0; i < n - 1; i++) {\n    k = i;\n    p = d[i];\n    for (j = i + 1; j < n; j++) {\n      if (d[j] < p) {\n        k = j;\n        p = d[j];\n      }\n    }\n\n    if (k !== i) {\n      d[k] = d[i];\n      d[i] = p;\n      for (j = 0; j < n; j++) {\n        p = V.get(j, i);\n        V.set(j, i, V.get(j, k));\n        V.set(j, k, p);\n      }\n    }\n  }\n}\n\nfunction orthes(n, H, ort, V) {\n  let low = 0;\n  let high = n - 1;\n  let f, g, h, i, j, m;\n  let scale;\n\n  for (m = low + 1; m <= high - 1; m++) {\n    scale = 0;\n    for (i = m; i <= high; i++) {\n      scale = scale + Math.abs(H.get(i, m - 1));\n    }\n\n    if (scale !== 0) {\n      h = 0;\n      for (i = high; i >= m; i--) {\n        ort[i] = H.get(i, m - 1) / scale;\n        h += ort[i] * ort[i];\n      }\n\n      g = Math.sqrt(h);\n      if (ort[m] > 0) {\n        g = -g;\n      }\n\n      h = h - ort[m] * g;\n      ort[m] = ort[m] - g;\n\n      for (j = m; j < n; j++) {\n        f = 0;\n        for (i = high; i >= m; i--) {\n          f += ort[i] * H.get(i, j);\n        }\n\n        f = f / h;\n        for (i = m; i <= high; i++) {\n          H.set(i, j, H.get(i, j) - f * ort[i]);\n        }\n      }\n\n      for (i = 0; i <= high; i++) {\n        f = 0;\n        for (j = high; j >= m; j--) {\n          f += ort[j] * H.get(i, j);\n        }\n\n        f = f / h;\n        for (j = m; j <= high; j++) {\n          H.set(i, j, H.get(i, j) - f * ort[j]);\n        }\n      }\n\n      ort[m] = scale * ort[m];\n      H.set(m, m - 1, scale * g);\n    }\n  }\n\n  for (i = 0; i < n; i++) {\n    for (j = 0; j < n; j++) {\n      V.set(i, j, i === j ? 1 : 0);\n    }\n  }\n\n  for (m = high - 1; m >= low + 1; m--) {\n    if (H.get(m, m - 1) !== 0) {\n      for (i = m + 1; i <= high; i++) {\n        ort[i] = H.get(i, m - 1);\n      }\n\n      for (j = m; j <= high; j++) {\n        g = 0;\n        for (i = m; i <= high; i++) {\n          g += ort[i] * V.get(i, j);\n        }\n\n        g = g / ort[m] / H.get(m, m - 1);\n        for (i = m; i <= high; i++) {\n          V.set(i, j, V.get(i, j) + g * ort[i]);\n        }\n      }\n    }\n  }\n}\n\nfunction hqr2(nn, e, d, V, H) {\n  let n = nn - 1;\n  let low = 0;\n  let high = nn - 1;\n  let eps = Number.EPSILON;\n  let exshift = 0;\n  let norm = 0;\n  let p = 0;\n  let q = 0;\n  let r = 0;\n  let s = 0;\n  let z = 0;\n  let iter = 0;\n  let i, j, k, l, m, t, w, x, y;\n  let ra, sa, vr, vi;\n  let notlast, cdivres;\n\n  for (i = 0; i < nn; i++) {\n    if (i < low || i > high) {\n      d[i] = H.get(i, i);\n      e[i] = 0;\n    }\n\n    for (j = Math.max(i - 1, 0); j < nn; j++) {\n      norm = norm + Math.abs(H.get(i, j));\n    }\n  }\n\n  while (n >= low) {\n    l = n;\n    while (l > low) {\n      s = Math.abs(H.get(l - 1, l - 1)) + Math.abs(H.get(l, l));\n      if (s === 0) {\n        s = norm;\n      }\n      if (Math.abs(H.get(l, l - 1)) < eps * s) {\n        break;\n      }\n      l--;\n    }\n\n    if (l === n) {\n      H.set(n, n, H.get(n, n) + exshift);\n      d[n] = H.get(n, n);\n      e[n] = 0;\n      n--;\n      iter = 0;\n    } else if (l === n - 1) {\n      w = H.get(n, n - 1) * H.get(n - 1, n);\n      p = (H.get(n - 1, n - 1) - H.get(n, n)) / 2;\n      q = p * p + w;\n      z = Math.sqrt(Math.abs(q));\n      H.set(n, n, H.get(n, n) + exshift);\n      H.set(n - 1, n - 1, H.get(n - 1, n - 1) + exshift);\n      x = H.get(n, n);\n\n      if (q >= 0) {\n        z = p >= 0 ? p + z : p - z;\n        d[n - 1] = x + z;\n        d[n] = d[n - 1];\n        if (z !== 0) {\n          d[n] = x - w / z;\n        }\n        e[n - 1] = 0;\n        e[n] = 0;\n        x = H.get(n, n - 1);\n        s = Math.abs(x) + Math.abs(z);\n        p = x / s;\n        q = z / s;\n        r = Math.sqrt(p * p + q * q);\n        p = p / r;\n        q = q / r;\n\n        for (j = n - 1; j < nn; j++) {\n          z = H.get(n - 1, j);\n          H.set(n - 1, j, q * z + p * H.get(n, j));\n          H.set(n, j, q * H.get(n, j) - p * z);\n        }\n\n        for (i = 0; i <= n; i++) {\n          z = H.get(i, n - 1);\n          H.set(i, n - 1, q * z + p * H.get(i, n));\n          H.set(i, n, q * H.get(i, n) - p * z);\n        }\n\n        for (i = low; i <= high; i++) {\n          z = V.get(i, n - 1);\n          V.set(i, n - 1, q * z + p * V.get(i, n));\n          V.set(i, n, q * V.get(i, n) - p * z);\n        }\n      } else {\n        d[n - 1] = x + p;\n        d[n] = x + p;\n        e[n - 1] = z;\n        e[n] = -z;\n      }\n\n      n = n - 2;\n      iter = 0;\n    } else {\n      x = H.get(n, n);\n      y = 0;\n      w = 0;\n      if (l < n) {\n        y = H.get(n - 1, n - 1);\n        w = H.get(n, n - 1) * H.get(n - 1, n);\n      }\n\n      if (iter === 10) {\n        exshift += x;\n        for (i = low; i <= n; i++) {\n          H.set(i, i, H.get(i, i) - x);\n        }\n        s = Math.abs(H.get(n, n - 1)) + Math.abs(H.get(n - 1, n - 2));\n        x = y = 0.75 * s;\n        w = -0.4375 * s * s;\n      }\n\n      if (iter === 30) {\n        s = (y - x) / 2;\n        s = s * s + w;\n        if (s > 0) {\n          s = Math.sqrt(s);\n          if (y < x) {\n            s = -s;\n          }\n          s = x - w / ((y - x) / 2 + s);\n          for (i = low; i <= n; i++) {\n            H.set(i, i, H.get(i, i) - s);\n          }\n          exshift += s;\n          x = y = w = 0.964;\n        }\n      }\n\n      iter = iter + 1;\n\n      m = n - 2;\n      while (m >= l) {\n        z = H.get(m, m);\n        r = x - z;\n        s = y - z;\n        p = (r * s - w) / H.get(m + 1, m) + H.get(m, m + 1);\n        q = H.get(m + 1, m + 1) - z - r - s;\n        r = H.get(m + 2, m + 1);\n        s = Math.abs(p) + Math.abs(q) + Math.abs(r);\n        p = p / s;\n        q = q / s;\n        r = r / s;\n        if (m === l) {\n          break;\n        }\n        if (\n          Math.abs(H.get(m, m - 1)) * (Math.abs(q) + Math.abs(r)) <\n          eps *\n            (Math.abs(p) *\n              (Math.abs(H.get(m - 1, m - 1)) +\n                Math.abs(z) +\n                Math.abs(H.get(m + 1, m + 1))))\n        ) {\n          break;\n        }\n        m--;\n      }\n\n      for (i = m + 2; i <= n; i++) {\n        H.set(i, i - 2, 0);\n        if (i > m + 2) {\n          H.set(i, i - 3, 0);\n        }\n      }\n\n      for (k = m; k <= n - 1; k++) {\n        notlast = k !== n - 1;\n        if (k !== m) {\n          p = H.get(k, k - 1);\n          q = H.get(k + 1, k - 1);\n          r = notlast ? H.get(k + 2, k - 1) : 0;\n          x = Math.abs(p) + Math.abs(q) + Math.abs(r);\n          if (x !== 0) {\n            p = p / x;\n            q = q / x;\n            r = r / x;\n          }\n        }\n\n        if (x === 0) {\n          break;\n        }\n\n        s = Math.sqrt(p * p + q * q + r * r);\n        if (p < 0) {\n          s = -s;\n        }\n\n        if (s !== 0) {\n          if (k !== m) {\n            H.set(k, k - 1, -s * x);\n          } else if (l !== m) {\n            H.set(k, k - 1, -H.get(k, k - 1));\n          }\n\n          p = p + s;\n          x = p / s;\n          y = q / s;\n          z = r / s;\n          q = q / p;\n          r = r / p;\n\n          for (j = k; j < nn; j++) {\n            p = H.get(k, j) + q * H.get(k + 1, j);\n            if (notlast) {\n              p = p + r * H.get(k + 2, j);\n              H.set(k + 2, j, H.get(k + 2, j) - p * z);\n            }\n\n            H.set(k, j, H.get(k, j) - p * x);\n            H.set(k + 1, j, H.get(k + 1, j) - p * y);\n          }\n\n          for (i = 0; i <= Math.min(n, k + 3); i++) {\n            p = x * H.get(i, k) + y * H.get(i, k + 1);\n            if (notlast) {\n              p = p + z * H.get(i, k + 2);\n              H.set(i, k + 2, H.get(i, k + 2) - p * r);\n            }\n\n            H.set(i, k, H.get(i, k) - p);\n            H.set(i, k + 1, H.get(i, k + 1) - p * q);\n          }\n\n          for (i = low; i <= high; i++) {\n            p = x * V.get(i, k) + y * V.get(i, k + 1);\n            if (notlast) {\n              p = p + z * V.get(i, k + 2);\n              V.set(i, k + 2, V.get(i, k + 2) - p * r);\n            }\n\n            V.set(i, k, V.get(i, k) - p);\n            V.set(i, k + 1, V.get(i, k + 1) - p * q);\n          }\n        }\n      }\n    }\n  }\n\n  if (norm === 0) {\n    return;\n  }\n\n  for (n = nn - 1; n >= 0; n--) {\n    p = d[n];\n    q = e[n];\n\n    if (q === 0) {\n      l = n;\n      H.set(n, n, 1);\n      for (i = n - 1; i >= 0; i--) {\n        w = H.get(i, i) - p;\n        r = 0;\n        for (j = l; j <= n; j++) {\n          r = r + H.get(i, j) * H.get(j, n);\n        }\n\n        if (e[i] < 0) {\n          z = w;\n          s = r;\n        } else {\n          l = i;\n          if (e[i] === 0) {\n            H.set(i, n, w !== 0 ? -r / w : -r / (eps * norm));\n          } else {\n            x = H.get(i, i + 1);\n            y = H.get(i + 1, i);\n            q = (d[i] - p) * (d[i] - p) + e[i] * e[i];\n            t = (x * s - z * r) / q;\n            H.set(i, n, t);\n            H.set(\n              i + 1,\n              n,\n              Math.abs(x) > Math.abs(z) ? (-r - w * t) / x : (-s - y * t) / z,\n            );\n          }\n\n          t = Math.abs(H.get(i, n));\n          if (eps * t * t > 1) {\n            for (j = i; j <= n; j++) {\n              H.set(j, n, H.get(j, n) / t);\n            }\n          }\n        }\n      }\n    } else if (q < 0) {\n      l = n - 1;\n\n      if (Math.abs(H.get(n, n - 1)) > Math.abs(H.get(n - 1, n))) {\n        H.set(n - 1, n - 1, q / H.get(n, n - 1));\n        H.set(n - 1, n, -(H.get(n, n) - p) / H.get(n, n - 1));\n      } else {\n        cdivres = cdiv(0, -H.get(n - 1, n), H.get(n - 1, n - 1) - p, q);\n        H.set(n - 1, n - 1, cdivres[0]);\n        H.set(n - 1, n, cdivres[1]);\n      }\n\n      H.set(n, n - 1, 0);\n      H.set(n, n, 1);\n      for (i = n - 2; i >= 0; i--) {\n        ra = 0;\n        sa = 0;\n        for (j = l; j <= n; j++) {\n          ra = ra + H.get(i, j) * H.get(j, n - 1);\n          sa = sa + H.get(i, j) * H.get(j, n);\n        }\n\n        w = H.get(i, i) - p;\n\n        if (e[i] < 0) {\n          z = w;\n          r = ra;\n          s = sa;\n        } else {\n          l = i;\n          if (e[i] === 0) {\n            cdivres = cdiv(-ra, -sa, w, q);\n            H.set(i, n - 1, cdivres[0]);\n            H.set(i, n, cdivres[1]);\n          } else {\n            x = H.get(i, i + 1);\n            y = H.get(i + 1, i);\n            vr = (d[i] - p) * (d[i] - p) + e[i] * e[i] - q * q;\n            vi = (d[i] - p) * 2 * q;\n            if (vr === 0 && vi === 0) {\n              vr =\n                eps *\n                norm *\n                (Math.abs(w) +\n                  Math.abs(q) +\n                  Math.abs(x) +\n                  Math.abs(y) +\n                  Math.abs(z));\n            }\n            cdivres = cdiv(\n              x * r - z * ra + q * sa,\n              x * s - z * sa - q * ra,\n              vr,\n              vi,\n            );\n            H.set(i, n - 1, cdivres[0]);\n            H.set(i, n, cdivres[1]);\n            if (Math.abs(x) > Math.abs(z) + Math.abs(q)) {\n              H.set(\n                i + 1,\n                n - 1,\n                (-ra - w * H.get(i, n - 1) + q * H.get(i, n)) / x,\n              );\n              H.set(\n                i + 1,\n                n,\n                (-sa - w * H.get(i, n) - q * H.get(i, n - 1)) / x,\n              );\n            } else {\n              cdivres = cdiv(\n                -r - y * H.get(i, n - 1),\n                -s - y * H.get(i, n),\n                z,\n                q,\n              );\n              H.set(i + 1, n - 1, cdivres[0]);\n              H.set(i + 1, n, cdivres[1]);\n            }\n          }\n\n          t = Math.max(Math.abs(H.get(i, n - 1)), Math.abs(H.get(i, n)));\n          if (eps * t * t > 1) {\n            for (j = i; j <= n; j++) {\n              H.set(j, n - 1, H.get(j, n - 1) / t);\n              H.set(j, n, H.get(j, n) / t);\n            }\n          }\n        }\n      }\n    }\n  }\n\n  for (i = 0; i < nn; i++) {\n    if (i < low || i > high) {\n      for (j = i; j < nn; j++) {\n        V.set(i, j, H.get(i, j));\n      }\n    }\n  }\n\n  for (j = nn - 1; j >= low; j--) {\n    for (i = low; i <= high; i++) {\n      z = 0;\n      for (k = low; k <= Math.min(j, high); k++) {\n        z = z + V.get(i, k) * H.get(k, j);\n      }\n      V.set(i, j, z);\n    }\n  }\n}\n\nfunction cdiv(xr, xi, yr, yi) {\n  let r, d;\n  if (Math.abs(yr) > Math.abs(yi)) {\n    r = yi / yr;\n    d = yr + r * yi;\n    return [(xr + r * xi) / d, (xi - r * xr) / d];\n  } else {\n    r = yr / yi;\n    d = yi + r * yr;\n    return [(r * xr + xi) / d, (r * xi - xr) / d];\n  }\n}\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}