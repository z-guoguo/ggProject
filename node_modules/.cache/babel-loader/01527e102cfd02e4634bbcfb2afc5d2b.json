{"ast":null,"code":"import { each, isNil } from '@antv/util'; // 求以a为次幂，结果为b的基数，如 x^^a = b;求x\n// 虽然数学上 b 不支持负数，但是这里需要支持 负数\n\nexport function calBase(a, b) {\n  var e = Math.E;\n  var value;\n\n  if (b >= 0) {\n    value = Math.pow(e, Math.log(b) / a); // 使用换底公式求底\n  } else {\n    value = Math.pow(e, Math.log(-b) / a) * -1; // 使用换底公式求底\n  }\n\n  return value;\n}\nexport function log(a, b) {\n  if (a === 1) {\n    return 1;\n  }\n\n  return Math.log(b) / Math.log(a);\n}\nexport function getLogPositiveMin(values, base, max) {\n  if (isNil(max)) {\n    max = Math.max.apply(null, values);\n  }\n\n  var positiveMin = max;\n  each(values, function (value) {\n    if (value > 0 && value < positiveMin) {\n      positiveMin = value;\n    }\n  });\n\n  if (positiveMin === max) {\n    positiveMin = max / base;\n  }\n\n  if (positiveMin > 1) {\n    positiveMin = 1;\n  }\n\n  return positiveMin;\n}\n\nfunction digitLength(num) {\n  // Get digit length of e\n  var eSplit = num.toString().split(/[eE]/);\n  var len = (eSplit[0].split('.')[1] || '').length - +(eSplit[1] || 0);\n  return len > 0 ? len : 0;\n}\n/**\n * 高精度加法，解决 0.1 + 0.2 !== 0.3 的经典问题\n *\n * @param num1 加数\n * @param num2 被加数\n * @return {number} 返回值\n */\n\n\nexport function precisionAdd(num1, num2) {\n  var num1Digits = digitLength(num1);\n  var num2Digits = digitLength(num2);\n  var baseNum = Math.pow(10, Math.max(num1Digits, num2Digits));\n  return (num1 * baseNum + num2 * baseNum) / baseNum;\n}","map":{"version":3,"mappings":"AAAA,SAASA,IAAT,EAAeC,KAAf,QAA4B,YAA5B,C,CAEA;AACA;;AACA,OAAM,SAAUC,OAAV,CAAkBC,CAAlB,EAA6BC,CAA7B,EAAsC;EAC1C,IAAMC,CAAC,GAAGC,IAAI,CAACC,CAAf;EACA,IAAIC,KAAJ;;EACA,IAAIJ,CAAC,IAAI,CAAT,EAAY;IACVI,KAAK,GAAGF,IAAI,CAACG,GAAL,CAASJ,CAAT,EAAYC,IAAI,CAACI,GAAL,CAASN,CAAT,IAAcD,CAA1B,CAAR,CADU,CAC4B;EACvC,CAFD,MAEO;IACLK,KAAK,GAAGF,IAAI,CAACG,GAAL,CAASJ,CAAT,EAAYC,IAAI,CAACI,GAAL,CAAS,CAACN,CAAV,IAAeD,CAA3B,IAAgC,CAAC,CAAzC,CADK,CACuC;EAC7C;;EACD,OAAOK,KAAP;AACD;AAED,OAAM,SAAUE,GAAV,CAAcP,CAAd,EAAyBC,CAAzB,EAAkC;EACtC,IAAID,CAAC,KAAK,CAAV,EAAa;IACX,OAAO,CAAP;EACD;;EACD,OAAOG,IAAI,CAACI,GAAL,CAASN,CAAT,IAAcE,IAAI,CAACI,GAAL,CAASP,CAAT,CAArB;AACD;AAED,OAAM,SAAUQ,iBAAV,CAA4BC,MAA5B,EAAoCC,IAApC,EAA0CC,GAA1C,EAAsD;EAC1D,IAAIb,KAAK,CAACa,GAAD,CAAT,EAAgB;IACdA,GAAG,GAAGR,IAAI,CAACQ,GAAL,CAASC,KAAT,CAAe,IAAf,EAAqBH,MAArB,CAAN;EACD;;EACD,IAAII,WAAW,GAAGF,GAAlB;EACAd,IAAI,CAACY,MAAD,EAAS,UAACJ,KAAD,EAAM;IACjB,IAAIA,KAAK,GAAG,CAAR,IAAaA,KAAK,GAAGQ,WAAzB,EAAsC;MACpCA,WAAW,GAAGR,KAAd;IACD;EACF,CAJG,CAAJ;;EAKA,IAAIQ,WAAW,KAAKF,GAApB,EAAyB;IACvBE,WAAW,GAAGF,GAAG,GAAGD,IAApB;EACD;;EACD,IAAIG,WAAW,GAAG,CAAlB,EAAqB;IACnBA,WAAW,GAAG,CAAd;EACD;;EACD,OAAOA,WAAP;AACD;;AAED,SAASC,WAAT,CAAqBC,GAArB,EAAgC;EAC9B;EACA,IAAMC,MAAM,GAAGD,GAAG,CAACE,QAAJ,GAAeC,KAAf,CAAqB,MAArB,CAAf;EACA,IAAMC,GAAG,GAAG,CAACH,MAAM,CAAC,CAAD,CAAN,CAAUE,KAAV,CAAgB,GAAhB,EAAqB,CAArB,KAA2B,EAA5B,EAAgCE,MAAhC,GAAyC,EAAEJ,MAAM,CAAC,CAAD,CAAN,IAAa,CAAf,CAArD;EACA,OAAOG,GAAG,GAAG,CAAN,GAAUA,GAAV,GAAgB,CAAvB;AACD;AAED;;;;;;;;;AAOA,OAAM,SAAUE,YAAV,CAAuBC,IAAvB,EAAqCC,IAArC,EAAiD;EACrD,IAAMC,UAAU,GAAGV,WAAW,CAACQ,IAAD,CAA9B;EACA,IAAMG,UAAU,GAAGX,WAAW,CAACS,IAAD,CAA9B;EACA,IAAMG,OAAO,GAAGvB,aAAMA,IAAI,CAACQ,GAAL,CAASa,UAAT,EAAqBC,UAArB,CAAN,CAAhB;EACA,OAAO,CAACH,IAAI,GAAGI,OAAP,GAAiBH,IAAI,GAAGG,OAAzB,IAAoCA,OAA3C;AACD","names":["each","isNil","calBase","a","b","e","Math","E","value","pow","log","getLogPositiveMin","values","base","max","apply","positiveMin","digitLength","num","eSplit","toString","split","len","length","precisionAdd","num1","num2","num1Digits","num2Digits","baseNum"],"sourceRoot":"","sources":["../../src/util/math.ts"],"sourcesContent":[null]},"metadata":{},"sourceType":"module"}