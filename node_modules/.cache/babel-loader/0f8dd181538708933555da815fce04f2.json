{"ast":null,"code":"import { bbox } from './bbox';\nimport { offset, getStrokeWidth } from './util';\nimport { FunctionExt } from '../../util';\n/**\n * Places the connection point at the intersection between the\n * link path end segment and the element's unrotated bbox.\n */\n\nexport const rect = function (line, view, magnet, options, type) {\n  const cell = view.cell;\n  const angle = cell.isNode() ? cell.getAngle() : 0;\n\n  if (angle === 0) {\n    return FunctionExt.call(bbox, this, line, view, magnet, options, type);\n  }\n\n  const bboxRaw = view.getUnrotatedBBoxOfElement(magnet);\n\n  if (options.stroked) {\n    bboxRaw.inflate(getStrokeWidth(magnet) / 2);\n  }\n\n  const center = bboxRaw.getCenter();\n  const lineRaw = line.clone().rotate(angle, center);\n  const intersections = lineRaw.setLength(1e6).intersect(bboxRaw);\n  const p = intersections && intersections.length ? lineRaw.start.closest(intersections).rotate(-angle, center) : line.end;\n  return offset(p, line.start, options.offset);\n};","map":{"version":3,"mappings":"AAAA,SAASA,IAAT,QAAqB,QAArB;AACA,SAASC,MAAT,EAAiBC,cAAjB,QAAuC,QAAvC;AAEA,SAASC,WAAT,QAA4B,YAA5B;AAIA;;;;;AAIA,OAAO,MAAMC,IAAI,GAAiD,UAChEC,IADgE,EAEhEC,IAFgE,EAGhEC,MAHgE,EAIhEC,OAJgE,EAKhEC,IALgE,EAK5D;EAEJ,MAAMC,IAAI,GAAGJ,IAAI,CAACI,IAAlB;EACA,MAAMC,KAAK,GAAGD,IAAI,CAACE,MAAL,KAAgBF,IAAI,CAACG,QAAL,EAAhB,GAAkC,CAAhD;;EACA,IAAIF,KAAK,KAAK,CAAd,EAAiB;IACf,OAAOR,WAAW,CAACW,IAAZ,CAAiBd,IAAjB,EAAuB,IAAvB,EAA6BK,IAA7B,EAAmCC,IAAnC,EAAyCC,MAAzC,EAAiDC,OAAjD,EAA0DC,IAA1D,CAAP;EACD;;EAED,MAAMM,OAAO,GAAGT,IAAI,CAACU,yBAAL,CAA+BT,MAA/B,CAAhB;;EACA,IAAIC,OAAO,CAACS,OAAZ,EAAqB;IACnBF,OAAO,CAACG,OAAR,CAAgBhB,cAAc,CAACK,MAAD,CAAd,GAAyB,CAAzC;EACD;;EACD,MAAMY,MAAM,GAAGJ,OAAO,CAACK,SAAR,EAAf;EACA,MAAMC,OAAO,GAAGhB,IAAI,CAACiB,KAAL,GAAaC,MAAb,CAAoBZ,KAApB,EAA2BQ,MAA3B,CAAhB;EACA,MAAMK,aAAa,GAAGH,OAAO,CAACI,SAAR,CAAkB,GAAlB,EAAuBC,SAAvB,CAAiCX,OAAjC,CAAtB;EACA,MAAMY,CAAC,GACLH,aAAa,IAAIA,aAAa,CAACI,MAA/B,GACIP,OAAO,CAACQ,KAAR,CAAcC,OAAd,CAAsBN,aAAtB,EAAsCD,MAAtC,CAA6C,CAACZ,KAA9C,EAAqDQ,MAArD,CADJ,GAEId,IAAI,CAAC0B,GAHX;EAIA,OAAO9B,MAAM,CAAC0B,CAAD,EAAItB,IAAI,CAACwB,KAAT,EAAgBrB,OAAO,CAACP,MAAxB,CAAb;AACD,CAzBM","names":["bbox","offset","getStrokeWidth","FunctionExt","rect","line","view","magnet","options","type","cell","angle","isNode","getAngle","call","bboxRaw","getUnrotatedBBoxOfElement","stroked","inflate","center","getCenter","lineRaw","clone","rotate","intersections","setLength","intersect","p","length","start","closest","end"],"sourceRoot":"","sources":["../../../src/registry/connection-point/rect.ts"],"sourcesContent":[null]},"metadata":{},"sourceType":"module"}