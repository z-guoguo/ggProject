{"ast":null,"code":"import { each, isString } from '@antv/util';\nvar timer = null;\n\nvar StateController =\n/** @class */\nfunction () {\n  function StateController(graph) {\n    this.graph = graph;\n    /**\n     * this.cachedStates = {\n     *    enabled: {\n     *        hover: [Node]\n     *    },\n     *     disabled: {}\n     *  }\n     */\n\n    this.cachedStates = {\n      enabled: {},\n      disabled: {}\n    };\n    this.destroyed = false;\n  }\n  /**\n   * 检查 cache 的可用性\n   *\n   * @private\n   * @param {Item} item\n   * @param {string} state\n   * @param {object} cache\n   * @returns\n   * @memberof State\n   */\n\n\n  StateController.checkCache = function (item, state, cache) {\n    if (!cache[state]) {\n      return;\n    }\n\n    var index = cache[state].indexOf(item);\n\n    if (index >= 0) {\n      cache[state].splice(index, 1);\n    }\n  };\n  /**\n   * 缓存 state\n   *\n   * @private\n   * @param {Item} item Item 实例\n   * @param {string} state 状态名称\n   * @param {object} states\n   * @memberof State\n   */\n\n\n  StateController.cacheState = function (item, state, states) {\n    if (!states[state]) {\n      states[state] = [];\n    }\n\n    states[state].push(item);\n  };\n  /**\n   * 更新 Item 的状态\n   *\n   * @param {Item} item Item实例\n   * @param {string} state 状态名称\n   * @param {boolean} enabled 状态是否可用\n   * @memberof State\n   */\n\n\n  StateController.prototype.updateState = function (item, state, enabled) {\n    var _this = this;\n\n    var checkCache = StateController.checkCache,\n        cacheState = StateController.cacheState;\n\n    if (item.destroyed) {\n      return;\n    }\n\n    var cachedStates = this.cachedStates;\n    var enabledStates = cachedStates.enabled;\n    var disabledStates = cachedStates.disabled;\n\n    if (enabled) {\n      checkCache(item, state, disabledStates);\n      cacheState(item, state, enabledStates);\n    } else {\n      checkCache(item, state, enabledStates);\n      cacheState(item, state, disabledStates);\n    }\n\n    if (timer) {\n      clearTimeout(timer);\n    }\n\n    timer = setTimeout(function () {\n      timer = null;\n\n      _this.updateGraphStates();\n    }, 16);\n  };\n  /**\n   * 批量更新 states，兼容 updateState，支持更新一个 state\n   *\n   * @param {Item} item\n   * @param {(string | string[])} states\n   * @param {boolean} enabled\n   * @memberof State\n   */\n\n\n  StateController.prototype.updateStates = function (item, states, enabled) {\n    var _this = this;\n\n    if (isString(states)) {\n      this.updateState(item, states, enabled);\n    } else {\n      states.forEach(function (state) {\n        _this.updateState(item, state, enabled);\n      });\n    }\n  };\n  /**\n   * 更新 states\n   *\n   * @memberof State\n   */\n\n\n  StateController.prototype.updateGraphStates = function () {\n    var states = this.graph.get('states');\n    var cachedStates = this.cachedStates;\n    each(cachedStates.disabled, function (val, key) {\n      if (states[key]) {\n        states[key] = states[key].filter(function (item) {\n          return val.indexOf(item) < 0 && !val.destroyed;\n        });\n      }\n    });\n    each(cachedStates.enabled, function (val, key) {\n      if (!states[key]) {\n        states[key] = val;\n      } else {\n        var map_1 = {};\n        states[key].forEach(function (item) {\n          if (!item.destroyed) {\n            map_1[item.get('id')] = true;\n          }\n        });\n        val.forEach(function (item) {\n          if (!item.destroyed) {\n            var id = item.get('id');\n\n            if (!map_1[id]) {\n              map_1[id] = true;\n              states[key].push(item);\n            }\n          }\n        });\n      }\n    });\n    this.graph.emit('graphstatechange', {\n      states: states\n    });\n    this.cachedStates = {\n      enabled: {},\n      disabled: {}\n    };\n  };\n\n  StateController.prototype.destroy = function () {\n    this.graph = null;\n    this.cachedStates = null;\n\n    if (timer) {\n      clearTimeout(timer);\n    }\n\n    timer = null;\n    this.destroyed = true;\n  };\n\n  return StateController;\n}();\n\nexport default StateController;","map":{"version":3,"names":["each","isString","timer","StateController","graph","cachedStates","enabled","disabled","destroyed","checkCache","item","state","cache","index","indexOf","splice","cacheState","states","push","prototype","updateState","_this","enabledStates","disabledStates","clearTimeout","setTimeout","updateGraphStates","updateStates","forEach","get","val","key","filter","map_1","id","emit","destroy"],"sources":["/Users/wawalike/Desktop/ggProject/node_modules/@antv/g6-core/es/graph/controller/state.js"],"sourcesContent":["import { each, isString } from '@antv/util';\nvar timer = null;\n\nvar StateController =\n/** @class */\nfunction () {\n  function StateController(graph) {\n    this.graph = graph;\n    /**\n     * this.cachedStates = {\n     *    enabled: {\n     *        hover: [Node]\n     *    },\n     *     disabled: {}\n     *  }\n     */\n\n    this.cachedStates = {\n      enabled: {},\n      disabled: {}\n    };\n    this.destroyed = false;\n  }\n  /**\n   * 检查 cache 的可用性\n   *\n   * @private\n   * @param {Item} item\n   * @param {string} state\n   * @param {object} cache\n   * @returns\n   * @memberof State\n   */\n\n\n  StateController.checkCache = function (item, state, cache) {\n    if (!cache[state]) {\n      return;\n    }\n\n    var index = cache[state].indexOf(item);\n\n    if (index >= 0) {\n      cache[state].splice(index, 1);\n    }\n  };\n  /**\n   * 缓存 state\n   *\n   * @private\n   * @param {Item} item Item 实例\n   * @param {string} state 状态名称\n   * @param {object} states\n   * @memberof State\n   */\n\n\n  StateController.cacheState = function (item, state, states) {\n    if (!states[state]) {\n      states[state] = [];\n    }\n\n    states[state].push(item);\n  };\n  /**\n   * 更新 Item 的状态\n   *\n   * @param {Item} item Item实例\n   * @param {string} state 状态名称\n   * @param {boolean} enabled 状态是否可用\n   * @memberof State\n   */\n\n\n  StateController.prototype.updateState = function (item, state, enabled) {\n    var _this = this;\n\n    var checkCache = StateController.checkCache,\n        cacheState = StateController.cacheState;\n\n    if (item.destroyed) {\n      return;\n    }\n\n    var cachedStates = this.cachedStates;\n    var enabledStates = cachedStates.enabled;\n    var disabledStates = cachedStates.disabled;\n\n    if (enabled) {\n      checkCache(item, state, disabledStates);\n      cacheState(item, state, enabledStates);\n    } else {\n      checkCache(item, state, enabledStates);\n      cacheState(item, state, disabledStates);\n    }\n\n    if (timer) {\n      clearTimeout(timer);\n    }\n\n    timer = setTimeout(function () {\n      timer = null;\n\n      _this.updateGraphStates();\n    }, 16);\n  };\n  /**\n   * 批量更新 states，兼容 updateState，支持更新一个 state\n   *\n   * @param {Item} item\n   * @param {(string | string[])} states\n   * @param {boolean} enabled\n   * @memberof State\n   */\n\n\n  StateController.prototype.updateStates = function (item, states, enabled) {\n    var _this = this;\n\n    if (isString(states)) {\n      this.updateState(item, states, enabled);\n    } else {\n      states.forEach(function (state) {\n        _this.updateState(item, state, enabled);\n      });\n    }\n  };\n  /**\n   * 更新 states\n   *\n   * @memberof State\n   */\n\n\n  StateController.prototype.updateGraphStates = function () {\n    var states = this.graph.get('states');\n    var cachedStates = this.cachedStates;\n    each(cachedStates.disabled, function (val, key) {\n      if (states[key]) {\n        states[key] = states[key].filter(function (item) {\n          return val.indexOf(item) < 0 && !val.destroyed;\n        });\n      }\n    });\n    each(cachedStates.enabled, function (val, key) {\n      if (!states[key]) {\n        states[key] = val;\n      } else {\n        var map_1 = {};\n        states[key].forEach(function (item) {\n          if (!item.destroyed) {\n            map_1[item.get('id')] = true;\n          }\n        });\n        val.forEach(function (item) {\n          if (!item.destroyed) {\n            var id = item.get('id');\n\n            if (!map_1[id]) {\n              map_1[id] = true;\n              states[key].push(item);\n            }\n          }\n        });\n      }\n    });\n    this.graph.emit('graphstatechange', {\n      states: states\n    });\n    this.cachedStates = {\n      enabled: {},\n      disabled: {}\n    };\n  };\n\n  StateController.prototype.destroy = function () {\n    this.graph = null;\n    this.cachedStates = null;\n\n    if (timer) {\n      clearTimeout(timer);\n    }\n\n    timer = null;\n    this.destroyed = true;\n  };\n\n  return StateController;\n}();\n\nexport default StateController;"],"mappings":"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"},"metadata":{},"sourceType":"module"}