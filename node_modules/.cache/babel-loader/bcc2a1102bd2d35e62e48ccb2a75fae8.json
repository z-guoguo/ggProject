{"ast":null,"code":"import { getTextWidth, getTextHeight, assembleFont } from '../util/text';\nexport default function (shape) {\n  var attrs = shape.attr();\n  var x = attrs.x,\n      y = attrs.y,\n      text = attrs.text,\n      fontSize = attrs.fontSize,\n      lineHeight = attrs.lineHeight;\n  var font = attrs.font;\n\n  if (!font) {\n    // 如果未组装 font\n    font = assembleFont(attrs);\n  }\n\n  var width = getTextWidth(text, font);\n  var bbox;\n\n  if (!width) {\n    // 如果width不存在，四点共其实点\n    bbox = {\n      x: x,\n      y: y,\n      width: 0,\n      height: 0\n    };\n  } else {\n    var textAlign = attrs.textAlign,\n        textBaseline = attrs.textBaseline;\n    var height = getTextHeight(text, fontSize, lineHeight); // attrs.height\n    // 默认左右对齐：left, 默认上下对齐 bottom\n\n    var point = {\n      x: x,\n      y: y - height\n    };\n\n    if (textAlign) {\n      if (textAlign === 'end' || textAlign === 'right') {\n        point.x -= width;\n      } else if (textAlign === 'center') {\n        point.x -= width / 2;\n      }\n    }\n\n    if (textBaseline) {\n      if (textBaseline === 'top') {\n        point.y += height;\n      } else if (textBaseline === 'middle') {\n        point.y += height / 2;\n      }\n    }\n\n    bbox = {\n      x: point.x,\n      y: point.y,\n      width: width,\n      height: height\n    };\n  }\n\n  return bbox;\n}","map":{"version":3,"mappings":"AAEA,SAASA,YAAT,EAAuBC,aAAvB,EAAsCC,YAAtC,QAA0D,cAA1D;AAEA,eAAc,UAAWC,KAAX,EAAwB;EACpC,IAAMC,KAAK,GAAGD,KAAK,CAACE,IAAN,EAAd;EACQ,KAAC,GAAoCD,KAAK,EAA1C;EAAA,IAAGE,CAAC,GAAiCF,KAAK,EAA1C;EAAA,IAAMG,IAAI,GAA2BH,KAAK,KAA1C;EAAA,IAAYI,QAAQ,GAAiBJ,KAAK,SAA1C;EAAA,IAAsBK,UAAU,GAAKL,KAAK,WAA1C;EACR,IAAIM,IAAI,GAAGN,KAAK,CAACM,IAAjB;;EACA,IAAI,CAACA,IAAL,EAAW;IACT;IACAA,IAAI,GAAGR,YAAY,CAACE,KAAD,CAAnB;EACD;;EACD,IAAMO,KAAK,GAAGX,YAAY,CAACO,IAAD,EAAOG,IAAP,CAA1B;EACA,IAAIE,IAAJ;;EACA,IAAI,CAACD,KAAL,EAAY;IACV;IACAC,IAAI,GAAG;MACLC,CAAC,GADI;MAELP,CAAC,GAFI;MAGLK,KAAK,EAAE,CAHF;MAILG,MAAM,EAAE;IAJH,CAAP;EAMD,CARD,MAQO;IACG,aAAS,GAAmBV,KAAK,UAAjC;IAAA,IAAWW,YAAY,GAAKX,KAAK,aAAjC;IACR,IAAMU,MAAM,GAAGb,aAAa,CAACM,IAAD,EAAOC,QAAP,EAAiBC,UAAjB,CAA5B,CAFK,CAEqD;IAC1D;;IACA,IAAMO,KAAK,GAAG;MACZH,CAAC,GADW;MAEZP,CAAC,EAAEA,CAAC,GAAGQ;IAFK,CAAd;;IAIA,IAAIG,SAAJ,EAAe;MACb,IAAIA,SAAS,KAAK,KAAd,IAAuBA,SAAS,KAAK,OAAzC,EAAkD;QAChDD,KAAK,CAACH,CAAN,IAAWF,KAAX;MACD,CAFD,MAEO,IAAIM,SAAS,KAAK,QAAlB,EAA4B;QACjCD,KAAK,CAACH,CAAN,IAAWF,KAAK,GAAG,CAAnB;MACD;IACF;;IACD,IAAII,YAAJ,EAAkB;MAChB,IAAIA,YAAY,KAAK,KAArB,EAA4B;QAC1BC,KAAK,CAACV,CAAN,IAAWQ,MAAX;MACD,CAFD,MAEO,IAAIC,YAAY,KAAK,QAArB,EAA+B;QACpCC,KAAK,CAACV,CAAN,IAAWQ,MAAM,GAAG,CAApB;MACD;IACF;;IAEDF,IAAI,GAAG;MACLC,CAAC,EAAEG,KAAK,CAACH,CADJ;MAELP,CAAC,EAAEU,KAAK,CAACV,CAFJ;MAGLK,KAAK,EAAEA,KAHF;MAILG,MAAM,EAAEA;IAJH,CAAP;EAMD;;EACD,OAAOF,IAAP;AACD","names":["getTextWidth","getTextHeight","assembleFont","shape","attrs","attr","y","text","fontSize","lineHeight","font","width","bbox","x","height","textBaseline","point","textAlign"],"sourceRoot":"","sources":["../../src/bbox/text.ts"],"sourcesContent":[null]},"metadata":{},"sourceType":"module"}