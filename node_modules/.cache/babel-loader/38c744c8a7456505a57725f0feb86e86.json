{"ast":null,"code":"/**\n * @fileoverview pattern\n * @author dengfuping_develop@163.com\n */\nimport { uniqueId } from '@antv/util';\nimport { createSVGElement } from '../util/dom';\nvar regexPR = /^p\\s*\\(\\s*([axyn])\\s*\\)\\s*(.*)/i;\n\nvar Pattern =\n/** @class */\nfunction () {\n  function Pattern(cfg) {\n    this.cfg = {};\n    var el = createSVGElement('pattern');\n    el.setAttribute('patternUnits', 'userSpaceOnUse');\n    var child = createSVGElement('image');\n    el.appendChild(child);\n    var id = uniqueId('pattern_');\n    el.id = id;\n    this.el = el;\n    this.id = id;\n    this.cfg = cfg;\n    var arr = regexPR.exec(cfg);\n    var source = arr[2];\n    child.setAttribute('href', source);\n    var img = new Image();\n\n    if (!source.match(/^data:/i)) {\n      img.crossOrigin = 'Anonymous';\n    }\n\n    img.src = source;\n\n    function onload() {\n      el.setAttribute('width', \"\" + img.width);\n      el.setAttribute('height', \"\" + img.height);\n    }\n\n    if (img.complete) {\n      onload();\n    } else {\n      img.onload = onload; // Fix onload() bug in IE9\n\n      img.src = img.src;\n    }\n\n    return this;\n  }\n\n  Pattern.prototype.match = function (type, attr) {\n    return this.cfg === attr;\n  };\n\n  return Pattern;\n}();\n\nexport default Pattern;","map":{"version":3,"mappings":"AAAA;;;;AAKA,SAASA,QAAT,QAAyB,YAAzB;AACA,SAASC,gBAAT,QAAiC,aAAjC;AAEA,IAAMC,OAAO,GAAG,iCAAhB;;AAEA;AAAA;AAAA;EAOE,iBAAYC,GAAZ,EAAe;IAJf,WAEI,EAFJ;IAKE,IAAMC,EAAE,GAAGH,gBAAgB,CAAC,SAAD,CAA3B;IACAG,EAAE,CAACC,YAAH,CAAgB,cAAhB,EAAgC,gBAAhC;IACA,IAAMC,KAAK,GAAGL,gBAAgB,CAAC,OAAD,CAA9B;IACAG,EAAE,CAACG,WAAH,CAAeD,KAAf;IACA,IAAME,EAAE,GAAGR,QAAQ,CAAC,UAAD,CAAnB;IACAI,EAAE,CAACI,EAAH,GAAQA,EAAR;IACA,KAAKJ,EAAL,GAAUA,EAAV;IACA,KAAKI,EAAL,GAAUA,EAAV;IACA,KAAKL,GAAL,GAAWA,GAAX;IACA,IAAMM,GAAG,GAAGP,OAAO,CAACQ,IAAR,CAAaP,GAAb,CAAZ;IACA,IAAMQ,MAAM,GAAGF,GAAG,CAAC,CAAD,CAAlB;IACAH,KAAK,CAACD,YAAN,CAAmB,MAAnB,EAA2BM,MAA3B;IACA,IAAMC,GAAG,GAAG,IAAIC,KAAJ,EAAZ;;IACA,IAAI,CAACF,MAAM,CAACG,KAAP,CAAa,SAAb,CAAL,EAA8B;MAC5BF,GAAG,CAACG,WAAJ,GAAkB,WAAlB;IACD;;IACDH,GAAG,CAACI,GAAJ,GAAUL,MAAV;;IACA,SAASM,MAAT,GAAe;MACbb,EAAE,CAACC,YAAH,CAAgB,OAAhB,EAAyB,KAAGO,GAAG,CAACM,KAAhC;MACAd,EAAE,CAACC,YAAH,CAAgB,QAAhB,EAA0B,KAAGO,GAAG,CAACO,MAAjC;IACD;;IACD,IAAIP,GAAG,CAACQ,QAAR,EAAkB;MAChBH,MAAM;IACP,CAFD,MAEO;MACLL,GAAG,CAACK,MAAJ,GAAaA,MAAb,CADK,CAEL;;MACAL,GAAG,CAACI,GAAJ,GAAUJ,GAAG,CAACI,GAAd;IACD;;IAED,OAAO,IAAP;EACD;;EAEDK,oCAAMC,IAAN,EAAYC,IAAZ,EAAgB;IACd,OAAO,KAAKpB,GAAL,KAAaoB,IAApB;EACD,CAFD;;EAGF;AAAC,CA3CD;;AA6CA,eAAeF,OAAf","names":["uniqueId","createSVGElement","regexPR","cfg","el","setAttribute","child","appendChild","id","arr","exec","source","img","Image","match","crossOrigin","src","onload","width","height","complete","Pattern","type","attr"],"sourceRoot":"","sources":["../../src/defs/pattern.ts"],"sourcesContent":[null]},"metadata":{},"sourceType":"module"}