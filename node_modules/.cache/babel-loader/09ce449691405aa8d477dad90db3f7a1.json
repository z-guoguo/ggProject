{"ast":null,"code":"\"use strict\";\n\nrequire(\"core-js/modules/es.error.cause.js\");\n\nvar __spreadArray = this && this.__spreadArray || function (to, from) {\n  for (var i = 0, il = from.length, j = to.length; i < il; i++, j++) to[j] = from[i];\n\n  return to;\n};\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.resolveInstance = void 0;\n\nvar error_msgs_1 = require(\"../constants/error_msgs\");\n\nvar literal_types_1 = require(\"../constants/literal_types\");\n\nvar METADATA_KEY = require(\"../constants/metadata_keys\");\n\nfunction _injectProperties(instance, childRequests, resolveRequest) {\n  var propertyInjectionsRequests = childRequests.filter(function (childRequest) {\n    return childRequest.target !== null && childRequest.target.type === literal_types_1.TargetTypeEnum.ClassProperty;\n  });\n  var propertyInjections = propertyInjectionsRequests.map(resolveRequest);\n  propertyInjectionsRequests.forEach(function (r, index) {\n    var propertyName = \"\";\n    propertyName = r.target.name.value();\n    var injection = propertyInjections[index];\n    instance[propertyName] = injection;\n  });\n  return instance;\n}\n\nfunction _createInstance(Func, injections) {\n  return new (Func.bind.apply(Func, __spreadArray([void 0], injections)))();\n}\n\nfunction _postConstruct(constr, result) {\n  if (Reflect.hasMetadata(METADATA_KEY.POST_CONSTRUCT, constr)) {\n    var data = Reflect.getMetadata(METADATA_KEY.POST_CONSTRUCT, constr);\n\n    try {\n      result[data.value]();\n    } catch (e) {\n      throw new Error(error_msgs_1.POST_CONSTRUCT_ERROR(constr.name, e.message));\n    }\n  }\n}\n\nfunction resolveInstance(constr, childRequests, resolveRequest) {\n  var result = null;\n\n  if (childRequests.length > 0) {\n    var constructorInjectionsRequests = childRequests.filter(function (childRequest) {\n      return childRequest.target !== null && childRequest.target.type === literal_types_1.TargetTypeEnum.ConstructorArgument;\n    });\n    var constructorInjections = constructorInjectionsRequests.map(resolveRequest);\n    result = _createInstance(constr, constructorInjections);\n    result = _injectProperties(result, childRequests, resolveRequest);\n  } else {\n    result = new constr();\n  }\n\n  _postConstruct(constr, result);\n\n  return result;\n}\n\nexports.resolveInstance = resolveInstance;","map":{"version":3,"mappings":";;;;;;;;;;;;;;;AAAA;;AACA;;AACA;;AAIA,SAASA,iBAAT,CACIC,QADJ,EAEIC,aAFJ,EAGIC,cAHJ,EAGoD;EAGhD,IAAMC,0BAA0B,GAAGF,aAAa,CAACG,MAAd,CAAqB,UAACC,YAAD,EAAiC;IACrF,OACIA,YAAY,CAACC,MAAb,KAAwB,IAAxB,IACAD,YAAY,CAACC,MAAb,CAAoBC,IAApB,KAA6BC,+BAAeC,aAFhD;EAGC,CAJ8B,CAAnC;EAMA,IAAMC,kBAAkB,GAAGP,0BAA0B,CAACQ,GAA3B,CAA+BT,cAA/B,CAA3B;EAEAC,0BAA0B,CAACS,OAA3B,CAAmC,UAACC,CAAD,EAAwBC,KAAxB,EAAqC;IACpE,IAAIC,YAAY,GAAG,EAAnB;IACAA,YAAY,GAAGF,CAAC,CAACP,MAAF,CAASU,IAAT,CAAcC,KAAd,EAAf;IACA,IAAMC,SAAS,GAAGR,kBAAkB,CAACI,KAAD,CAApC;IACAd,QAAQ,CAACe,YAAD,CAAR,GAAyBG,SAAzB;EACH,CALD;EAOA,OAAOlB,QAAP;AAEH;;AAED,SAASmB,eAAT,CAAyBC,IAAzB,EAAwDC,UAAxD,EAA4E;EACxE,YAAWD,IAAI,KAAJ,CAAIE,KAAJ,OAAIC,wBAAIF,UAAJ,CAAJ,CAAX;AACH;;AAED,SAASG,cAAT,CAAwBC,MAAxB,EAAyDC,MAAzD,EAAoE;EAChE,IAAIC,OAAO,CAACC,WAAR,CAAoBC,YAAY,CAACC,cAAjC,EAAiDL,MAAjD,CAAJ,EAA8D;IAC1D,IAAMM,IAAI,GAAaJ,OAAO,CAACK,WAAR,CAAoBH,YAAY,CAACC,cAAjC,EAAiDL,MAAjD,CAAvB;;IACA,IAAI;MACAC,MAAM,CAACK,IAAI,CAACd,KAAN,CAAN;IACH,CAFD,CAEE,OAAOgB,CAAP,EAAU;MACR,MAAM,IAAIC,KAAJ,CAAUC,kCAAqBV,MAAM,CAACT,IAA5B,EAAkCiB,CAAC,CAACG,OAApC,CAAV,CAAN;IACH;EACJ;AACJ;;AAED,SAASC,eAAT,CACIZ,MADJ,EAEIxB,aAFJ,EAGIC,cAHJ,EAGoD;EAGhD,IAAIwB,MAAM,GAAQ,IAAlB;;EAEA,IAAIzB,aAAa,CAACqC,MAAd,GAAuB,CAA3B,EAA8B;IAE1B,IAAMC,6BAA6B,GAAGtC,aAAa,CAACG,MAAd,CAAqB,UAACC,YAAD,EAAiC;MACxF,OAACA,YAAY,CAACC,MAAb,KAAwB,IAAxB,IAAgCD,YAAY,CAACC,MAAb,CAAoBC,IAApB,KAA6BC,+BAAegC,mBAA7E;IAAiG,CAD/D,CAAtC;IAGA,IAAMC,qBAAqB,GAAGF,6BAA6B,CAAC5B,GAA9B,CAAkCT,cAAlC,CAA9B;IAEAwB,MAAM,GAAGP,eAAe,CAACM,MAAD,EAASgB,qBAAT,CAAxB;IACAf,MAAM,GAAG3B,iBAAiB,CAAC2B,MAAD,EAASzB,aAAT,EAAwBC,cAAxB,CAA1B;EAEH,CAVD,MAUO;IACHwB,MAAM,GAAG,IAAID,MAAJ,EAAT;EACH;;EACDD,cAAc,CAACC,MAAD,EAASC,MAAT,CAAd;;EAEA,OAAOA,MAAP;AACH;;AAEQgB","names":["_injectProperties","instance","childRequests","resolveRequest","propertyInjectionsRequests","filter","childRequest","target","type","literal_types_1","ClassProperty","propertyInjections","map","forEach","r","index","propertyName","name","value","injection","_createInstance","Func","injections","apply","__spreadArray","_postConstruct","constr","result","Reflect","hasMetadata","METADATA_KEY","POST_CONSTRUCT","data","getMetadata","e","Error","error_msgs_1","message","resolveInstance","length","constructorInjectionsRequests","ConstructorArgument","constructorInjections","exports"],"sourceRoot":"","sources":["../../src/resolution/instantiation.ts"],"sourcesContent":[null]},"metadata":{},"sourceType":"script"}