{"ast":null,"code":"import { debounce } from './util';\nexport function createSensor(element) {\n  let sensor = null;\n  let listeners = [];\n  const trigger = debounce(() => {\n    listeners.forEach(listener => {\n      listener(element);\n    });\n  });\n\n  const create = () => {\n    const s = new ResizeObserver(trigger);\n    s.observe(element);\n    trigger();\n    return s;\n  };\n\n  const bind = listener => {\n    if (!sensor) {\n      sensor = create();\n    }\n\n    if (listeners.indexOf(listener) === -1) {\n      listeners.push(listener);\n    }\n  };\n\n  const destroy = () => {\n    if (sensor) {\n      sensor.disconnect();\n      listeners = [];\n      sensor = null;\n    }\n  };\n\n  const unbind = listener => {\n    const idx = listeners.indexOf(listener);\n\n    if (idx !== -1) {\n      listeners.splice(idx, 1);\n    } // no listener, and sensor is exist then destroy the sensor\n\n\n    if (listeners.length === 0 && sensor) {\n      destroy();\n    }\n  };\n\n  return {\n    element,\n    bind,\n    destroy,\n    unbind\n  };\n}","map":{"version":3,"mappings":"AAAA,SAASA,QAAT,QAAyB,QAAzB;AAGA,OAAM,SAAUC,YAAV,CAAuBC,OAAvB,EAAuC;EAC3C,IAAIC,MAAM,GAA0B,IAApC;EACA,IAAIC,SAAS,GAAe,EAA5B;EAEA,MAAMC,OAAO,GAAGL,QAAQ,CAAC,MAAK;IAC5BI,SAAS,CAACE,OAAV,CAAmBC,QAAD,IAAa;MAC7BA,QAAQ,CAACL,OAAD,CAAR;IACD,CAFD;EAGD,CAJuB,CAAxB;;EAMA,MAAMM,MAAM,GAAG,MAAK;IAClB,MAAMC,CAAC,GAAG,IAAIC,cAAJ,CAAmBL,OAAnB,CAAV;IACAI,CAAC,CAACE,OAAF,CAAUT,OAAV;IACAG,OAAO;IACP,OAAOI,CAAP;EACD,CALD;;EAOA,MAAMG,IAAI,GAAIL,QAAD,IAAuB;IAClC,IAAI,CAACJ,MAAL,EAAa;MACXA,MAAM,GAAGK,MAAM,EAAf;IACD;;IAED,IAAIJ,SAAS,CAACS,OAAV,CAAkBN,QAAlB,MAAgC,CAAC,CAArC,EAAwC;MACtCH,SAAS,CAACU,IAAV,CAAeP,QAAf;IACD;EACF,CARD;;EAUA,MAAMQ,OAAO,GAAG,MAAK;IACnB,IAAIZ,MAAJ,EAAY;MACVA,MAAM,CAACa,UAAP;MACAZ,SAAS,GAAG,EAAZ;MACAD,MAAM,GAAG,IAAT;IACD;EACF,CAND;;EAQA,MAAMc,MAAM,GAAIV,QAAD,IAAuB;IACpC,MAAMW,GAAG,GAAGd,SAAS,CAACS,OAAV,CAAkBN,QAAlB,CAAZ;;IACA,IAAIW,GAAG,KAAK,CAAC,CAAb,EAAgB;MACdd,SAAS,CAACe,MAAV,CAAiBD,GAAjB,EAAsB,CAAtB;IACD,CAJmC,CAMpC;;;IACA,IAAId,SAAS,CAACgB,MAAV,KAAqB,CAArB,IAA0BjB,MAA9B,EAAsC;MACpCY,OAAO;IACR;EACF,CAVD;;EAYA,OAAO;IACLb,OADK;IAELU,IAFK;IAGLG,OAHK;IAILE;EAJK,CAAP;AAMD","names":["debounce","createSensor","element","sensor","listeners","trigger","forEach","listener","create","s","ResizeObserver","observe","bind","indexOf","push","destroy","disconnect","unbind","idx","splice","length"],"sourceRoot":"","sources":["../../../../src/util/size-sensor/sensors/observer.ts"],"sourcesContent":[null]},"metadata":{},"sourceType":"module"}