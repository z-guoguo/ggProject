{"ast":null,"code":"import { __assign } from \"tslib\";\nimport Shape from '../shape';\nimport Global from '../../global';\n/**\n * 基本的图片，可以添加文本，默认文本在图片的下面\n */\n\nShape.registerNode('image', {\n  options: {\n    img: 'https://gw.alipayobjects.com/mdn/rms_f8c6a0/afts/img/A*eD7nT6tmYgAAAAAAAAAAAABkARQnAQ',\n    size: 200,\n    labelCfg: {\n      style: {\n        fontFamily: Global.windowFontFamily\n      }\n    },\n    clipCfg: {\n      show: false,\n      type: 'circle',\n      // circle\n      r: 50,\n      // ellipse\n      rx: 50,\n      ry: 35,\n      // rect\n      width: 50,\n      height: 35,\n      // polygon\n      points: [[30, 12], [12, 30], [30, 48], [48, 30]],\n      // path\n      path: [['M', 25, 25], ['L', 50, 25], ['A', 12.5, 12.5, 0, 1, 1, 50, 50], ['A', 12.5, 12.5, 0, 1, 0, 50, 50], ['L', 25, 75], ['Z']],\n      // 坐标\n      x: 0,\n      y: 0 // clip 的属性样式\n      // style: {\n      //   lineWidth: 1\n      // },\n\n    }\n  },\n  shapeType: 'image',\n  labelPosition: 'bottom',\n  drawShape: function drawShape(cfg, group) {\n    var shapeType = this.shapeType;\n    var style = this.getShapeStyle(cfg);\n    delete style.fill;\n    var shape = group.addShape(shapeType, {\n      attrs: style,\n      className: \"\".concat(this.type, \"-keyShape\"),\n      name: \"\".concat(this.type, \"-keyShape\"),\n      draggable: true\n    });\n    this.drawClip(cfg, shape);\n    return shape;\n  },\n  drawClip: function drawClip(cfg, shape) {\n    var clip = (this.mergeStyle || this.getOptions(cfg)).clipCfg;\n\n    if (!clip.show) {\n      return;\n    } // 支持 circle、rect、ellipse、Polygon 及自定义 path clip\n\n\n    var type = clip.type,\n        x = clip.x,\n        y = clip.y,\n        style = clip.style;\n\n    if (type === 'circle') {\n      var r = clip.r;\n      shape.setClip({\n        type: 'circle',\n        attrs: __assign({\n          r: r,\n          x: x,\n          y: y\n        }, style)\n      });\n    } else if (type === 'rect') {\n      var width = clip.width,\n          height = clip.height;\n      var rectX = x - width / 2;\n      var rectY = y - height / 2;\n      shape.setClip({\n        type: 'rect',\n        attrs: __assign({\n          x: rectX,\n          y: rectY,\n          width: width,\n          height: height\n        }, style)\n      });\n    } else if (type === 'ellipse') {\n      var rx = clip.rx,\n          ry = clip.ry;\n      shape.setClip({\n        type: 'ellipse',\n        attrs: __assign({\n          x: x,\n          y: y,\n          rx: rx,\n          ry: ry\n        }, style)\n      });\n    } else if (type === 'polygon') {\n      var points = clip.points;\n      shape.setClip({\n        type: 'polygon',\n        attrs: __assign({\n          points: points\n        }, style)\n      });\n    } else if (type === 'path') {\n      var path = clip.path;\n      shape.setClip({\n        type: 'path',\n        attrs: __assign({\n          path: path\n        }, style)\n      });\n    }\n  },\n  getShapeStyle: function getShapeStyle(cfg) {\n    var _a = this.mergeStyle || this.getOptions(cfg),\n        defaultStyle = _a.style,\n        img = _a.img;\n\n    var size = this.getSize(cfg);\n    var width = size[0];\n    var height = size[1];\n\n    if (defaultStyle) {\n      width = defaultStyle.width || size[0];\n      height = defaultStyle.height || size[1];\n    }\n\n    var style = __assign({\n      x: -width / 2,\n      y: -height / 2,\n      width: width,\n      height: height,\n      img: img\n    }, defaultStyle);\n\n    return style;\n  },\n  updateShapeStyle: function updateShapeStyle(cfg, item) {\n    var group = item.getContainer();\n    var shapeClassName = \"\".concat(this.itemType, \"-shape\");\n    var shape = group['shapeMap'][shapeClassName] || group.find(function (element) {\n      return element.get('className') === shapeClassName;\n    }) || item.getKeyShape();\n    var shapeStyle = this.getShapeStyle(cfg);\n\n    if (shape && !shape.destroyed) {\n      shape.attr(shapeStyle);\n    }\n  }\n}, 'single-node');","map":{"version":3,"names":["__assign","Shape","Global","registerNode","options","img","size","labelCfg","style","fontFamily","windowFontFamily","clipCfg","show","type","r","rx","ry","width","height","points","path","x","y","shapeType","labelPosition","drawShape","cfg","group","getShapeStyle","fill","shape","addShape","attrs","className","concat","name","draggable","drawClip","clip","mergeStyle","getOptions","setClip","rectX","rectY","_a","defaultStyle","getSize","updateShapeStyle","item","getContainer","shapeClassName","itemType","find","element","get","getKeyShape","shapeStyle","destroyed","attr"],"sources":["/Users/wawalike/Desktop/ggProject/node_modules/@antv/g6-core/es/element/nodes/image.js"],"sourcesContent":["import { __assign } from \"tslib\";\nimport Shape from '../shape';\nimport Global from '../../global';\n/**\n * 基本的图片，可以添加文本，默认文本在图片的下面\n */\n\nShape.registerNode('image', {\n  options: {\n    img: 'https://gw.alipayobjects.com/mdn/rms_f8c6a0/afts/img/A*eD7nT6tmYgAAAAAAAAAAAABkARQnAQ',\n    size: 200,\n    labelCfg: {\n      style: {\n        fontFamily: Global.windowFontFamily\n      }\n    },\n    clipCfg: {\n      show: false,\n      type: 'circle',\n      // circle\n      r: 50,\n      // ellipse\n      rx: 50,\n      ry: 35,\n      // rect\n      width: 50,\n      height: 35,\n      // polygon\n      points: [[30, 12], [12, 30], [30, 48], [48, 30]],\n      // path\n      path: [['M', 25, 25], ['L', 50, 25], ['A', 12.5, 12.5, 0, 1, 1, 50, 50], ['A', 12.5, 12.5, 0, 1, 0, 50, 50], ['L', 25, 75], ['Z']],\n      // 坐标\n      x: 0,\n      y: 0 // clip 的属性样式\n      // style: {\n      //   lineWidth: 1\n      // },\n\n    }\n  },\n  shapeType: 'image',\n  labelPosition: 'bottom',\n  drawShape: function drawShape(cfg, group) {\n    var shapeType = this.shapeType;\n    var style = this.getShapeStyle(cfg);\n    delete style.fill;\n    var shape = group.addShape(shapeType, {\n      attrs: style,\n      className: \"\".concat(this.type, \"-keyShape\"),\n      name: \"\".concat(this.type, \"-keyShape\"),\n      draggable: true\n    });\n    this.drawClip(cfg, shape);\n    return shape;\n  },\n  drawClip: function drawClip(cfg, shape) {\n    var clip = (this.mergeStyle || this.getOptions(cfg)).clipCfg;\n\n    if (!clip.show) {\n      return;\n    } // 支持 circle、rect、ellipse、Polygon 及自定义 path clip\n\n\n    var type = clip.type,\n        x = clip.x,\n        y = clip.y,\n        style = clip.style;\n\n    if (type === 'circle') {\n      var r = clip.r;\n      shape.setClip({\n        type: 'circle',\n        attrs: __assign({\n          r: r,\n          x: x,\n          y: y\n        }, style)\n      });\n    } else if (type === 'rect') {\n      var width = clip.width,\n          height = clip.height;\n      var rectX = x - width / 2;\n      var rectY = y - height / 2;\n      shape.setClip({\n        type: 'rect',\n        attrs: __assign({\n          x: rectX,\n          y: rectY,\n          width: width,\n          height: height\n        }, style)\n      });\n    } else if (type === 'ellipse') {\n      var rx = clip.rx,\n          ry = clip.ry;\n      shape.setClip({\n        type: 'ellipse',\n        attrs: __assign({\n          x: x,\n          y: y,\n          rx: rx,\n          ry: ry\n        }, style)\n      });\n    } else if (type === 'polygon') {\n      var points = clip.points;\n      shape.setClip({\n        type: 'polygon',\n        attrs: __assign({\n          points: points\n        }, style)\n      });\n    } else if (type === 'path') {\n      var path = clip.path;\n      shape.setClip({\n        type: 'path',\n        attrs: __assign({\n          path: path\n        }, style)\n      });\n    }\n  },\n  getShapeStyle: function getShapeStyle(cfg) {\n    var _a = this.mergeStyle || this.getOptions(cfg),\n        defaultStyle = _a.style,\n        img = _a.img;\n\n    var size = this.getSize(cfg);\n    var width = size[0];\n    var height = size[1];\n\n    if (defaultStyle) {\n      width = defaultStyle.width || size[0];\n      height = defaultStyle.height || size[1];\n    }\n\n    var style = __assign({\n      x: -width / 2,\n      y: -height / 2,\n      width: width,\n      height: height,\n      img: img\n    }, defaultStyle);\n\n    return style;\n  },\n  updateShapeStyle: function updateShapeStyle(cfg, item) {\n    var group = item.getContainer();\n    var shapeClassName = \"\".concat(this.itemType, \"-shape\");\n    var shape = group['shapeMap'][shapeClassName] || group.find(function (element) {\n      return element.get('className') === shapeClassName;\n    }) || item.getKeyShape();\n    var shapeStyle = this.getShapeStyle(cfg);\n\n    if (shape && !shape.destroyed) {\n      shape.attr(shapeStyle);\n    }\n  }\n}, 'single-node');"],"mappings":"AAAA,SAASA,QAAT,QAAyB,OAAzB;AACA,OAAOC,KAAP,MAAkB,UAAlB;AACA,OAAOC,MAAP,MAAmB,cAAnB;AACA;AACA;AACA;;AAEAD,KAAK,CAACE,YAAN,CAAmB,OAAnB,EAA4B;EAC1BC,OAAO,EAAE;IACPC,GAAG,EAAE,uFADE;IAEPC,IAAI,EAAE,GAFC;IAGPC,QAAQ,EAAE;MACRC,KAAK,EAAE;QACLC,UAAU,EAAEP,MAAM,CAACQ;MADd;IADC,CAHH;IAQPC,OAAO,EAAE;MACPC,IAAI,EAAE,KADC;MAEPC,IAAI,EAAE,QAFC;MAGP;MACAC,CAAC,EAAE,EAJI;MAKP;MACAC,EAAE,EAAE,EANG;MAOPC,EAAE,EAAE,EAPG;MAQP;MACAC,KAAK,EAAE,EATA;MAUPC,MAAM,EAAE,EAVD;MAWP;MACAC,MAAM,EAAE,CAAC,CAAC,EAAD,EAAK,EAAL,CAAD,EAAW,CAAC,EAAD,EAAK,EAAL,CAAX,EAAqB,CAAC,EAAD,EAAK,EAAL,CAArB,EAA+B,CAAC,EAAD,EAAK,EAAL,CAA/B,CAZD;MAaP;MACAC,IAAI,EAAE,CAAC,CAAC,GAAD,EAAM,EAAN,EAAU,EAAV,CAAD,EAAgB,CAAC,GAAD,EAAM,EAAN,EAAU,EAAV,CAAhB,EAA+B,CAAC,GAAD,EAAM,IAAN,EAAY,IAAZ,EAAkB,CAAlB,EAAqB,CAArB,EAAwB,CAAxB,EAA2B,EAA3B,EAA+B,EAA/B,CAA/B,EAAmE,CAAC,GAAD,EAAM,IAAN,EAAY,IAAZ,EAAkB,CAAlB,EAAqB,CAArB,EAAwB,CAAxB,EAA2B,EAA3B,EAA+B,EAA/B,CAAnE,EAAuG,CAAC,GAAD,EAAM,EAAN,EAAU,EAAV,CAAvG,EAAsH,CAAC,GAAD,CAAtH,CAdC;MAeP;MACAC,CAAC,EAAE,CAhBI;MAiBPC,CAAC,EAAE,CAjBI,CAiBF;MACL;MACA;MACA;;IApBO;EARF,CADiB;EAiC1BC,SAAS,EAAE,OAjCe;EAkC1BC,aAAa,EAAE,QAlCW;EAmC1BC,SAAS,EAAE,SAASA,SAAT,CAAmBC,GAAnB,EAAwBC,KAAxB,EAA+B;IACxC,IAAIJ,SAAS,GAAG,KAAKA,SAArB;IACA,IAAIf,KAAK,GAAG,KAAKoB,aAAL,CAAmBF,GAAnB,CAAZ;IACA,OAAOlB,KAAK,CAACqB,IAAb;IACA,IAAIC,KAAK,GAAGH,KAAK,CAACI,QAAN,CAAeR,SAAf,EAA0B;MACpCS,KAAK,EAAExB,KAD6B;MAEpCyB,SAAS,EAAE,GAAGC,MAAH,CAAU,KAAKrB,IAAf,EAAqB,WAArB,CAFyB;MAGpCsB,IAAI,EAAE,GAAGD,MAAH,CAAU,KAAKrB,IAAf,EAAqB,WAArB,CAH8B;MAIpCuB,SAAS,EAAE;IAJyB,CAA1B,CAAZ;IAMA,KAAKC,QAAL,CAAcX,GAAd,EAAmBI,KAAnB;IACA,OAAOA,KAAP;EACD,CA/CyB;EAgD1BO,QAAQ,EAAE,SAASA,QAAT,CAAkBX,GAAlB,EAAuBI,KAAvB,EAA8B;IACtC,IAAIQ,IAAI,GAAG,CAAC,KAAKC,UAAL,IAAmB,KAAKC,UAAL,CAAgBd,GAAhB,CAApB,EAA0Cf,OAArD;;IAEA,IAAI,CAAC2B,IAAI,CAAC1B,IAAV,EAAgB;MACd;IACD,CALqC,CAKpC;;;IAGF,IAAIC,IAAI,GAAGyB,IAAI,CAACzB,IAAhB;IAAA,IACIQ,CAAC,GAAGiB,IAAI,CAACjB,CADb;IAAA,IAEIC,CAAC,GAAGgB,IAAI,CAAChB,CAFb;IAAA,IAGId,KAAK,GAAG8B,IAAI,CAAC9B,KAHjB;;IAKA,IAAIK,IAAI,KAAK,QAAb,EAAuB;MACrB,IAAIC,CAAC,GAAGwB,IAAI,CAACxB,CAAb;MACAgB,KAAK,CAACW,OAAN,CAAc;QACZ5B,IAAI,EAAE,QADM;QAEZmB,KAAK,EAAEhC,QAAQ,CAAC;UACdc,CAAC,EAAEA,CADW;UAEdO,CAAC,EAAEA,CAFW;UAGdC,CAAC,EAAEA;QAHW,CAAD,EAIZd,KAJY;MAFH,CAAd;IAQD,CAVD,MAUO,IAAIK,IAAI,KAAK,MAAb,EAAqB;MAC1B,IAAII,KAAK,GAAGqB,IAAI,CAACrB,KAAjB;MAAA,IACIC,MAAM,GAAGoB,IAAI,CAACpB,MADlB;MAEA,IAAIwB,KAAK,GAAGrB,CAAC,GAAGJ,KAAK,GAAG,CAAxB;MACA,IAAI0B,KAAK,GAAGrB,CAAC,GAAGJ,MAAM,GAAG,CAAzB;MACAY,KAAK,CAACW,OAAN,CAAc;QACZ5B,IAAI,EAAE,MADM;QAEZmB,KAAK,EAAEhC,QAAQ,CAAC;UACdqB,CAAC,EAAEqB,KADW;UAEdpB,CAAC,EAAEqB,KAFW;UAGd1B,KAAK,EAAEA,KAHO;UAIdC,MAAM,EAAEA;QAJM,CAAD,EAKZV,KALY;MAFH,CAAd;IASD,CAdM,MAcA,IAAIK,IAAI,KAAK,SAAb,EAAwB;MAC7B,IAAIE,EAAE,GAAGuB,IAAI,CAACvB,EAAd;MAAA,IACIC,EAAE,GAAGsB,IAAI,CAACtB,EADd;MAEAc,KAAK,CAACW,OAAN,CAAc;QACZ5B,IAAI,EAAE,SADM;QAEZmB,KAAK,EAAEhC,QAAQ,CAAC;UACdqB,CAAC,EAAEA,CADW;UAEdC,CAAC,EAAEA,CAFW;UAGdP,EAAE,EAAEA,EAHU;UAIdC,EAAE,EAAEA;QAJU,CAAD,EAKZR,KALY;MAFH,CAAd;IASD,CAZM,MAYA,IAAIK,IAAI,KAAK,SAAb,EAAwB;MAC7B,IAAIM,MAAM,GAAGmB,IAAI,CAACnB,MAAlB;MACAW,KAAK,CAACW,OAAN,CAAc;QACZ5B,IAAI,EAAE,SADM;QAEZmB,KAAK,EAAEhC,QAAQ,CAAC;UACdmB,MAAM,EAAEA;QADM,CAAD,EAEZX,KAFY;MAFH,CAAd;IAMD,CARM,MAQA,IAAIK,IAAI,KAAK,MAAb,EAAqB;MAC1B,IAAIO,IAAI,GAAGkB,IAAI,CAAClB,IAAhB;MACAU,KAAK,CAACW,OAAN,CAAc;QACZ5B,IAAI,EAAE,MADM;QAEZmB,KAAK,EAAEhC,QAAQ,CAAC;UACdoB,IAAI,EAAEA;QADQ,CAAD,EAEZZ,KAFY;MAFH,CAAd;IAMD;EACF,CAlHyB;EAmH1BoB,aAAa,EAAE,SAASA,aAAT,CAAuBF,GAAvB,EAA4B;IACzC,IAAIkB,EAAE,GAAG,KAAKL,UAAL,IAAmB,KAAKC,UAAL,CAAgBd,GAAhB,CAA5B;IAAA,IACImB,YAAY,GAAGD,EAAE,CAACpC,KADtB;IAAA,IAEIH,GAAG,GAAGuC,EAAE,CAACvC,GAFb;;IAIA,IAAIC,IAAI,GAAG,KAAKwC,OAAL,CAAapB,GAAb,CAAX;IACA,IAAIT,KAAK,GAAGX,IAAI,CAAC,CAAD,CAAhB;IACA,IAAIY,MAAM,GAAGZ,IAAI,CAAC,CAAD,CAAjB;;IAEA,IAAIuC,YAAJ,EAAkB;MAChB5B,KAAK,GAAG4B,YAAY,CAAC5B,KAAb,IAAsBX,IAAI,CAAC,CAAD,CAAlC;MACAY,MAAM,GAAG2B,YAAY,CAAC3B,MAAb,IAAuBZ,IAAI,CAAC,CAAD,CAApC;IACD;;IAED,IAAIE,KAAK,GAAGR,QAAQ,CAAC;MACnBqB,CAAC,EAAE,CAACJ,KAAD,GAAS,CADO;MAEnBK,CAAC,EAAE,CAACJ,MAAD,GAAU,CAFM;MAGnBD,KAAK,EAAEA,KAHY;MAInBC,MAAM,EAAEA,MAJW;MAKnBb,GAAG,EAAEA;IALc,CAAD,EAMjBwC,YANiB,CAApB;;IAQA,OAAOrC,KAAP;EACD,CA1IyB;EA2I1BuC,gBAAgB,EAAE,SAASA,gBAAT,CAA0BrB,GAA1B,EAA+BsB,IAA/B,EAAqC;IACrD,IAAIrB,KAAK,GAAGqB,IAAI,CAACC,YAAL,EAAZ;IACA,IAAIC,cAAc,GAAG,GAAGhB,MAAH,CAAU,KAAKiB,QAAf,EAAyB,QAAzB,CAArB;IACA,IAAIrB,KAAK,GAAGH,KAAK,CAAC,UAAD,CAAL,CAAkBuB,cAAlB,KAAqCvB,KAAK,CAACyB,IAAN,CAAW,UAAUC,OAAV,EAAmB;MAC7E,OAAOA,OAAO,CAACC,GAAR,CAAY,WAAZ,MAA6BJ,cAApC;IACD,CAFgD,CAArC,IAENF,IAAI,CAACO,WAAL,EAFN;IAGA,IAAIC,UAAU,GAAG,KAAK5B,aAAL,CAAmBF,GAAnB,CAAjB;;IAEA,IAAII,KAAK,IAAI,CAACA,KAAK,CAAC2B,SAApB,EAA+B;MAC7B3B,KAAK,CAAC4B,IAAN,CAAWF,UAAX;IACD;EACF;AAtJyB,CAA5B,EAuJG,aAvJH"},"metadata":{},"sourceType":"module"}