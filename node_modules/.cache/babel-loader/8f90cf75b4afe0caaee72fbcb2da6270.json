{"ast":null,"code":"import { __assign, __extends } from \"tslib\";\n/**\n * @fileoverview 线\n * @author dxq613@gmail.com\n */\n\nimport { Line as LineUtil } from '@antv/g-math';\nimport ShapeBase from './base';\nimport inLine from '../util/in-stroke/line';\nimport * as ArrowUtil from '../util/arrow';\n\nvar Line =\n/** @class */\nfunction (_super) {\n  __extends(Line, _super);\n\n  function Line() {\n    return _super !== null && _super.apply(this, arguments) || this;\n  }\n\n  Line.prototype.getDefaultAttrs = function () {\n    var attrs = _super.prototype.getDefaultAttrs.call(this);\n\n    return __assign(__assign({}, attrs), {\n      x1: 0,\n      y1: 0,\n      x2: 0,\n      y2: 0,\n      startArrow: false,\n      endArrow: false\n    });\n  };\n\n  Line.prototype.initAttrs = function (attrs) {\n    this.setArrow();\n  }; // 更新属性时，检测是否更改了箭头\n\n\n  Line.prototype.onAttrChange = function (name, value, originValue) {\n    _super.prototype.onAttrChange.call(this, name, value, originValue); // 由于箭头的绘制依赖于 line 的诸多 attrs，因此这里不再对每个 attr 进行判断，attr 每次变化都会影响箭头的更新\n\n\n    this.setArrow();\n  };\n\n  Line.prototype.setArrow = function () {\n    var attrs = this.attr();\n    var x1 = attrs.x1,\n        y1 = attrs.y1,\n        x2 = attrs.x2,\n        y2 = attrs.y2,\n        startArrow = attrs.startArrow,\n        endArrow = attrs.endArrow;\n\n    if (startArrow) {\n      ArrowUtil.addStartArrow(this, attrs, x2, y2, x1, y1);\n    }\n\n    if (endArrow) {\n      ArrowUtil.addEndArrow(this, attrs, x1, y1, x2, y2);\n    }\n  };\n\n  Line.prototype.isInStrokeOrPath = function (x, y, isStroke, isFill, lineWidth) {\n    if (!isStroke || !lineWidth) {\n      return false;\n    }\n\n    var _a = this.attr(),\n        x1 = _a.x1,\n        y1 = _a.y1,\n        x2 = _a.x2,\n        y2 = _a.y2;\n\n    return inLine(x1, y1, x2, y2, lineWidth, x, y);\n  };\n\n  Line.prototype.createPath = function (context) {\n    var attrs = this.attr();\n    var x1 = attrs.x1,\n        y1 = attrs.y1,\n        x2 = attrs.x2,\n        y2 = attrs.y2,\n        startArrow = attrs.startArrow,\n        endArrow = attrs.endArrow;\n    var startArrowDistance = {\n      dx: 0,\n      dy: 0\n    };\n    var endArrowDistance = {\n      dx: 0,\n      dy: 0\n    };\n\n    if (startArrow && startArrow.d) {\n      startArrowDistance = ArrowUtil.getShortenOffset(x1, y1, x2, y2, attrs.startArrow.d);\n    }\n\n    if (endArrow && endArrow.d) {\n      endArrowDistance = ArrowUtil.getShortenOffset(x1, y1, x2, y2, attrs.endArrow.d);\n    }\n\n    context.beginPath(); // 如果自定义箭头，线条相应缩进\n\n    context.moveTo(x1 + startArrowDistance.dx, y1 + startArrowDistance.dy);\n    context.lineTo(x2 - endArrowDistance.dx, y2 - endArrowDistance.dy);\n  };\n\n  Line.prototype.afterDrawPath = function (context) {\n    var startArrowShape = this.get('startArrowShape');\n    var endArrowShape = this.get('endArrowShape');\n\n    if (startArrowShape) {\n      startArrowShape.draw(context);\n    }\n\n    if (endArrowShape) {\n      endArrowShape.draw(context);\n    }\n  };\n  /**\n   * Get length of line\n   * @return {number} length\n   */\n\n\n  Line.prototype.getTotalLength = function () {\n    var _a = this.attr(),\n        x1 = _a.x1,\n        y1 = _a.y1,\n        x2 = _a.x2,\n        y2 = _a.y2;\n\n    return LineUtil.length(x1, y1, x2, y2);\n  };\n  /**\n   * Get point according to ratio\n   * @param {number} ratio\n   * @return {Point} point\n   */\n\n\n  Line.prototype.getPoint = function (ratio) {\n    var _a = this.attr(),\n        x1 = _a.x1,\n        y1 = _a.y1,\n        x2 = _a.x2,\n        y2 = _a.y2;\n\n    return LineUtil.pointAt(x1, y1, x2, y2, ratio);\n  };\n\n  return Line;\n}(ShapeBase);\n\nexport default Line;","map":{"version":3,"mappings":"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","names":["Line","LineUtil","ShapeBase","inLine","ArrowUtil","__extends","attrs","_super","getDefaultAttrs","call","x1","y1","x2","y2","startArrow","endArrow","setArrow","name","value","originValue","onAttrChange","attr","addStartArrow","addEndArrow","x","y","isStroke","isFill","lineWidth","context","startArrowDistance","dx","dy","endArrowDistance","d","getShortenOffset","beginPath","moveTo","lineTo","startArrowShape","get","endArrowShape","draw","length","ratio","pointAt"],"sourceRoot":"","sources":["../../src/shape/line.ts"],"sourcesContent":[null]},"metadata":{},"sourceType":"module"}