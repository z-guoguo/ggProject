{"ast":null,"code":"\"use strict\";\n\nrequire(\"core-js/modules/es.error.cause.js\");\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.circularDependencyToException = exports.listMetadataForTarget = exports.listRegisteredBindingsForServiceIdentifier = exports.getServiceIdentifierAsString = exports.getFunctionName = void 0;\n\nvar ERROR_MSGS = require(\"../constants/error_msgs\");\n\nfunction getServiceIdentifierAsString(serviceIdentifier) {\n  if (typeof serviceIdentifier === \"function\") {\n    var _serviceIdentifier = serviceIdentifier;\n    return _serviceIdentifier.name;\n  } else if (typeof serviceIdentifier === \"symbol\") {\n    return serviceIdentifier.toString();\n  } else {\n    var _serviceIdentifier = serviceIdentifier;\n    return _serviceIdentifier;\n  }\n}\n\nexports.getServiceIdentifierAsString = getServiceIdentifierAsString;\n\nfunction listRegisteredBindingsForServiceIdentifier(container, serviceIdentifier, getBindings) {\n  var registeredBindingsList = \"\";\n  var registeredBindings = getBindings(container, serviceIdentifier);\n\n  if (registeredBindings.length !== 0) {\n    registeredBindingsList = \"\\nRegistered bindings:\";\n    registeredBindings.forEach(function (binding) {\n      var name = \"Object\";\n\n      if (binding.implementationType !== null) {\n        name = getFunctionName(binding.implementationType);\n      }\n\n      registeredBindingsList = registeredBindingsList + \"\\n \" + name;\n\n      if (binding.constraint.metaData) {\n        registeredBindingsList = registeredBindingsList + \" - \" + binding.constraint.metaData;\n      }\n    });\n  }\n\n  return registeredBindingsList;\n}\n\nexports.listRegisteredBindingsForServiceIdentifier = listRegisteredBindingsForServiceIdentifier;\n\nfunction alreadyDependencyChain(request, serviceIdentifier) {\n  if (request.parentRequest === null) {\n    return false;\n  } else if (request.parentRequest.serviceIdentifier === serviceIdentifier) {\n    return true;\n  } else {\n    return alreadyDependencyChain(request.parentRequest, serviceIdentifier);\n  }\n}\n\nfunction dependencyChainToString(request) {\n  function _createStringArr(req, result) {\n    if (result === void 0) {\n      result = [];\n    }\n\n    var serviceIdentifier = getServiceIdentifierAsString(req.serviceIdentifier);\n    result.push(serviceIdentifier);\n\n    if (req.parentRequest !== null) {\n      return _createStringArr(req.parentRequest, result);\n    }\n\n    return result;\n  }\n\n  var stringArr = _createStringArr(request);\n\n  return stringArr.reverse().join(\" --> \");\n}\n\nfunction circularDependencyToException(request) {\n  request.childRequests.forEach(function (childRequest) {\n    if (alreadyDependencyChain(childRequest, childRequest.serviceIdentifier)) {\n      var services = dependencyChainToString(childRequest);\n      throw new Error(ERROR_MSGS.CIRCULAR_DEPENDENCY + \" \" + services);\n    } else {\n      circularDependencyToException(childRequest);\n    }\n  });\n}\n\nexports.circularDependencyToException = circularDependencyToException;\n\nfunction listMetadataForTarget(serviceIdentifierString, target) {\n  if (target.isTagged() || target.isNamed()) {\n    var m_1 = \"\";\n    var namedTag = target.getNamedTag();\n    var otherTags = target.getCustomTags();\n\n    if (namedTag !== null) {\n      m_1 += namedTag.toString() + \"\\n\";\n    }\n\n    if (otherTags !== null) {\n      otherTags.forEach(function (tag) {\n        m_1 += tag.toString() + \"\\n\";\n      });\n    }\n\n    return \" \" + serviceIdentifierString + \"\\n \" + serviceIdentifierString + \" - \" + m_1;\n  } else {\n    return \" \" + serviceIdentifierString;\n  }\n}\n\nexports.listMetadataForTarget = listMetadataForTarget;\n\nfunction getFunctionName(v) {\n  if (v.name) {\n    return v.name;\n  } else {\n    var name_1 = v.toString();\n    var match = name_1.match(/^function\\s*([^\\s(]+)/);\n    return match ? match[1] : \"Anonymous function: \" + name_1;\n  }\n}\n\nexports.getFunctionName = getFunctionName;","map":{"version":3,"mappings":"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","names":["getServiceIdentifierAsString","serviceIdentifier","_serviceIdentifier","name","toString","exports","listRegisteredBindingsForServiceIdentifier","container","getBindings","registeredBindingsList","registeredBindings","length","forEach","binding","implementationType","getFunctionName","constraint","metaData","alreadyDependencyChain","request","parentRequest","dependencyChainToString","_createStringArr","req","result","push","stringArr","reverse","join","circularDependencyToException","childRequests","childRequest","services","Error","ERROR_MSGS","CIRCULAR_DEPENDENCY","listMetadataForTarget","serviceIdentifierString","target","isTagged","isNamed","m_1","namedTag","getNamedTag","otherTags","getCustomTags","tag","v","name_1","match"],"sourceRoot":"","sources":["../../src/utils/serialization.ts"],"sourcesContent":[null]},"metadata":{},"sourceType":"script"}