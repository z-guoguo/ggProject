{"ast":null,"code":"\"use strict\";\n\nrequire(\"core-js/modules/es.array.includes.js\");\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.oneHot = exports.getDistance = exports.getAllKeyValueMap = exports.default = void 0;\n\nvar _util = require(\"@antv/util\");\n\nvar _types = require(\"../types\");\n\nvar _vector = _interopRequireDefault(require(\"./vector\"));\n\nfunction _interopRequireDefault(obj) {\n  return obj && obj.__esModule ? obj : {\n    default: obj\n  };\n}\n/**\n * 获取数据中所有的属性及其对应的值\n * @param dataList 数据集\n * @param involvedKeys 参与计算的key集合\n * @param uninvolvedKeys 不参与计算的key集合\n */\n\n\nvar getAllKeyValueMap = function getAllKeyValueMap(dataList, involvedKeys, uninvolvedKeys) {\n  var keys = []; // 指定了参与计算的keys时，使用指定的keys\n\n  if (involvedKeys === null || involvedKeys === void 0 ? void 0 : involvedKeys.length) {\n    keys = involvedKeys;\n  } else {\n    // 未指定抽取的keys时，提取数据中所有的key\n    dataList.forEach(function (data) {\n      keys = keys.concat(Object.keys(data));\n    });\n    keys = (0, _util.uniq)(keys);\n  } // 获取所有值非空的key的value数组\n\n\n  var allKeyValueMap = {};\n  keys.forEach(function (key) {\n    var value = [];\n    dataList.forEach(function (data) {\n      if (data[key] !== undefined && data[key] !== '') {\n        value.push(data[key]);\n      }\n    });\n\n    if (value.length && !(uninvolvedKeys === null || uninvolvedKeys === void 0 ? void 0 : uninvolvedKeys.includes(key))) {\n      allKeyValueMap[key] = (0, _util.uniq)(value);\n    }\n  });\n  return allKeyValueMap;\n};\n/**\n * one-hot编码：数据特征提取\n * @param dataList 数据集\n * @param involvedKeys 参与计算的的key集合\n * @param uninvolvedKeys 不参与计算的key集合\n */\n\n\nexports.getAllKeyValueMap = getAllKeyValueMap;\n\nvar oneHot = function oneHot(dataList, involvedKeys, uninvolvedKeys) {\n  // 获取数据中所有的属性及其对应的值\n  var allKeyValueMap = getAllKeyValueMap(dataList, involvedKeys, uninvolvedKeys);\n  var oneHotCode = [];\n\n  if (!Object.keys(allKeyValueMap).length) {\n    return oneHotCode;\n  } // 对数据进行one-hot编码\n\n\n  dataList.forEach(function (data, index) {\n    var code = [];\n\n    if (Object.keys(allKeyValueMap).length === 1) {\n      // 如果只有一个属性且所有的属性值都能转成数值型，则直接用属性值\n      var key = Object.keys(allKeyValueMap)[0];\n      var keyValue = allKeyValueMap[key];\n\n      if (keyValue.every(function (value) {\n        return !isNaN(Number(value));\n      })) {\n        code = [data[key]];\n      }\n    } else {\n      Object.keys(allKeyValueMap).forEach(function (key) {\n        var keyValue = data[key];\n        var allKeyValue = allKeyValueMap[key];\n        var valueIndex = allKeyValue.findIndex(function (value) {\n          return keyValue === value;\n        });\n        var subCode = [];\n\n        for (var i = 0; i < allKeyValue.length; i++) {\n          if (i === valueIndex) {\n            subCode.push(1);\n          } else {\n            subCode.push(0);\n          }\n        }\n\n        code = code.concat(subCode);\n      });\n    }\n\n    oneHotCode[index] = code;\n  });\n  return oneHotCode;\n};\n/**\n * getDistance：获取两个元素之间的距离\n * @param item\n * @param otherItem\n * @param distanceType 距离类型\n * @param graphData 图数据\n */\n\n\nexports.oneHot = oneHot;\n\nvar getDistance = function getDistance(item, otherItem, distanceType, graphData) {\n  if (distanceType === void 0) {\n    distanceType = _types.DistanceType.EuclideanDistance;\n  }\n\n  var distance = 0;\n\n  switch (distanceType) {\n    case _types.DistanceType.EuclideanDistance:\n      distance = new _vector.default(item).euclideanDistance(new _vector.default(otherItem));\n      break;\n\n    default:\n      break;\n  }\n\n  return distance;\n};\n\nexports.getDistance = getDistance;\nvar _default = {\n  getAllKeyValueMap: getAllKeyValueMap,\n  oneHot: oneHot,\n  getDistance: getDistance\n};\nexports.default = _default;","map":{"version":3,"names":["Object","defineProperty","exports","value","oneHot","getDistance","getAllKeyValueMap","default","_util","require","_types","_vector","_interopRequireDefault","obj","__esModule","dataList","involvedKeys","uninvolvedKeys","keys","length","forEach","data","concat","uniq","allKeyValueMap","key","undefined","push","includes","oneHotCode","index","code","keyValue","every","isNaN","Number","allKeyValue","valueIndex","findIndex","subCode","i","item","otherItem","distanceType","graphData","DistanceType","EuclideanDistance","distance","euclideanDistance","_default"],"sources":["/Users/wawalike/Desktop/ggProject/node_modules/@antv/algorithm/lib/utils/data-preprocessing.js"],"sourcesContent":["\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.oneHot = exports.getDistance = exports.getAllKeyValueMap = exports.default = void 0;\n\nvar _util = require(\"@antv/util\");\n\nvar _types = require(\"../types\");\n\nvar _vector = _interopRequireDefault(require(\"./vector\"));\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\n/**\n * 获取数据中所有的属性及其对应的值\n * @param dataList 数据集\n * @param involvedKeys 参与计算的key集合\n * @param uninvolvedKeys 不参与计算的key集合\n */\nvar getAllKeyValueMap = function getAllKeyValueMap(dataList, involvedKeys, uninvolvedKeys) {\n  var keys = []; // 指定了参与计算的keys时，使用指定的keys\n\n  if (involvedKeys === null || involvedKeys === void 0 ? void 0 : involvedKeys.length) {\n    keys = involvedKeys;\n  } else {\n    // 未指定抽取的keys时，提取数据中所有的key\n    dataList.forEach(function (data) {\n      keys = keys.concat(Object.keys(data));\n    });\n    keys = (0, _util.uniq)(keys);\n  } // 获取所有值非空的key的value数组\n\n\n  var allKeyValueMap = {};\n  keys.forEach(function (key) {\n    var value = [];\n    dataList.forEach(function (data) {\n      if (data[key] !== undefined && data[key] !== '') {\n        value.push(data[key]);\n      }\n    });\n\n    if (value.length && !(uninvolvedKeys === null || uninvolvedKeys === void 0 ? void 0 : uninvolvedKeys.includes(key))) {\n      allKeyValueMap[key] = (0, _util.uniq)(value);\n    }\n  });\n  return allKeyValueMap;\n};\n/**\n * one-hot编码：数据特征提取\n * @param dataList 数据集\n * @param involvedKeys 参与计算的的key集合\n * @param uninvolvedKeys 不参与计算的key集合\n */\n\n\nexports.getAllKeyValueMap = getAllKeyValueMap;\n\nvar oneHot = function oneHot(dataList, involvedKeys, uninvolvedKeys) {\n  // 获取数据中所有的属性及其对应的值\n  var allKeyValueMap = getAllKeyValueMap(dataList, involvedKeys, uninvolvedKeys);\n  var oneHotCode = [];\n\n  if (!Object.keys(allKeyValueMap).length) {\n    return oneHotCode;\n  } // 对数据进行one-hot编码\n\n\n  dataList.forEach(function (data, index) {\n    var code = [];\n\n    if (Object.keys(allKeyValueMap).length === 1) {\n      // 如果只有一个属性且所有的属性值都能转成数值型，则直接用属性值\n      var key = Object.keys(allKeyValueMap)[0];\n      var keyValue = allKeyValueMap[key];\n\n      if (keyValue.every(function (value) {\n        return !isNaN(Number(value));\n      })) {\n        code = [data[key]];\n      }\n    } else {\n      Object.keys(allKeyValueMap).forEach(function (key) {\n        var keyValue = data[key];\n        var allKeyValue = allKeyValueMap[key];\n        var valueIndex = allKeyValue.findIndex(function (value) {\n          return keyValue === value;\n        });\n        var subCode = [];\n\n        for (var i = 0; i < allKeyValue.length; i++) {\n          if (i === valueIndex) {\n            subCode.push(1);\n          } else {\n            subCode.push(0);\n          }\n        }\n\n        code = code.concat(subCode);\n      });\n    }\n\n    oneHotCode[index] = code;\n  });\n  return oneHotCode;\n};\n/**\n * getDistance：获取两个元素之间的距离\n * @param item\n * @param otherItem\n * @param distanceType 距离类型\n * @param graphData 图数据\n */\n\n\nexports.oneHot = oneHot;\n\nvar getDistance = function getDistance(item, otherItem, distanceType, graphData) {\n  if (distanceType === void 0) {\n    distanceType = _types.DistanceType.EuclideanDistance;\n  }\n\n  var distance = 0;\n\n  switch (distanceType) {\n    case _types.DistanceType.EuclideanDistance:\n      distance = new _vector.default(item).euclideanDistance(new _vector.default(otherItem));\n      break;\n\n    default:\n      break;\n  }\n\n  return distance;\n};\n\nexports.getDistance = getDistance;\nvar _default = {\n  getAllKeyValueMap: getAllKeyValueMap,\n  oneHot: oneHot,\n  getDistance: getDistance\n};\nexports.default = _default;"],"mappings":"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"},"metadata":{},"sourceType":"script"}