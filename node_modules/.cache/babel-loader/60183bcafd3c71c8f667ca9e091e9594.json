{"ast":null,"code":"\"use strict\";\n\nvar __importDefault = this && this.__importDefault || function (mod) {\n  return mod && mod.__esModule ? mod : {\n    \"default\": mod\n  };\n};\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar greedy_fas_1 = __importDefault(require(\"./greedy-fas\"));\n\nvar run = function (g) {\n  var weightFn = function (g) {\n    return function (e) {\n      var _a;\n\n      return ((_a = g.edge(e)) === null || _a === void 0 ? void 0 : _a.weight) || 1;\n    };\n  };\n\n  var fas = g.graph().acyclicer === \"greedy\" ? (0, greedy_fas_1.default)(g, weightFn(g)) : dfsFAS(g);\n  fas === null || fas === void 0 ? void 0 : fas.forEach(function (e) {\n    var label = g.edge(e);\n    g.removeEdgeObj(e);\n    label.forwardName = e.name;\n    label.reversed = true;\n    g.setEdge(e.w, e.v, label, \"rev-\".concat(Math.random()));\n  });\n};\n\nvar dfsFAS = function (g) {\n  var fas = [];\n  var stack = {};\n  var visited = {};\n\n  var dfs = function (v) {\n    var _a;\n\n    if (visited[v]) {\n      return;\n    }\n\n    visited[v] = true;\n    stack[v] = true;\n    (_a = g.outEdges(v)) === null || _a === void 0 ? void 0 : _a.forEach(function (e) {\n      if (stack[e.w]) {\n        fas.push(e);\n      } else {\n        dfs(e.w);\n      }\n    });\n    delete stack[v];\n  };\n\n  g.nodes().forEach(dfs);\n  return fas;\n};\n\nvar undo = function (g) {\n  g.edges().forEach(function (e) {\n    var label = g.edge(e);\n\n    if (label.reversed) {\n      g.removeEdgeObj(e);\n      var forwardName = label.forwardName;\n      delete label.reversed;\n      delete label.forwardName;\n      g.setEdge(e.w, e.v, label, forwardName);\n    }\n  });\n};\n\nexports.default = {\n  run: run,\n  undo: undo\n};","map":{"version":3,"mappings":";;;;;;;;;;;;AACA;;AAEA,IAAMA,GAAG,GAAG,UAACC,CAAD,EAAS;EACnB,IAAMC,QAAQ,GAAG,UAACD,CAAD,EAAS;IACxB,OAAO,UAACE,CAAD,EAAQ;MAAA;;MAAK,eAAC,CAACC,IAAF,CAAOD,CAAP,OAAS,IAAT,IAASE,aAAT,GAAS,MAAT,GAASA,GAAEC,MAAX,KAAqB,CAArB;IAAsB,CAA1C;EACD,CAFD;;EAGA,IAAMC,GAAG,GACPN,CAAC,CAACO,KAAF,GAAUC,SAAV,KAAwB,QAAxB,GAAmC,0BAAUR,CAAV,EAAaC,QAAQ,CAACD,CAAD,CAArB,CAAnC,GAA+DS,MAAM,CAACT,CAAD,CADvE;EAEAM,GAAG,SAAH,OAAG,WAAH,GAAG,MAAH,MAAG,CAAEI,OAAL,CAAa,UAACR,CAAD,EAAQ;IACnB,IAAMS,KAAK,GAAGX,CAAC,CAACG,IAAF,CAAOD,CAAP,CAAd;IACAF,CAAC,CAACY,aAAF,CAAgBV,CAAhB;IACAS,KAAK,CAACE,WAAN,GAAoBX,CAAC,CAACY,IAAtB;IACAH,KAAK,CAACI,QAAN,GAAiB,IAAjB;IACAf,CAAC,CAACgB,OAAF,CAAUd,CAAC,CAACe,CAAZ,EAAef,CAAC,CAACgB,CAAjB,EAAoBP,KAApB,EAA2B,cAAOQ,IAAI,CAACC,MAAL,EAAP,CAA3B;EACD,CAND;AAOD,CAbD;;AAeA,IAAMX,MAAM,GAAG,UAACT,CAAD,EAAS;EACtB,IAAMM,GAAG,GAAW,EAApB;EACA,IAAMe,KAAK,GAA4B,EAAvC;EACA,IAAMC,OAAO,GAA4B,EAAzC;;EAEA,IAAMC,GAAG,GAAG,UAACL,CAAD,EAAU;;;IACpB,IAAII,OAAO,CAACJ,CAAD,CAAX,EAAgB;MACd;IACD;;IACDI,OAAO,CAACJ,CAAD,CAAP,GAAa,IAAb;IACAG,KAAK,CAACH,CAAD,CAAL,GAAW,IAAX;IACA,OAAC,CAACM,QAAF,CAAWN,CAAX,OAAa,IAAb,IAAad,aAAb,GAAa,MAAb,GAAaA,GAAEM,OAAF,CAAU,UAACR,CAAD,EAAE;MACvB,IAAImB,KAAK,CAACnB,CAAC,CAACe,CAAH,CAAT,EAAgB;QACdX,GAAG,CAACmB,IAAJ,CAASvB,CAAT;MACD,CAFD,MAEO;QACLqB,GAAG,CAACrB,CAAC,CAACe,CAAH,CAAH;MACD;IACF,CANY,CAAb;IAOA,OAAOI,KAAK,CAACH,CAAD,CAAZ;EACD,CAdD;;EAgBAlB,CAAC,CAAC0B,KAAF,GAAUhB,OAAV,CAAkBa,GAAlB;EACA,OAAOjB,GAAP;AACD,CAvBD;;AAyBA,IAAMqB,IAAI,GAAG,UAAC3B,CAAD,EAAS;EACpBA,CAAC,CAAC4B,KAAF,GAAUlB,OAAV,CAAkB,UAACR,CAAD,EAAE;IAClB,IAAMS,KAAK,GAAGX,CAAC,CAACG,IAAF,CAAOD,CAAP,CAAd;;IACA,IAAIS,KAAK,CAACI,QAAV,EAAoB;MAClBf,CAAC,CAACY,aAAF,CAAgBV,CAAhB;MAEA,IAAMW,WAAW,GAAGF,KAAK,CAACE,WAA1B;MACA,OAAOF,KAAK,CAACI,QAAb;MACA,OAAOJ,KAAK,CAACE,WAAb;MACAb,CAAC,CAACgB,OAAF,CAAUd,CAAC,CAACe,CAAZ,EAAef,CAAC,CAACgB,CAAjB,EAAoBP,KAApB,EAA2BE,WAA3B;IACD;EACF,CAVD;AAWD,CAZD;;AAcAgB,kBAAe;EAAE9B,GAAG,KAAL;EAAO4B,IAAI;AAAX,CAAf","names":["run","g","weightFn","e","edge","_a","weight","fas","graph","acyclicer","dfsFAS","forEach","label","removeEdgeObj","forwardName","name","reversed","setEdge","w","v","Math","random","stack","visited","dfs","outEdges","push","nodes","undo","edges","exports"],"sourceRoot":"","sources":["../../../../src/layout/dagre/src/acyclic.ts"],"sourcesContent":[null]},"metadata":{},"sourceType":"script"}