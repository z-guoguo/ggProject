{"ast":null,"code":"import { __assign, __extends } from \"tslib\";\nimport { each, isArray, isObject } from '@antv/util';\nimport { SVG_ATTR_MAP } from '../constant';\nimport ShapeBase from './base';\n\nvar Path =\n/** @class */\nfunction (_super) {\n  __extends(Path, _super);\n\n  function Path() {\n    var _this = _super !== null && _super.apply(this, arguments) || this;\n\n    _this.type = 'path';\n    _this.canFill = true;\n    _this.canStroke = true;\n    return _this;\n  }\n\n  Path.prototype.getDefaultAttrs = function () {\n    var attrs = _super.prototype.getDefaultAttrs.call(this);\n\n    return __assign(__assign({}, attrs), {\n      startArrow: false,\n      endArrow: false\n    });\n  };\n\n  Path.prototype.createPath = function (context, targetAttrs) {\n    var _this = this;\n\n    var attrs = this.attr();\n    var el = this.get('el');\n    each(targetAttrs || attrs, function (value, attr) {\n      if (attr === 'path' && isArray(value)) {\n        el.setAttribute('d', _this._formatPath(value));\n      } else if (attr === 'startArrow' || attr === 'endArrow') {\n        if (value) {\n          var id = isObject(value) ? context.addArrow(attrs, SVG_ATTR_MAP[attr]) : context.getDefaultArrow(attrs, SVG_ATTR_MAP[attr]);\n          el.setAttribute(SVG_ATTR_MAP[attr], \"url(#\" + id + \")\");\n        } else {\n          el.removeAttribute(SVG_ATTR_MAP[attr]);\n        }\n      } else if (SVG_ATTR_MAP[attr]) {\n        el.setAttribute(SVG_ATTR_MAP[attr], value);\n      }\n    });\n  };\n\n  Path.prototype._formatPath = function (value) {\n    var newValue = value.map(function (path) {\n      return path.join(' ');\n    }).join('');\n\n    if (~newValue.indexOf('NaN')) {\n      return '';\n    }\n\n    return newValue;\n  };\n  /**\n   * Get total length of path\n   * 尽管通过浏览器的 SVGPathElement.getTotalLength() 接口获取的 path 长度，\n   * 与 Canvas 版本通过数学计算的方式得到的长度有一些细微差异，但最大误差在个位数像素，精度上可以能接受\n   * @return {number} length\n   */\n\n\n  Path.prototype.getTotalLength = function () {\n    var el = this.get('el');\n    return el ? el.getTotalLength() : null;\n  };\n  /**\n   * Get point according to ratio\n   * @param {number} ratio\n   * @return {Point} point\n   */\n\n\n  Path.prototype.getPoint = function (ratio) {\n    var el = this.get('el');\n    var totalLength = this.getTotalLength(); // @see https://github.com/antvis/g/issues/634\n\n    if (totalLength === 0) {\n      return null;\n    }\n\n    var point = el ? el.getPointAtLength(ratio * totalLength) : null;\n    return point ? {\n      x: point.x,\n      y: point.y\n    } : null;\n  };\n\n  return Path;\n}(ShapeBase);\n\nexport default Path;","map":{"version":3,"mappings":"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","names":["each","isArray","isObject","SVG_ATTR_MAP","ShapeBase","__extends","_this","Path","attrs","_super","getDefaultAttrs","call","startArrow","endArrow","context","targetAttrs","attr","el","get","value","setAttribute","_formatPath","id","addArrow","getDefaultArrow","removeAttribute","newValue","map","path","join","indexOf","getTotalLength","ratio","totalLength","point","getPointAtLength","x","y"],"sourceRoot":"","sources":["../../src/shape/path.ts"],"sourcesContent":[null]},"metadata":{},"sourceType":"module"}