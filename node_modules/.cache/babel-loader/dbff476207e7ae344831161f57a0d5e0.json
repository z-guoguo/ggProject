{"ast":null,"code":"import \"core-js/modules/es.error.cause.js\";\nimport { __extends } from \"tslib\";\nimport { each, isDate, isNil, isNumber, isString } from '@antv/util';\nimport { timeFormat, toTimeStamp } from '../util/time';\nimport Linear from './linear';\n/**\n * 时间度量\n * @class\n */\n\nvar Time =\n/** @class */\nfunction (_super) {\n  __extends(Time, _super);\n\n  function Time() {\n    var _this = _super !== null && _super.apply(this, arguments) || this;\n\n    _this.type = 'time';\n    return _this;\n  }\n  /**\n   * @override\n   */\n\n\n  Time.prototype.getText = function (value, index) {\n    var numberValue = this.translate(value);\n    var formatter = this.formatter;\n    return formatter ? formatter(numberValue, index) : timeFormat(numberValue, this.mask);\n  };\n  /**\n   * @override\n   */\n\n\n  Time.prototype.scale = function (value) {\n    var v = value;\n\n    if (isString(v) || isDate(v)) {\n      v = this.translate(v);\n    }\n\n    return _super.prototype.scale.call(this, v);\n  };\n  /**\n   * 将时间转换成数字\n   * @override\n   */\n\n\n  Time.prototype.translate = function (v) {\n    return toTimeStamp(v);\n  };\n\n  Time.prototype.initCfg = function () {\n    this.tickMethod = 'time-pretty';\n    this.mask = 'YYYY-MM-DD';\n    this.tickCount = 7;\n    this.nice = false;\n  };\n\n  Time.prototype.setDomain = function () {\n    var values = this.values; // 是否设置了 min, max，而不是直接取 this.min, this.max\n\n    var minConfig = this.getConfig('min');\n    var maxConfig = this.getConfig('max'); // 如果设置了 min,max 则转换成时间戳\n\n    if (!isNil(minConfig) || !isNumber(minConfig)) {\n      this.min = this.translate(this.min);\n    }\n\n    if (!isNil(maxConfig) || !isNumber(maxConfig)) {\n      this.max = this.translate(this.max);\n    } // 没有设置 min, max 时\n\n\n    if (values && values.length) {\n      // 重新计算最大最小值\n      var timeStamps_1 = [];\n      var min_1 = Infinity; // 最小值\n\n      var secondMin_1 = min_1; // 次小值\n\n      var max_1 = 0; // 使用一个循环，计算min,max,secondMin\n\n      each(values, function (v) {\n        var timeStamp = toTimeStamp(v);\n\n        if (isNaN(timeStamp)) {\n          throw new TypeError(\"Invalid Time: \" + v + \" in time scale!\");\n        }\n\n        if (min_1 > timeStamp) {\n          secondMin_1 = min_1;\n          min_1 = timeStamp;\n        } else if (secondMin_1 > timeStamp) {\n          secondMin_1 = timeStamp;\n        }\n\n        if (max_1 < timeStamp) {\n          max_1 = timeStamp;\n        }\n\n        timeStamps_1.push(timeStamp);\n      }); // 存在多个值时，设置最小间距\n\n      if (values.length > 1) {\n        this.minTickInterval = secondMin_1 - min_1;\n      }\n\n      if (isNil(minConfig)) {\n        this.min = min_1;\n      }\n\n      if (isNil(maxConfig)) {\n        this.max = max_1;\n      }\n    }\n  };\n\n  return Time;\n}(Linear);\n\nexport default Time;","map":{"version":3,"mappings":"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","names":["each","isDate","isNil","isNumber","isString","timeFormat","toTimeStamp","Linear","__extends","_this","Time","value","index","numberValue","translate","formatter","mask","v","_super","scale","call","tickMethod","tickCount","nice","values","minConfig","getConfig","maxConfig","min","max","length","timeStamps_1","min_1","Infinity","secondMin_1","max_1","timeStamp","isNaN","TypeError","push","minTickInterval"],"sourceRoot":"","sources":["../../src/continuous/time.ts"],"sourcesContent":[null]},"metadata":{},"sourceType":"module"}