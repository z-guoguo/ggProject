{"ast":null,"code":"import { Dictionary } from '../common';\nimport { Dom } from '../util';\nexport class Cache {\n  constructor(view) {\n    this.view = view;\n    this.clean();\n  }\n\n  clean() {\n    if (this.elemCache) {\n      this.elemCache.dispose();\n    }\n\n    this.elemCache = new Dictionary();\n    this.pathCache = {};\n  }\n\n  get(elem) {\n    const cache = this.elemCache;\n\n    if (!cache.has(elem)) {\n      this.elemCache.set(elem, {});\n    }\n\n    return this.elemCache.get(elem);\n  }\n\n  getData(elem) {\n    const meta = this.get(elem);\n\n    if (!meta.data) {\n      meta.data = {};\n    }\n\n    return meta.data;\n  }\n\n  getMatrix(elem) {\n    const meta = this.get(elem);\n\n    if (meta.matrix == null) {\n      const target = this.view.rotatableNode || this.view.container;\n      meta.matrix = Dom.getTransformToElement(elem, target);\n    }\n\n    return Dom.createSVGMatrix(meta.matrix);\n  }\n\n  getShape(elem) {\n    const meta = this.get(elem);\n\n    if (meta.shape == null) {\n      meta.shape = Dom.toGeometryShape(elem);\n    }\n\n    return meta.shape.clone();\n  }\n\n  getBoundingRect(elem) {\n    const meta = this.get(elem);\n\n    if (meta.boundingRect == null) {\n      meta.boundingRect = Dom.getBBox(elem);\n    }\n\n    return meta.boundingRect.clone();\n  }\n\n}","map":{"version":3,"mappings":"AAAA,SAASA,UAAT,QAA2B,WAA3B;AACA,SAAqBC,GAArB,QAAgC,SAAhC;AAIA,OAAM,MAAOC,KAAP,CAAY;EAShBC,YAAsBC,IAAtB,EAAoC;IAAd;IACpB,KAAKC,KAAL;EACD;;EAEDA,KAAK;IACH,IAAI,KAAKC,SAAT,EAAoB;MAClB,KAAKA,SAAL,CAAeC,OAAf;IACD;;IACD,KAAKD,SAAL,GAAiB,IAAIN,UAAJ,EAAjB;IACA,KAAKQ,SAAL,GAAiB,EAAjB;EACD;;EAEDC,GAAG,CAACC,IAAD,EAAc;IACf,MAAMC,KAAK,GAAG,KAAKL,SAAnB;;IACA,IAAI,CAACK,KAAK,CAACC,GAAN,CAAUF,IAAV,CAAL,EAAsB;MACpB,KAAKJ,SAAL,CAAeO,GAAf,CAAmBH,IAAnB,EAAyB,EAAzB;IACD;;IACD,OAAO,KAAKJ,SAAL,CAAeG,GAAf,CAAmBC,IAAnB,CAAP;EACD;;EAEDI,OAAO,CAACJ,IAAD,EAAc;IACnB,MAAMK,IAAI,GAAG,KAAKN,GAAL,CAASC,IAAT,CAAb;;IACA,IAAI,CAACK,IAAI,CAACC,IAAV,EAAgB;MACdD,IAAI,CAACC,IAAL,GAAY,EAAZ;IACD;;IACD,OAAOD,IAAI,CAACC,IAAZ;EACD;;EAEDC,SAAS,CAACP,IAAD,EAAc;IACrB,MAAMK,IAAI,GAAG,KAAKN,GAAL,CAASC,IAAT,CAAb;;IACA,IAAIK,IAAI,CAACG,MAAL,IAAe,IAAnB,EAAyB;MACvB,MAAMC,MAAM,GAAG,KAAKf,IAAL,CAAUgB,aAAV,IAA2B,KAAKhB,IAAL,CAAUiB,SAApD;MACAN,IAAI,CAACG,MAAL,GAAcjB,GAAG,CAACqB,qBAAJ,CAA0BZ,IAA1B,EAAuCS,MAAvC,CAAd;IACD;;IAED,OAAOlB,GAAG,CAACsB,eAAJ,CAAoBR,IAAI,CAACG,MAAzB,CAAP;EACD;;EAEDM,QAAQ,CAACd,IAAD,EAAc;IACpB,MAAMK,IAAI,GAAG,KAAKN,GAAL,CAASC,IAAT,CAAb;;IACA,IAAIK,IAAI,CAACU,KAAL,IAAc,IAAlB,EAAwB;MACtBV,IAAI,CAACU,KAAL,GAAaxB,GAAG,CAACyB,eAAJ,CAAoBhB,IAApB,CAAb;IACD;;IACD,OAAOK,IAAI,CAACU,KAAL,CAAWE,KAAX,EAAP;EACD;;EAEDC,eAAe,CAAClB,IAAD,EAAc;IAC3B,MAAMK,IAAI,GAAG,KAAKN,GAAL,CAASC,IAAT,CAAb;;IACA,IAAIK,IAAI,CAACc,YAAL,IAAqB,IAAzB,EAA+B;MAC7Bd,IAAI,CAACc,YAAL,GAAoB5B,GAAG,CAAC6B,OAAJ,CAAYpB,IAAZ,CAApB;IACD;;IACD,OAAOK,IAAI,CAACc,YAAL,CAAkBF,KAAlB,EAAP;EACD;;AA7De","names":["Dictionary","Dom","Cache","constructor","view","clean","elemCache","dispose","pathCache","get","elem","cache","has","set","getData","meta","data","getMatrix","matrix","target","rotatableNode","container","getTransformToElement","createSVGMatrix","getShape","shape","toGeometryShape","clone","getBoundingRect","boundingRect","getBBox"],"sourceRoot":"","sources":["../../src/view/cache.ts"],"sourcesContent":[null]},"metadata":{},"sourceType":"module"}