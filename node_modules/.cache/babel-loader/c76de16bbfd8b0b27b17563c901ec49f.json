{"ast":null,"code":"/**\n * @fileoverview 矩形\n * @author dxq613@gmail.com\n */\nimport { __assign, __extends } from \"tslib\";\nimport ShapeBase from './base';\nimport { parseRadius } from '../util/parse';\nimport { inBox } from '../util/util';\nimport inRect from '../util/in-stroke/rect';\nimport inRectWithRadius from '../util/in-stroke/rect-radius';\nimport isPointInPath from '../util/in-path/point-in-path';\n\nvar Rect =\n/** @class */\nfunction (_super) {\n  __extends(Rect, _super);\n\n  function Rect() {\n    return _super !== null && _super.apply(this, arguments) || this;\n  }\n\n  Rect.prototype.getDefaultAttrs = function () {\n    var attrs = _super.prototype.getDefaultAttrs.call(this);\n\n    return __assign(__assign({}, attrs), {\n      x: 0,\n      y: 0,\n      width: 0,\n      height: 0,\n      radius: 0\n    });\n  };\n\n  Rect.prototype.isInStrokeOrPath = function (x, y, isStroke, isFill, lineWidth) {\n    var attrs = this.attr();\n    var minX = attrs.x;\n    var minY = attrs.y;\n    var width = attrs.width;\n    var height = attrs.height;\n    var radius = attrs.radius; // 无圆角时的策略\n\n    if (!radius) {\n      var halfWidth = lineWidth / 2; // 同时填充和带有边框\n\n      if (isFill && isStroke) {\n        return inBox(minX - halfWidth, minY - halfWidth, width + halfWidth, height + halfWidth, x, y);\n      } // 仅填充\n\n\n      if (isFill) {\n        return inBox(minX, minY, width, height, x, y);\n      }\n\n      if (isStroke) {\n        return inRect(minX, minY, width, height, lineWidth, x, y);\n      }\n    } else {\n      var isHit = false;\n\n      if (isStroke) {\n        isHit = inRectWithRadius(minX, minY, width, height, radius, lineWidth, x, y);\n      } // 仅填充时带有圆角的矩形直接通过图形拾取\n      // 以后可以改成纯数学的近似拾取，将圆弧切割成多边形\n\n\n      if (!isHit && isFill) {\n        isHit = isPointInPath(this, x, y);\n      }\n\n      return isHit;\n    }\n  };\n\n  Rect.prototype.createPath = function (context) {\n    var attrs = this.attr();\n    var x = attrs.x;\n    var y = attrs.y;\n    var width = attrs.width;\n    var height = attrs.height;\n    var radius = attrs.radius;\n    context.beginPath();\n\n    if (radius === 0) {\n      // 改成原生的rect方法\n      context.rect(x, y, width, height);\n    } else {\n      var _a = parseRadius(radius),\n          r1 = _a[0],\n          r2 = _a[1],\n          r3 = _a[2],\n          r4 = _a[3];\n\n      context.moveTo(x + r1, y);\n      context.lineTo(x + width - r2, y);\n      r2 !== 0 && context.arc(x + width - r2, y + r2, r2, -Math.PI / 2, 0);\n      context.lineTo(x + width, y + height - r3);\n      r3 !== 0 && context.arc(x + width - r3, y + height - r3, r3, 0, Math.PI / 2);\n      context.lineTo(x + r4, y + height);\n      r4 !== 0 && context.arc(x + r4, y + height - r4, r4, Math.PI / 2, Math.PI);\n      context.lineTo(x, y + r1);\n      r1 !== 0 && context.arc(x + r1, y + r1, r1, Math.PI, Math.PI * 1.5);\n      context.closePath();\n    }\n  };\n\n  return Rect;\n}(ShapeBase);\n\nexport default Rect;","map":{"version":3,"mappings":"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","names":["ShapeBase","parseRadius","inBox","inRect","inRectWithRadius","isPointInPath","__extends","Rect","attrs","_super","getDefaultAttrs","call","x","y","width","height","radius","isStroke","isFill","lineWidth","attr","minX","minY","halfWidth","isHit","context","beginPath","rect","r1","r2","r3","r4","moveTo","lineTo","arc","Math","PI","closePath"],"sourceRoot":"","sources":["../../src/shape/rect.ts"],"sourcesContent":[null]},"metadata":{},"sourceType":"module"}