{"ast":null,"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar util_1 = require(\"../util\");\n\nvar bk_1 = require(\"./bk\");\n\nvar positionY = function (g) {\n  var layering = (0, util_1.buildLayerMatrix)(g);\n  var rankSep = g.graph().ranksep;\n  var prevY = 0;\n  layering === null || layering === void 0 ? void 0 : layering.forEach(function (layer) {\n    var heights = layer.map(function (v) {\n      return g.node(v).height;\n    });\n    var maxHeight = Math.max.apply(Math, heights);\n    layer === null || layer === void 0 ? void 0 : layer.forEach(function (v) {\n      g.node(v).y = prevY + maxHeight / 2;\n    });\n    prevY += maxHeight + rankSep;\n  });\n};\n\nvar positionX = function (g) {\n  var layering = (0, util_1.buildLayerMatrix)(g);\n  var conflicts = Object.assign((0, bk_1.findType1Conflicts)(g, layering), (0, bk_1.findType2Conflicts)(g, layering));\n  var xss = {};\n  var adjustedLayering = [];\n  [\"u\", \"d\"].forEach(function (vert) {\n    adjustedLayering = vert === \"u\" ? layering : Object.values(layering).reverse();\n    [\"l\", \"r\"].forEach(function (horiz) {\n      if (horiz === \"r\") {\n        adjustedLayering = adjustedLayering.map(function (inner) {\n          return Object.values(inner).reverse();\n        });\n      }\n\n      var neighborFn = (vert === \"u\" ? g.predecessors : g.successors).bind(g);\n      var align = (0, bk_1.verticalAlignment)(g, adjustedLayering, conflicts, neighborFn);\n      var xs = (0, bk_1.horizontalCompaction)(g, adjustedLayering, align.root, align.align, horiz === \"r\");\n\n      if (horiz === \"r\") {\n        Object.keys(xs).forEach(function (xsKey) {\n          return xs[xsKey] = -xs[xsKey];\n        });\n      }\n\n      xss[vert + horiz] = xs;\n    });\n  });\n  var smallestWidth = (0, bk_1.findSmallestWidthAlignment)(g, xss);\n  smallestWidth && (0, bk_1.alignCoordinates)(xss, smallestWidth);\n  return (0, bk_1.balance)(xss, g.graph().align);\n};\n\nvar position = function (g) {\n  var _a;\n\n  var ng = (0, util_1.asNonCompoundGraph)(g);\n  positionY(ng);\n  var xs = positionX(ng);\n  (_a = Object.keys(xs)) === null || _a === void 0 ? void 0 : _a.forEach(function (key) {\n    ng.node(key).x = xs[key];\n  });\n};\n\nexports.default = position;","map":{"version":3,"mappings":"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","names":["positionY","g","layering","rankSep","graph","ranksep","prevY","forEach","layer","heights","map","v","node","height","maxHeight","Math","max","apply","y","positionX","conflicts","Object","assign","xss","adjustedLayering","vert","values","reverse","horiz","inner","neighborFn","predecessors","successors","bind","align","xs","root","keys","xsKey","smallestWidth","position","ng","_a","key","x","exports"],"sourceRoot":"","sources":["../../../../../src/layout/dagre/src/position/index.ts"],"sourcesContent":[null]},"metadata":{},"sourceType":"script"}