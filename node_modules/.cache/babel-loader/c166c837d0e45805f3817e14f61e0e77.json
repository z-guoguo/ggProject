{"ast":null,"code":"import { Dom, FunctionExt } from '../../util';\nimport { Point } from '../../geometry';\nimport { ToolsView } from '../../view/tool';\nimport * as Util from './util';\n\nclass Anchor extends ToolsView.ToolItem {\n  get type() {\n    return this.options.type;\n  }\n\n  onRender() {\n    Dom.addClass(this.container, this.prefixClassName(`edge-tool-${this.type}-anchor`));\n    this.toggleArea(false);\n    this.update();\n  }\n\n  update() {\n    const type = this.type;\n    const edgeView = this.cellView;\n    const terminalView = edgeView.getTerminalView(type);\n\n    if (terminalView) {\n      this.updateAnchor();\n      this.updateArea();\n      this.container.style.display = '';\n    } else {\n      this.container.style.display = 'none';\n    }\n\n    return this;\n  }\n\n  updateAnchor() {\n    const childNodes = this.childNodes;\n\n    if (!childNodes) {\n      return;\n    }\n\n    const anchorNode = childNodes.anchor;\n\n    if (!anchorNode) {\n      return;\n    }\n\n    const type = this.type;\n    const edgeView = this.cellView;\n    const options = this.options;\n    const position = edgeView.getTerminalAnchor(type);\n    const customAnchor = edgeView.cell.prop([type, 'anchor']);\n    anchorNode.setAttribute('transform', `translate(${position.x}, ${position.y})`);\n    const anchorAttrs = customAnchor ? options.customAnchorAttrs : options.defaultAnchorAttrs;\n\n    if (anchorAttrs) {\n      Object.keys(anchorAttrs).forEach(attrName => {\n        anchorNode.setAttribute(attrName, anchorAttrs[attrName]);\n      });\n    }\n  }\n\n  updateArea() {\n    const childNodes = this.childNodes;\n\n    if (!childNodes) {\n      return;\n    }\n\n    const areaNode = childNodes.area;\n\n    if (!areaNode) {\n      return;\n    }\n\n    const type = this.type;\n    const edgeView = this.cellView;\n    const terminalView = edgeView.getTerminalView(type);\n\n    if (terminalView) {\n      const terminalCell = terminalView.cell;\n      const magnet = edgeView.getTerminalMagnet(type);\n      let padding = this.options.areaPadding || 0;\n\n      if (!Number.isFinite(padding)) {\n        padding = 0;\n      }\n\n      let bbox;\n      let angle;\n      let center;\n\n      if (terminalView.isEdgeElement(magnet)) {\n        bbox = terminalView.getBBox();\n        angle = 0;\n        center = bbox.getCenter();\n      } else {\n        bbox = terminalView.getUnrotatedBBoxOfElement(magnet);\n        angle = terminalCell.getAngle();\n        center = bbox.getCenter();\n\n        if (angle) {\n          center.rotate(-angle, terminalCell.getBBox().getCenter());\n        }\n      }\n\n      bbox.inflate(padding);\n      Dom.attr(areaNode, {\n        x: -bbox.width / 2,\n        y: -bbox.height / 2,\n        width: bbox.width,\n        height: bbox.height,\n        transform: `translate(${center.x}, ${center.y}) rotate(${angle})`\n      });\n    }\n  }\n\n  toggleArea(visible) {\n    if (this.childNodes) {\n      const elem = this.childNodes.area;\n\n      if (elem) {\n        elem.style.display = visible ? '' : 'none';\n      }\n    }\n  }\n\n  onMouseDown(evt) {\n    if (this.guard(evt)) {\n      return;\n    }\n\n    evt.stopPropagation();\n    evt.preventDefault();\n    this.graph.view.undelegateEvents();\n\n    if (this.options.documentEvents) {\n      this.delegateDocumentEvents(this.options.documentEvents);\n    }\n\n    this.focus();\n    this.toggleArea(this.options.restrictArea);\n    this.cell.startBatch('move-anchor', {\n      ui: true,\n      toolId: this.cid\n    });\n  }\n\n  resetAnchor(anchor) {\n    const type = this.type;\n    const cell = this.cell;\n\n    if (anchor) {\n      cell.prop([type, 'anchor'], anchor, {\n        rewrite: true,\n        ui: true,\n        toolId: this.cid\n      });\n    } else {\n      cell.removeProp([type, 'anchor'], {\n        ui: true,\n        toolId: this.cid\n      });\n    }\n  }\n\n  onMouseMove(evt) {\n    const terminalType = this.type;\n    const edgeView = this.cellView;\n    const terminalView = edgeView.getTerminalView(terminalType);\n\n    if (terminalView == null) {\n      return;\n    }\n\n    const e = this.normalizeEvent(evt);\n    const terminalCell = terminalView.cell;\n    const terminalMagnet = edgeView.getTerminalMagnet(terminalType);\n    let coords = this.graph.clientToLocal(e.clientX, e.clientY);\n    const snapFn = this.options.snap;\n\n    if (typeof snapFn === 'function') {\n      const tmp = FunctionExt.call(snapFn, edgeView, coords, terminalView, terminalMagnet, terminalType, edgeView, this);\n      coords = Point.create(tmp);\n    }\n\n    if (this.options.restrictArea) {\n      if (terminalView.isEdgeElement(terminalMagnet)) {\n        const pointAtConnection = terminalView.getClosestPoint(coords);\n\n        if (pointAtConnection) {\n          coords = pointAtConnection;\n        }\n      } else {\n        const bbox = terminalView.getUnrotatedBBoxOfElement(terminalMagnet);\n        const angle = terminalCell.getAngle();\n        const origin = terminalCell.getBBox().getCenter();\n        const rotatedCoords = coords.clone().rotate(angle, origin);\n\n        if (!bbox.containsPoint(rotatedCoords)) {\n          coords = bbox.getNearestPointToPoint(rotatedCoords).rotate(-angle, origin);\n        }\n      }\n    }\n\n    let anchor;\n    const anchorFn = this.options.anchor;\n\n    if (typeof anchorFn === 'function') {\n      anchor = FunctionExt.call(anchorFn, edgeView, coords, terminalView, terminalMagnet, terminalType, edgeView, this);\n    }\n\n    this.resetAnchor(anchor);\n    this.update();\n  } // eslint-disable-next-line @typescript-eslint/no-unused-vars\n\n\n  onMouseUp(evt) {\n    this.graph.view.delegateEvents();\n    this.undelegateDocumentEvents();\n    this.blur();\n    this.toggleArea(false);\n    const edgeView = this.cellView;\n\n    if (this.options.removeRedundancies) {\n      edgeView.removeRedundantLinearVertices({\n        ui: true,\n        toolId: this.cid\n      });\n    }\n\n    this.cell.stopBatch('move-anchor', {\n      ui: true,\n      toolId: this.cid\n    });\n  }\n\n  onDblClick() {\n    const anchor = this.options.resetAnchor;\n\n    if (anchor) {\n      this.resetAnchor(anchor === true ? undefined : anchor);\n    }\n\n    this.update();\n  }\n\n}\n\n(function (Anchor) {\n  Anchor.config({\n    tagName: 'g',\n    markup: [{\n      tagName: 'circle',\n      selector: 'anchor',\n      attrs: {\n        cursor: 'pointer'\n      }\n    }, {\n      tagName: 'rect',\n      selector: 'area',\n      attrs: {\n        'pointer-events': 'none',\n        fill: 'none',\n        stroke: '#33334F',\n        'stroke-dasharray': '2,4',\n        rx: 5,\n        ry: 5\n      }\n    }],\n    events: {\n      mousedown: 'onMouseDown',\n      touchstart: 'onMouseDown',\n      dblclick: 'onDblClick'\n    },\n    documentEvents: {\n      mousemove: 'onMouseMove',\n      touchmove: 'onMouseMove',\n      mouseup: 'onMouseUp',\n      touchend: 'onMouseUp',\n      touchcancel: 'onMouseUp'\n    },\n    customAnchorAttrs: {\n      'stroke-width': 4,\n      stroke: '#33334F',\n      fill: '#FFFFFF',\n      r: 5\n    },\n    defaultAnchorAttrs: {\n      'stroke-width': 2,\n      stroke: '#FFFFFF',\n      fill: '#33334F',\n      r: 6\n    },\n    areaPadding: 6,\n    snapRadius: 10,\n    resetAnchor: true,\n    restrictArea: true,\n    removeRedundancies: true,\n    anchor: Util.getAnchor,\n\n    snap(pos, terminalView, terminalMagnet, terminalType, edgeView, toolView) {\n      const snapRadius = toolView.options.snapRadius || 0;\n      const isSource = terminalType === 'source';\n      const refIndex = isSource ? 0 : -1;\n      const ref = this.cell.getVertexAt(refIndex) || this.getTerminalAnchor(isSource ? 'target' : 'source');\n\n      if (ref) {\n        if (Math.abs(ref.x - pos.x) < snapRadius) pos.x = ref.x;\n        if (Math.abs(ref.y - pos.y) < snapRadius) pos.y = ref.y;\n      }\n\n      return pos;\n    }\n\n  });\n})(Anchor || (Anchor = {}));\n\nexport const SourceAnchor = Anchor.define({\n  name: 'source-anchor',\n  type: 'source'\n});\nexport const TargetAnchor = Anchor.define({\n  name: 'target-anchor',\n  type: 'target'\n});","map":{"version":3,"mappings":"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","names":["Dom","FunctionExt","Point","ToolsView","Util","Anchor","ToolItem","type","options","onRender","addClass","container","prefixClassName","toggleArea","update","edgeView","cellView","terminalView","getTerminalView","updateAnchor","updateArea","style","display","childNodes","anchorNode","anchor","position","getTerminalAnchor","customAnchor","cell","prop","setAttribute","x","y","anchorAttrs","customAnchorAttrs","defaultAnchorAttrs","Object","keys","forEach","attrName","areaNode","area","terminalCell","magnet","getTerminalMagnet","padding","areaPadding","Number","isFinite","bbox","angle","center","isEdgeElement","getBBox","getCenter","getUnrotatedBBoxOfElement","getAngle","rotate","inflate","attr","width","height","transform","visible","elem","onMouseDown","evt","guard","stopPropagation","preventDefault","graph","view","undelegateEvents","documentEvents","delegateDocumentEvents","focus","restrictArea","startBatch","ui","toolId","cid","resetAnchor","rewrite","removeProp","onMouseMove","terminalType","e","normalizeEvent","terminalMagnet","coords","clientToLocal","clientX","clientY","snapFn","snap","tmp","call","create","pointAtConnection","getClosestPoint","origin","rotatedCoords","clone","containsPoint","getNearestPointToPoint","anchorFn","onMouseUp","delegateEvents","undelegateDocumentEvents","blur","removeRedundancies","removeRedundantLinearVertices","stopBatch","onDblClick","undefined","config","tagName","markup","selector","attrs","cursor","fill","stroke","rx","ry","events","mousedown","touchstart","dblclick","mousemove","touchmove","mouseup","touchend","touchcancel","r","snapRadius","getAnchor","pos","toolView","isSource","refIndex","ref","getVertexAt","Math","abs","SourceAnchor","define","name","TargetAnchor"],"sourceRoot":"","sources":["../../../src/registry/tool/anchor.ts"],"sourcesContent":[null]},"metadata":{},"sourceType":"module"}