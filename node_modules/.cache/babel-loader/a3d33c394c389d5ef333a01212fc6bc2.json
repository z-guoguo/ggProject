{"ast":null,"code":"\"use strict\";\n/**\n * @fileOverview random layout\n * @author shiwu.wyy@antfin.com\n */\n\nrequire(\"core-js/modules/es.error.cause.js\");\n\nvar __extends = this && this.__extends || function () {\n  var extendStatics = function (d, b) {\n    extendStatics = Object.setPrototypeOf || {\n      __proto__: []\n    } instanceof Array && function (d, b) {\n      d.__proto__ = b;\n    } || function (d, b) {\n      for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p];\n    };\n\n    return extendStatics(d, b);\n  };\n\n  return function (d, b) {\n    if (typeof b !== \"function\" && b !== null) throw new TypeError(\"Class extends value \" + String(b) + \" is not a constructor or null\");\n    extendStatics(d, b);\n\n    function __() {\n      this.constructor = d;\n    }\n\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n  };\n}();\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.CircularLayout = void 0;\n\nvar base_1 = require(\"./base\");\n\nvar util_1 = require(\"../util\");\n\nfunction initHierarchy(nodes, edges, nodeMap, directed) {\n  nodes.forEach(function (_, i) {\n    nodes[i].children = [];\n    nodes[i].parent = [];\n  });\n\n  if (directed) {\n    edges.forEach(function (e) {\n      var source = (0, util_1.getEdgeTerminal)(e, 'source');\n      var target = (0, util_1.getEdgeTerminal)(e, 'target');\n      var sourceIdx = 0;\n\n      if (source) {\n        sourceIdx = nodeMap[source];\n      }\n\n      var targetIdx = 0;\n\n      if (target) {\n        targetIdx = nodeMap[target];\n      }\n\n      var child = nodes[sourceIdx].children;\n      var parent = nodes[targetIdx].parent;\n      child.push(nodes[targetIdx].id);\n      parent.push(nodes[sourceIdx].id);\n    });\n  } else {\n    edges.forEach(function (e) {\n      var source = (0, util_1.getEdgeTerminal)(e, 'source');\n      var target = (0, util_1.getEdgeTerminal)(e, 'target');\n      var sourceIdx = 0;\n\n      if (source) {\n        sourceIdx = nodeMap[source];\n      }\n\n      var targetIdx = 0;\n\n      if (target) {\n        targetIdx = nodeMap[target];\n      }\n\n      var sourceChildren = nodes[sourceIdx].children;\n      var targetChildren = nodes[targetIdx].children;\n      sourceChildren.push(nodes[targetIdx].id);\n      targetChildren.push(nodes[sourceIdx].id);\n    });\n  }\n}\n\nfunction connect(a, b, edges) {\n  var m = edges.length;\n\n  for (var i = 0; i < m; i++) {\n    var source = (0, util_1.getEdgeTerminal)(edges[i], 'source');\n    var target = (0, util_1.getEdgeTerminal)(edges[i], 'target');\n\n    if (a.id === source && b.id === target || b.id === source && a.id === target) {\n      return true;\n    }\n  }\n\n  return false;\n}\n\nfunction compareDegree(a, b) {\n  var aDegree = a.degree;\n  var bDegree = b.degree;\n\n  if (aDegree < bDegree) {\n    return -1;\n  }\n\n  if (aDegree > bDegree) {\n    return 1;\n  }\n\n  return 0;\n}\n/**\n * 圆形布局\n */\n\n\nvar CircularLayout =\n/** @class */\nfunction (_super) {\n  __extends(CircularLayout, _super);\n\n  function CircularLayout(options) {\n    var _this = _super.call(this) || this;\n    /** 固定半径，若设置了 radius，则 startRadius 与 endRadius 不起效 */\n\n\n    _this.radius = null;\n    /** 节点大小，配合 nodeSpacing，一起用于计算 radius。若不配置，节点大小默认为 30 */\n\n    _this.nodeSize = undefined;\n    /** 起始半径 */\n\n    _this.startRadius = null;\n    /** 终止半径 */\n\n    _this.endRadius = null;\n    /** 起始角度 */\n\n    _this.startAngle = 0;\n    /** 终止角度 */\n\n    _this.endAngle = 2 * Math.PI;\n    /** 是否顺时针 */\n\n    _this.clockwise = true;\n    /** 节点在环上分成段数（几个段将均匀分布），在 endRadius - startRadius != 0 时生效 */\n\n    _this.divisions = 1;\n    /** 节点在环上排序的依据，可选: 'topology', 'degree', 'null' */\n\n    _this.ordering = null;\n    /** how many 2*pi from first to last nodes */\n\n    _this.angleRatio = 1;\n    _this.nodes = [];\n    _this.edges = [];\n    _this.nodeMap = {};\n    _this.degrees = [];\n    _this.width = 300;\n    _this.height = 300;\n\n    _this.updateCfg(options);\n\n    return _this;\n  }\n\n  CircularLayout.prototype.getDefaultCfg = function () {\n    return {\n      radius: null,\n      startRadius: null,\n      endRadius: null,\n      startAngle: 0,\n      endAngle: 2 * Math.PI,\n      clockwise: true,\n      divisions: 1,\n      ordering: null,\n      angleRatio: 1\n    };\n  };\n  /**\n   * 执行布局\n   */\n\n\n  CircularLayout.prototype.execute = function () {\n    var _a;\n\n    var self = this;\n    var nodes = self.nodes;\n    var edges = self.edges;\n    var n = nodes.length;\n\n    if (n === 0) {\n      if (self.onLayoutEnd) self.onLayoutEnd();\n      return;\n    }\n\n    if (!self.width && typeof window !== \"undefined\") {\n      self.width = window.innerWidth;\n    }\n\n    if (!self.height && typeof window !== \"undefined\") {\n      self.height = window.innerHeight;\n    }\n\n    if (!self.center) {\n      self.center = [self.width / 2, self.height / 2];\n    }\n\n    var center = self.center;\n\n    if (n === 1) {\n      nodes[0].x = center[0];\n      nodes[0].y = center[1];\n      if (self.onLayoutEnd) self.onLayoutEnd();\n      return;\n    }\n\n    var radius = self.radius,\n        startRadius = self.startRadius,\n        endRadius = self.endRadius;\n    var divisions = self.divisions,\n        startAngle = self.startAngle,\n        endAngle = self.endAngle,\n        angleRatio = self.angleRatio,\n        ordering = self.ordering,\n        clockwise = self.clockwise,\n        paramNodeSpacing = self.nodeSpacing,\n        paramNodeSize = self.nodeSize;\n    var angleStep = (endAngle - startAngle) / n; // layout\n\n    var nodeMap = {};\n    nodes.forEach(function (node, i) {\n      nodeMap[node.id] = i;\n    });\n    self.nodeMap = nodeMap;\n    var degrees = (0, util_1.getDegree)(nodes.length, nodeMap, edges);\n    self.degrees = degrees;\n\n    if (paramNodeSpacing) {\n      var nodeSpacing_1 = (0, util_1.getFuncByUnknownType)(10, paramNodeSpacing);\n      var nodeSize_1 = (0, util_1.getFuncByUnknownType)(10, paramNodeSize);\n      var maxNodeSize_1 = -Infinity;\n      nodes.forEach(function (node) {\n        var nSize = nodeSize_1(node);\n        if (maxNodeSize_1 < nSize) maxNodeSize_1 = nSize;\n      });\n      var length_1 = 0;\n      nodes.forEach(function (node, i) {\n        if (i === 0) length_1 += maxNodeSize_1 || 10;else length_1 += (nodeSpacing_1(node) || 0) + (maxNodeSize_1 || 10);\n      });\n      radius = length_1 / (2 * Math.PI);\n    } else if (!radius && !startRadius && !endRadius) {\n      radius = self.height > self.width ? self.width / 2 : self.height / 2;\n    } else if (!startRadius && endRadius) {\n      startRadius = endRadius;\n    } else if (startRadius && !endRadius) {\n      endRadius = startRadius;\n    }\n\n    var astep = angleStep * angleRatio;\n    var layoutNodes = [];\n\n    if (ordering === \"topology\") {\n      // layout according to the topology\n      layoutNodes = self.topologyOrdering();\n    } else if (ordering === \"topology-directed\") {\n      // layout according to the topology\n      layoutNodes = self.topologyOrdering(true);\n    } else if (ordering === \"degree\") {\n      // layout according to the descent order of degrees\n      layoutNodes = self.degreeOrdering();\n    } else {\n      // layout according to the original order in the data.nodes\n      layoutNodes = nodes;\n    }\n\n    var divN = Math.ceil(n / divisions); // node number in each division\n\n    for (var i = 0; i < n; ++i) {\n      var r = radius;\n\n      if (!r && startRadius !== null && endRadius !== null) {\n        r = startRadius + i * (endRadius - startRadius) / (n - 1);\n      }\n\n      if (!r) {\n        r = 10 + i * 100 / (n - 1);\n      }\n\n      var angle = startAngle + i % divN * astep + 2 * Math.PI / divisions * Math.floor(i / divN);\n\n      if (!clockwise) {\n        angle = endAngle - i % divN * astep - 2 * Math.PI / divisions * Math.floor(i / divN);\n      }\n\n      layoutNodes[i].x = center[0] + Math.cos(angle) * r;\n      layoutNodes[i].y = center[1] + Math.sin(angle) * r;\n      layoutNodes[i].weight = degrees[i];\n    }\n\n    (_a = self.onLayoutEnd) === null || _a === void 0 ? void 0 : _a.call(self);\n    return {\n      nodes: layoutNodes,\n      edges: this.edges\n    };\n  };\n  /**\n   * 根据节点的拓扑结构排序\n   * @return {array} orderedNodes 排序后的结果\n   */\n\n\n  CircularLayout.prototype.topologyOrdering = function (directed) {\n    if (directed === void 0) {\n      directed = false;\n    }\n\n    var self = this;\n    var degrees = self.degrees;\n    var edges = self.edges;\n    var nodes = self.nodes;\n    var cnodes = (0, util_1.clone)(nodes);\n    var nodeMap = self.nodeMap;\n    var orderedCNodes = [cnodes[0]];\n    var resNodes = [nodes[0]];\n    var pickFlags = [];\n    var n = nodes.length;\n    pickFlags[0] = true;\n    initHierarchy(cnodes, edges, nodeMap, directed);\n    var k = 0;\n    cnodes.forEach(function (cnode, i) {\n      if (i !== 0) {\n        if ((i === n - 1 || degrees[i] !== degrees[i + 1] || connect(orderedCNodes[k], cnode, edges)) && !pickFlags[i]) {\n          orderedCNodes.push(cnode);\n          resNodes.push(nodes[nodeMap[cnode.id]]);\n          pickFlags[i] = true;\n          k++;\n        } else {\n          var children = orderedCNodes[k].children;\n          var foundChild = false;\n\n          for (var j = 0; j < children.length; j++) {\n            var childIdx = nodeMap[children[j]];\n\n            if (degrees[childIdx] === degrees[i] && !pickFlags[childIdx]) {\n              orderedCNodes.push(cnodes[childIdx]);\n              resNodes.push(nodes[nodeMap[cnodes[childIdx].id]]);\n              pickFlags[childIdx] = true;\n              foundChild = true;\n              break;\n            }\n          }\n\n          var ii = 0;\n\n          while (!foundChild) {\n            if (!pickFlags[ii]) {\n              orderedCNodes.push(cnodes[ii]);\n              resNodes.push(nodes[nodeMap[cnodes[ii].id]]);\n              pickFlags[ii] = true;\n              foundChild = true;\n            }\n\n            ii++;\n\n            if (ii === n) {\n              break;\n            }\n          }\n        }\n      }\n    });\n    return resNodes;\n  };\n  /**\n   * 根据节点度数大小排序\n   * @return {array} orderedNodes 排序后的结果\n   */\n\n\n  CircularLayout.prototype.degreeOrdering = function () {\n    var self = this;\n    var nodes = self.nodes;\n    var orderedNodes = [];\n    var degrees = self.degrees;\n    nodes.forEach(function (node, i) {\n      node.degree = degrees[i];\n      orderedNodes.push(node);\n    });\n    orderedNodes.sort(compareDegree);\n    return orderedNodes;\n  };\n\n  CircularLayout.prototype.getType = function () {\n    return \"circular\";\n  };\n\n  return CircularLayout;\n}(base_1.Base);\n\nexports.CircularLayout = CircularLayout;","map":{"version":3,"mappings":"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","names":["initHierarchy","nodes","edges","nodeMap","directed","forEach","_","i","children","parent","e","source","target","sourceIdx","targetIdx","child","push","id","sourceChildren","targetChildren","connect","a","b","m","length","compareDegree","aDegree","degree","bDegree","__extends","options","_super","_this","undefined","Math","PI","updateCfg","CircularLayout","radius","startRadius","endRadius","startAngle","endAngle","clockwise","divisions","ordering","angleRatio","self","n","onLayoutEnd","width","window","innerWidth","height","innerHeight","center","x","y","paramNodeSpacing","paramNodeSize","angleStep","node","degrees","nodeSpacing_1","nodeSize_1","maxNodeSize_1","Infinity","nSize","length_1","astep","layoutNodes","topologyOrdering","degreeOrdering","divN","ceil","r","angle","floor","cos","sin","weight","_a","cnodes","orderedCNodes","resNodes","pickFlags","k","cnode","foundChild","j","childIdx","ii","orderedNodes","sort","base_1","exports"],"sourceRoot":"","sources":["../../src/layout/circular.ts"],"sourcesContent":[null]},"metadata":{},"sourceType":"script"}