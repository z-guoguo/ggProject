{"ast":null,"code":"import { prettyNumber } from './pretty-number';\nexport default function pretty(min, max, m) {\n  if (m === void 0) {\n    m = 5;\n  }\n\n  if (min === max) {\n    return {\n      max: max,\n      min: min,\n      ticks: [min]\n    };\n  }\n\n  var n = m < 0 ? 0 : Math.round(m);\n  if (n === 0) return {\n    max: max,\n    min: min,\n    ticks: []\n  };\n  /*\n    R pretty:\n    https://svn.r-project.org/R/trunk/src/appl/pretty.c\n    https://www.rdocumentation.org/packages/base/versions/3.5.2/topics/pretty\n    */\n\n  var h = 1.5; // high.u.bias\n\n  var h5 = 0.5 + 1.5 * h; // u5.bias\n  // 反正我也不会调参，跳过所有判断步骤\n\n  var d = max - min;\n  var c = d / n; // 当d非常小的时候触发，但似乎没什么用\n  // const min_n = Math.floor(n / 3);\n  // const shrink_sml = Math.pow(2, 5);\n  // if (Math.log10(d) < -2) {\n  //   c = (_.max([ Math.abs(max), Math.abs(min) ]) * shrink_sml) / min_n;\n  // }\n\n  var base = Math.pow(10, Math.floor(Math.log10(c)));\n  var unit = base;\n\n  if (2 * base - c < h * (c - unit)) {\n    unit = 2 * base;\n\n    if (5 * base - c < h5 * (c - unit)) {\n      unit = 5 * base;\n\n      if (10 * base - c < h * (c - unit)) {\n        unit = 10 * base;\n      }\n    }\n  }\n\n  var nu = Math.ceil(max / unit);\n  var ns = Math.floor(min / unit);\n  var hi = Math.max(nu * unit, max);\n  var lo = Math.min(ns * unit, min);\n  var size = Math.floor((hi - lo) / unit) + 1;\n  var ticks = new Array(size);\n\n  for (var i = 0; i < size; i++) {\n    ticks[i] = prettyNumber(lo + i * unit);\n  }\n\n  return {\n    min: lo,\n    max: hi,\n    ticks: ticks\n  };\n}","map":{"version":3,"mappings":"AAAA,SAASA,YAAT,QAA6B,iBAA7B;AAEA,eAAc,SAAUC,MAAV,CAAiBC,GAAjB,EAA8BC,GAA9B,EAA2CC,CAA3C,EAAwD;EAAb;IAAAA;EAAa;;EACpE,IAAIF,GAAG,KAAKC,GAAZ,EAAiB;IACf,OAAO;MACLA,GAAG,KADE;MAELD,GAAG,KAFE;MAGLG,KAAK,EAAE,CAACH,GAAD;IAHF,CAAP;EAKD;;EAED,IAAMI,CAAC,GAAGF,CAAC,GAAG,CAAJ,GAAQ,CAAR,GAAYG,IAAI,CAACC,KAAL,CAAWJ,CAAX,CAAtB;EACA,IAAIE,CAAC,KAAK,CAAV,EAAa,OAAO;IAAEH,GAAG,KAAL;IAAOD,GAAG,KAAV;IAAYG,KAAK,EAAE;EAAnB,CAAP;EAEb;;;;;;EAKA,IAAMI,CAAC,GAAG,GAAV,CAjBoE,CAiBrD;;EACf,IAAMC,EAAE,GAAG,MAAM,MAAMD,CAAvB,CAlBoE,CAkB1C;EAC1B;;EACA,IAAME,CAAC,GAAGR,GAAG,GAAGD,GAAhB;EACA,IAAMU,CAAC,GAAGD,CAAC,GAAGL,CAAd,CArBoE,CAsBpE;EACA;EACA;EACA;EACA;EACA;;EAEA,IAAMO,IAAI,GAAGN,IAAI,CAACO,GAAL,CAAS,EAAT,EAAaP,IAAI,CAACQ,KAAL,CAAWR,IAAI,CAACS,KAAL,CAAWJ,CAAX,CAAX,CAAb,CAAb;EACA,IAAIK,IAAI,GAAGJ,IAAX;;EACA,IAAI,IAAIA,IAAJ,GAAWD,CAAX,GAAeH,CAAC,IAAIG,CAAC,GAAGK,IAAR,CAApB,EAAmC;IACjCA,IAAI,GAAG,IAAIJ,IAAX;;IACA,IAAI,IAAIA,IAAJ,GAAWD,CAAX,GAAeF,EAAE,IAAIE,CAAC,GAAGK,IAAR,CAArB,EAAoC;MAClCA,IAAI,GAAG,IAAIJ,IAAX;;MACA,IAAI,KAAKA,IAAL,GAAYD,CAAZ,GAAgBH,CAAC,IAAIG,CAAC,GAAGK,IAAR,CAArB,EAAoC;QAClCA,IAAI,GAAG,KAAKJ,IAAZ;MACD;IACF;EACF;;EACD,IAAMK,EAAE,GAAGX,IAAI,CAACY,IAAL,CAAUhB,GAAG,GAAGc,IAAhB,CAAX;EACA,IAAMG,EAAE,GAAGb,IAAI,CAACQ,KAAL,CAAWb,GAAG,GAAGe,IAAjB,CAAX;EAEA,IAAMI,EAAE,GAAGd,IAAI,CAACJ,GAAL,CAASe,EAAE,GAAGD,IAAd,EAAoBd,GAApB,CAAX;EACA,IAAMmB,EAAE,GAAGf,IAAI,CAACL,GAAL,CAASkB,EAAE,GAAGH,IAAd,EAAoBf,GAApB,CAAX;EAEA,IAAMqB,IAAI,GAAGhB,IAAI,CAACQ,KAAL,CAAW,CAACM,EAAE,GAAGC,EAAN,IAAYL,IAAvB,IAA+B,CAA5C;EACA,IAAMZ,KAAK,GAAG,IAAImB,KAAJ,CAAUD,IAAV,CAAd;;EACA,KAAK,IAAIE,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGF,IAApB,EAA0BE,CAAC,EAA3B,EAA+B;IAC7BpB,KAAK,CAACoB,CAAD,CAAL,GAAWzB,YAAY,CAACsB,EAAE,GAAGG,CAAC,GAAGR,IAAV,CAAvB;EACD;;EAED,OAAO;IACLf,GAAG,EAAEoB,EADA;IAELnB,GAAG,EAAEkB,EAFA;IAGLhB,KAAK;EAHA,CAAP;AAKD","names":["prettyNumber","pretty","min","max","m","ticks","n","Math","round","h","h5","d","c","base","pow","floor","log10","unit","nu","ceil","ns","hi","lo","size","Array","i"],"sourceRoot":"","sources":["../../src/util/pretty.ts"],"sourcesContent":[null]},"metadata":{},"sourceType":"module"}