{"ast":null,"code":"import { __extends } from \"tslib\";\nimport { filter, getRange, head, isNil, last } from '@antv/util';\nimport Base from '../base';\n/**\n * 连续度量的基类\n * @class\n */\n\nvar Continuous =\n/** @class */\nfunction (_super) {\n  __extends(Continuous, _super);\n\n  function Continuous() {\n    var _this = _super !== null && _super.apply(this, arguments) || this;\n\n    _this.isContinuous = true;\n    return _this;\n  }\n\n  Continuous.prototype.scale = function (value) {\n    if (isNil(value)) {\n      return NaN;\n    }\n\n    var rangeMin = this.rangeMin();\n    var rangeMax = this.rangeMax();\n    var max = this.max;\n    var min = this.min;\n\n    if (max === min) {\n      return rangeMin;\n    }\n\n    var percent = this.getScalePercent(value);\n    return rangeMin + percent * (rangeMax - rangeMin);\n  };\n\n  Continuous.prototype.init = function () {\n    _super.prototype.init.call(this); // init 完成后保证 min, max 包含 ticks 的范围\n\n\n    var ticks = this.ticks;\n    var firstTick = head(ticks);\n    var lastTick = last(ticks);\n\n    if (firstTick < this.min) {\n      this.min = firstTick;\n    }\n\n    if (lastTick > this.max) {\n      this.max = lastTick;\n    } // strict-limit 方式\n\n\n    if (!isNil(this.minLimit)) {\n      this.min = firstTick;\n    }\n\n    if (!isNil(this.maxLimit)) {\n      this.max = lastTick;\n    }\n  };\n\n  Continuous.prototype.setDomain = function () {\n    var _a = getRange(this.values),\n        min = _a.min,\n        max = _a.max;\n\n    if (isNil(this.min)) {\n      this.min = min;\n    }\n\n    if (isNil(this.max)) {\n      this.max = max;\n    }\n\n    if (this.min > this.max) {\n      this.min = min;\n      this.max = max;\n    }\n  };\n\n  Continuous.prototype.calculateTicks = function () {\n    var _this = this;\n\n    var ticks = _super.prototype.calculateTicks.call(this);\n\n    if (!this.nice) {\n      ticks = filter(ticks, function (tick) {\n        return tick >= _this.min && tick <= _this.max;\n      });\n    }\n\n    return ticks;\n  }; // 计算原始值值占的百分比\n\n\n  Continuous.prototype.getScalePercent = function (value) {\n    var max = this.max;\n    var min = this.min;\n    return (value - min) / (max - min);\n  };\n\n  Continuous.prototype.getInvertPercent = function (value) {\n    return (value - this.rangeMin()) / (this.rangeMax() - this.rangeMin());\n  };\n\n  return Continuous;\n}(Base);\n\nexport default Continuous;","map":{"version":3,"mappings":"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","names":["filter","getRange","head","isNil","last","Base","__extends","_this","Continuous","value","NaN","rangeMin","rangeMax","max","min","percent","getScalePercent","_super","init","call","ticks","firstTick","lastTick","minLimit","maxLimit","values","calculateTicks","nice","tick"],"sourceRoot":"","sources":["../../src/continuous/base.ts"],"sourcesContent":[null]},"metadata":{},"sourceType":"module"}