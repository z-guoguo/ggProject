{"ast":null,"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n/**\n * @description 扩展方法，提供 gl-matrix 为提供的方法\n * */\n\nvar gl_matrix_1 = require(\"gl-matrix\");\n\nfunction leftTranslate(out, a, v) {\n  var transMat = [0, 0, 0, 0, 0, 0, 0, 0, 0];\n  gl_matrix_1.mat3.fromTranslation(transMat, v);\n  return gl_matrix_1.mat3.multiply(out, transMat, a);\n}\n\nexports.leftTranslate = leftTranslate;\n\nfunction leftRotate(out, a, rad) {\n  var rotateMat = [0, 0, 0, 0, 0, 0, 0, 0, 0];\n  gl_matrix_1.mat3.fromRotation(rotateMat, rad);\n  return gl_matrix_1.mat3.multiply(out, rotateMat, a);\n}\n\nexports.leftRotate = leftRotate;\n\nfunction leftScale(out, a, v) {\n  var scaleMat = [0, 0, 0, 0, 0, 0, 0, 0, 0];\n  gl_matrix_1.mat3.fromScaling(scaleMat, v);\n  return gl_matrix_1.mat3.multiply(out, scaleMat, a);\n}\n\nexports.leftScale = leftScale;\n\nfunction leftMultiply(out, a, a1) {\n  return gl_matrix_1.mat3.multiply(out, a1, a);\n}\n/**\n * 根据 actions 来做 transform\n * @param m\n * @param actions\n */\n\n\nfunction transform(m, actions) {\n  var matrix = m ? [].concat(m) : [1, 0, 0, 0, 1, 0, 0, 0, 1];\n\n  for (var i = 0, len = actions.length; i < len; i++) {\n    var action = actions[i];\n\n    switch (action[0]) {\n      case 't':\n        leftTranslate(matrix, matrix, [action[1], action[2]]);\n        break;\n\n      case 's':\n        leftScale(matrix, matrix, [action[1], action[2]]);\n        break;\n\n      case 'r':\n        leftRotate(matrix, matrix, action[1]);\n        break;\n\n      case 'm':\n        leftMultiply(matrix, matrix, action[1]);\n        break;\n\n      default:\n        break;\n    }\n  }\n\n  return matrix;\n}\n\nexports.transform = transform;\n/**\n * 向量 v1 到 向量 v2 夹角的方向\n * @param  {Array} v1 向量\n * @param  {Array} v2 向量\n * @return {Boolean} >= 0 顺时针 < 0 逆时针\n */\n\nfunction direction(v1, v2) {\n  return v1[0] * v2[1] - v2[0] * v1[1];\n}\n\nexports.direction = direction;\n/**\n * 二维向量 v1 到 v2 的夹角\n * @param v1\n * @param v2\n * @param direct\n */\n\nfunction angleTo(v1, v2, direct) {\n  var ang = gl_matrix_1.vec2.angle(v1, v2);\n  var angleLargeThanPI = direction(v1, v2) >= 0;\n\n  if (direct) {\n    if (angleLargeThanPI) {\n      return Math.PI * 2 - ang;\n    }\n\n    return ang;\n  }\n\n  if (angleLargeThanPI) {\n    return ang;\n  }\n\n  return Math.PI * 2 - ang;\n}\n\nexports.angleTo = angleTo;\n/**\n * 计算二维向量的垂直向量\n * @param out\n * @param v\n * @param flag\n */\n\nfunction vertical(out, v, flag) {\n  if (flag) {\n    out[0] = v[1];\n    out[1] = -1 * v[0];\n  } else {\n    out[0] = -1 * v[1];\n    out[1] = v[0];\n  }\n\n  return out;\n}\n\nexports.vertical = vertical;","map":{"version":3,"mappings":";;;;;AAAA;;;;AAGA;;AAIA,SAAgBA,aAAhB,CAA8BC,GAA9B,EAAmCC,CAAnC,EAAsCC,CAAtC,EAAuC;EACrC,IAAMC,QAAQ,GAAa,CAAE,CAAF,EAAK,CAAL,EAAQ,CAAR,EAAW,CAAX,EAAc,CAAd,EAAiB,CAAjB,EAAoB,CAApB,EAAuB,CAAvB,EAA0B,CAA1B,CAA3B;EACAC,iBAAKC,eAAL,CAAqBF,QAArB,EAA+BD,CAA/B;EACA,OAAOE,iBAAKE,QAAL,CAAcN,GAAd,EAAmBG,QAAnB,EAA6BF,CAA7B,CAAP;AACD;;AAJDM;;AAMA,SAAgBC,UAAhB,CAA2BR,GAA3B,EAAgCC,CAAhC,EAAmCQ,GAAnC,EAAsC;EACpC,IAAMC,SAAS,GAAa,CAAE,CAAF,EAAK,CAAL,EAAQ,CAAR,EAAW,CAAX,EAAc,CAAd,EAAiB,CAAjB,EAAoB,CAApB,EAAuB,CAAvB,EAA0B,CAA1B,CAA5B;EACAN,iBAAKO,YAAL,CAAkBD,SAAlB,EAA6BD,GAA7B;EACA,OAAOL,iBAAKE,QAAL,CAAcN,GAAd,EAAmBU,SAAnB,EAA8BT,CAA9B,CAAP;AACD;;AAJDM;;AAMA,SAAgBK,SAAhB,CAA0BZ,GAA1B,EAA+BC,CAA/B,EAAkCC,CAAlC,EAAmC;EACjC,IAAMW,QAAQ,GAAa,CAAE,CAAF,EAAK,CAAL,EAAQ,CAAR,EAAW,CAAX,EAAc,CAAd,EAAiB,CAAjB,EAAoB,CAApB,EAAuB,CAAvB,EAA0B,CAA1B,CAA3B;EACAT,iBAAKU,WAAL,CAAiBD,QAAjB,EAA2BX,CAA3B;EACA,OAAOE,iBAAKE,QAAL,CAAcN,GAAd,EAAmBa,QAAnB,EAA6BZ,CAA7B,CAAP;AACD;;AAJDM;;AAMA,SAASQ,YAAT,CAAsBf,GAAtB,EAA2BC,CAA3B,EAA8Be,EAA9B,EAAgC;EAC9B,OAAOZ,iBAAKE,QAAL,CAAcN,GAAd,EAAmBgB,EAAnB,EAAuBf,CAAvB,CAAP;AACD;AACD;;;;;;;AAKA,SAAgBgB,SAAhB,CAA0BC,CAA1B,EAAuCC,OAAvC,EAAuD;EACrD,IAAMC,MAAM,GAAGF,CAAC,GAAG,GAAGG,MAAH,CAAUH,CAAV,CAAH,GAAkB,CAAE,CAAF,EAAK,CAAL,EAAQ,CAAR,EAAW,CAAX,EAAc,CAAd,EAAiB,CAAjB,EAAoB,CAApB,EAAuB,CAAvB,EAA0B,CAA1B,CAAlC;;EAEA,KAAK,IAAII,CAAC,GAAG,CAAR,EAAWC,GAAG,GAAGJ,OAAO,CAACK,MAA9B,EAAsCF,CAAC,GAAGC,GAA1C,EAA+CD,CAAC,EAAhD,EAAoD;IAClD,IAAMG,MAAM,GAAGN,OAAO,CAACG,CAAD,CAAtB;;IACA,QAAQG,MAAM,CAAC,CAAD,CAAd;MACE,KAAK,GAAL;QACE1B,aAAa,CAACqB,MAAD,EAASA,MAAT,EAAiB,CAAEK,MAAM,CAAC,CAAD,CAAR,EAAaA,MAAM,CAAC,CAAD,CAAnB,CAAjB,CAAb;QACA;;MACF,KAAK,GAAL;QACEb,SAAS,CAACQ,MAAD,EAASA,MAAT,EAAiB,CAAEK,MAAM,CAAC,CAAD,CAAR,EAAaA,MAAM,CAAC,CAAD,CAAnB,CAAjB,CAAT;QACA;;MACF,KAAK,GAAL;QACEjB,UAAU,CAACY,MAAD,EAASA,MAAT,EAAiBK,MAAM,CAAC,CAAD,CAAvB,CAAV;QACA;;MACF,KAAK,GAAL;QACEV,YAAY,CAACK,MAAD,EAASA,MAAT,EAAiBK,MAAM,CAAC,CAAD,CAAvB,CAAZ;QACA;;MACF;QACE;IAdJ;EAgBD;;EAED,OAAOL,MAAP;AACD;;AAxBDb;AA0BA;;;;;;;AAMA,SAAgBmB,SAAhB,CAA0BC,EAA1B,EAAwCC,EAAxC,EAAoD;EAClD,OAAOD,EAAE,CAAC,CAAD,CAAF,GAAQC,EAAE,CAAC,CAAD,CAAV,GAAgBA,EAAE,CAAC,CAAD,CAAF,GAAQD,EAAE,CAAC,CAAD,CAAjC;AACD;;AAFDpB;AAIA;;;;;;;AAMA,SAAgBsB,OAAhB,CAAwBF,EAAxB,EAA8CC,EAA9C,EAAoEE,MAApE,EAAmF;EACjF,IAAMC,GAAG,GAAG3B,iBAAK4B,KAAL,CAAWL,EAAX,EAAeC,EAAf,CAAZ;EACA,IAAMK,gBAAgB,GAAGP,SAAS,CAACC,EAAD,EAAKC,EAAL,CAAT,IAAqB,CAA9C;;EACA,IAAIE,MAAJ,EAAY;IACV,IAAIG,gBAAJ,EAAsB;MACpB,OAAOC,IAAI,CAACC,EAAL,GAAU,CAAV,GAAcJ,GAArB;IACD;;IACD,OAAOA,GAAP;EACD;;EAED,IAAIE,gBAAJ,EAAsB;IACpB,OAAOF,GAAP;EACD;;EACD,OAAOG,IAAI,CAACC,EAAL,GAAU,CAAV,GAAcJ,GAArB;AACD;;AAdDxB;AAgBA;;;;;;;AAMA,SAAgB6B,QAAhB,CAAyBpC,GAAzB,EAAwCE,CAAxC,EAAqDmC,IAArD,EAAkE;EAChE,IAAIA,IAAJ,EAAU;IACRrC,GAAG,CAAC,CAAD,CAAH,GAASE,CAAC,CAAC,CAAD,CAAV;IACAF,GAAG,CAAC,CAAD,CAAH,GAAS,CAAC,CAAD,GAAKE,CAAC,CAAC,CAAD,CAAf;EACD,CAHD,MAGO;IACLF,GAAG,CAAC,CAAD,CAAH,GAAS,CAAC,CAAD,GAAKE,CAAC,CAAC,CAAD,CAAf;IACAF,GAAG,CAAC,CAAD,CAAH,GAASE,CAAC,CAAC,CAAD,CAAV;EACD;;EAED,OAAOF,GAAP;AACD;;AAVDO","names":["leftTranslate","out","a","v","transMat","gl_matrix_1","fromTranslation","multiply","exports","leftRotate","rad","rotateMat","fromRotation","leftScale","scaleMat","fromScaling","leftMultiply","a1","transform","m","actions","matrix","concat","i","len","length","action","direction","v1","v2","angleTo","direct","ang","angle","angleLargeThanPI","Math","PI","vertical","flag"],"sourceRoot":"","sources":["../src/ext.ts"],"sourcesContent":[null]},"metadata":{},"sourceType":"script"}