{"ast":null,"code":"/**\n * @fileoverview arrow\n * @author dengfuping_develop@163.com\n */\nimport { isArray, uniqueId } from '@antv/util';\nimport { createSVGElement } from '../util/dom';\n\nvar Arrow =\n/** @class */\nfunction () {\n  function Arrow(attrs, type) {\n    this.cfg = {};\n    var el = createSVGElement('marker');\n    var id = uniqueId('marker_');\n    el.setAttribute('id', id);\n    var shape = createSVGElement('path');\n    shape.setAttribute('stroke', attrs.stroke || 'none');\n    shape.setAttribute('fill', attrs.fill || 'none');\n    el.appendChild(shape);\n    el.setAttribute('overflow', 'visible');\n    el.setAttribute('orient', 'auto-start-reverse');\n    this.el = el;\n    this.child = shape;\n    this.id = id;\n    var cfg = attrs[type === 'marker-start' ? 'startArrow' : 'endArrow'];\n    this.stroke = attrs.stroke || '#000';\n\n    if (cfg === true) {\n      this._setDefaultPath(type, shape);\n    } else {\n      this.cfg = cfg; // when arrow config exists\n\n      this._setMarker(attrs.lineWidth, shape);\n    }\n\n    return this;\n  }\n\n  Arrow.prototype.match = function () {\n    return false;\n  };\n\n  Arrow.prototype._setDefaultPath = function (type, el) {\n    var parent = this.el; // 默认箭头的边长为 10，夹角为 60 度\n\n    el.setAttribute('d', \"M0,0 L\" + 10 * Math.cos(Math.PI / 6) + \",5 L0,10\");\n    parent.setAttribute('refX', \"\" + 10 * Math.cos(Math.PI / 6));\n    parent.setAttribute('refY', \"\" + 5);\n  };\n\n  Arrow.prototype._setMarker = function (r, el) {\n    var parent = this.el;\n    var path = this.cfg.path;\n    var d = this.cfg.d;\n\n    if (isArray(path)) {\n      path = path.map(function (segment) {\n        return segment.join(' ');\n      }).join('');\n    }\n\n    el.setAttribute('d', path);\n    parent.appendChild(el);\n\n    if (d) {\n      parent.setAttribute('refX', \"\" + d / r);\n    }\n  };\n\n  Arrow.prototype.update = function (fill) {\n    var child = this.child;\n\n    if (child.attr) {\n      child.attr('fill', fill);\n    } else {\n      child.setAttribute('fill', fill);\n    }\n  };\n\n  return Arrow;\n}();\n\nexport default Arrow;","map":{"version":3,"mappings":"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","names":["isArray","uniqueId","createSVGElement","attrs","type","el","id","setAttribute","shape","stroke","fill","appendChild","child","cfg","_setDefaultPath","_setMarker","lineWidth","Arrow","parent","Math","cos","PI","r","path","d","map","segment","join","attr"],"sourceRoot":"","sources":["../../src/defs/arrow.ts"],"sourcesContent":[null]},"metadata":{},"sourceType":"module"}